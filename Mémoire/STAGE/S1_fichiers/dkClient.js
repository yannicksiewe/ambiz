(function(){"3"===mxClient.VERSION.split(".")[0]&&(mxShape.prototype.getSvgScreenOffset=function(){return 0},mxConstants.STYLE_STENCIL_FLIPH_PATCH="stencilFlipH",mxConstants.STYLE_STENCIL_FLIPV_PATCH="stencilFlipV");mxConstants.TOOLTIP_VERTICAL_OFFSET=0;var a=mxRubberband.prototype.mouseUp;mxRubberband.prototype.mouseUp=function(b,c){null!=this.div&&0>=this.x&&0>=this.y&&(this.y=this.x=0);a.apply(this,_.toArray(arguments))};mxCell.prototype.isConnectableTo=function(a){return!1};mxCell.prototype.isACustomPin=
function(){return!1};mxCell.prototype.isASmartPin=function(){return!1};mxCell.prototype.isAPin=function(){return!1};mxCell.prototype.hasStencil=function(){return!1};mxCell.prototype.useDiagramConnection=function(){return!0};mxCell.prototype.isCopiable=function(){return!0};mxCell.prototype.isAllowHtmlLabels=function(){return!1};mxCell.prototype.isImageComponent=function(){return!1};mxCell.prototype.isFlippable=function(){return!0};mxCell.prototype.isRotatable=function(){return!0};mxCell.prototype.isMovable=
function(){return!0};mxCell.prototype.useConnectImage=function(){return!1};mxCell.prototype.hasTooltip=function(){return!1};mxCell.prototype.hasParameterValue=function(){return!1};mxCell.prototype.constrainInParent=function(){return!0};mxCell.prototype.isImageComp=function(){return!1};mxCell.prototype.allowPinOrdering=function(){return!1}})();var AspenLabs="undefined"!==typeof AspenLabs?AspenLabs:{};
(function(a){a.oldIE=!1;$("html").is(".ie6, .ie7, .ie8")&&(a.oldIE=!0);a.ieVersion=null;$("html").hasClass("ie6")?a.ieVersion=6:$("html").hasClass("ie7")?a.ieVersion=7:$("html").hasClass("ie8")?a.ieVersion=8:$("html").hasClass("ie9")?a.ieVersion=9:$("html").hasClass("ie10")?a.ieVersion=10:$("html").hasClass("ie11")&&(a.ieVersion=11)})(AspenLabs);
(function(){window.console=window.console||function(){var a={};a.log=a.warn=a.debug=a.info=a.error=a.time=a.dir=a.profile=a.clear=a.exception=a.trace=a.assert=function(){};return a}()})();var EEWeb=EEWeb||{};function eeLang(){return EEWeb.lang&&void 0!==EEWeb.lang?EEWeb.lang:this instanceof eeLang?(EEWeb.lang=this,this):new eeLang}
eeLang.prototype.init=function(a){$.i18n.init({lng:a,fallbackLng:"en",useLocalStorage:!1,resStore:resources,debug:!0},function(){});this.l=$.i18n.t;this.l_name=i18n.lng();$("#search_box").addClass("lang_"+i18n.lng())};eeLang.prototype.translateDOM=function(){$("#splash").i18n();$(".static_i18n").i18n();var a=$("#file_header .title");a.text()!==$.t("schemeit_new_project")&&a.text($.t("schemeit_new_project_ver",{version:eeServerData.buildVersion}))};var l=null,l_name=null;
(function(){EEWeb.lang=new eeLang;EEWeb.lang.init(eeServerData.language||"en");l=EEWeb.lang.l;l_name=EEWeb.lang.l_name})();EEWeb=void 0===EEWeb?{}:EEWeb;
(function(){var a=APIBasepath||"/",b=!(AspenLabs.ieVersion&&(9==AspenLabs.ieVersion||8==AspenLabs.ieVersion)),c=void 0===componentApi?"/":componentApi.path,d=void 0===componentApi?"en":componentApi.lang,d="&language="+d;b&&eeServerData.useSecuredConnection&&(0==c.indexOf("//")?c="https:"+c:0==c.indexOf("http://")&&(c=c.replace("http://","https://")));EEWeb.searchStrategy="dkSearchStrategy";var b=function(a,b,c,d,e){if(a&&"status"in a){if("success"===a.status){d(a.data,a.status);return}if("error"===
a.status){e(a.data,a.status);return}}e(a,"error")},e=function(a){var b=$.cookie("csrftoken");b&&a.setRequestHeader("X-CSRFToken",b);return!0},f=function(a,b){var c=b.data.split("&"),d={},e;_.each(c,function(a){e=a.split("=");d[e[0]]=decodeURIComponent(e[1]||"")});b.data=JSON.stringify(d);return!0};amplify.request.decoders.customError=function(a,b,c,d,e){"success"===b?d(a,b):e(c,b,e)};amplify.request.define("save","ajax",{url:a+"/api/project",cache:!1,dataType:"json",beforeSend:e});amplify.request.define("open",
"ajax",{cache:!1,url:a+"/api/project/{projectId}",dataType:"json",type:"GET",beforeSend:e});amplify.request.define("save_as","ajax",{url:a+"/api/project",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("share","ajax",{url:a+"share",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("save_session","ajax",{url:a+"save/session",cache:!1,dataType:"json",type:"POST",decoder:"customError",beforeSend:e});amplify.request.define("save_project","ajax",{url:a+
"save",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("save_check","ajax",{url:a+"save/check-name",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("save_as","ajax",{url:a+"save",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("save_as_project","ajax",{url:a+"save",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("delete","ajax",{url:a+"delete",cache:!1,dataType:"json",type:"POST",beforeSend:e});
amplify.request.define("open_project","ajax",{url:a+"open",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("close","ajax",{url:a+"share",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("feedback","ajax",{url:a+"feedback",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("request_quote","ajax",{url:a+"requestquote",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("logout","ajax",{url:a+"account/logout",
type:"GET",cache:!1,dataType:"json",beforeSend:e});amplify.request.define("login","ajax",{url:a+"account/logout",type:"GET",cache:!1,dataType:"json",beforeSend:e});amplify.request.define("permissions","ajax",{url:a+"save/permissions",cache:!1,dataType:"json",type:"POST",beforeSend:e});amplify.request.define("acceptterms","ajax",{url:a+"account/accept-terms",cache:!1,dataType:"json",type:"POST"});amplify.request.define("search_keyword","ajax",{url:a+"search/keywords",type:"POST",cache:!1,dataType:"json",
beforeSend:e});amplify.request.define("search_product","ajax",{url:a+"search/product",type:"POST",cache:!1,dataType:"json",beforeSend:e});amplify.request.define("open_list","ajax",{url:a+"open",type:"GET",cache:!1,dataType:"json",decoder:"customError",beforeSend:e});amplify.request.define("ping","ajax",{url:"{pingUrl}",type:"POST",cache:!1,dataType:"json",beforeSend:e});amplify.request.define("loggedin_query","ajax",{url:a+"account/logged-in",type:"POST",cache:!1,dataType:"json",decoder:"customError",
beforeSend:e});amplify.request.define("ajaxSubmit_export",{url:a+"export/",dataType:"json",type:"POST",iframe:!0,error:function(a,b,c){0===a.status&&EEWeb.eventLog.logEvent("export error","Status:"+a.status+" Error:"+a.error+" Text:"+a.responseText)}});amplify.request.define("ajaxSubmit_exportAllPages",{url:a+"export/allpages/",dataType:"json",type:"POST",iframe:!0,error:function(a,b,c){0===a.status&&EEWeb.eventLog.logEvent("export error","Status:"+a.status+" Error:"+a.error+" Text:"+a.responseText)}});
amplify.request.define("ajaxSubmit_bom_export",{url:a+"export/",dataType:"json",type:"POST",iframe:!0,error:function(){EEWeb.eventLog.logEvent("BOM export error.")},success:function(){EEWeb.eventLog.logEvent("BOM export successful.")}});amplify.request.define("oauthtoken","ajax",{url:a+"oauthtoken/",dataType:"json",type:"GET",cache:!1});amplify.request.define("component-sections","ajax",{url:c+"/sections?"+d,dataType:"json",type:"GET",decoder:b});amplify.request.define("component_categories","ajax",
{url:c+"categories/{urloption}?"+d,dataType:"json",type:"GET",decoder:b});amplify.request.define("component_components","ajax",{url:c+"components/{category}?"+d,dataType:"json",type:"GET",decoder:b});amplify.request.define("component_stencils","ajax",{url:c+"stencils/{category}?"+d,dataType:"xml",type:"GET"});amplify.request.define("component_stencildefs","ajax",{url:c+"stencildefs/{category}?"+d,dataType:"json",type:"GET",decoder:b});amplify.request.define("get_stencils","ajax",{url:c+"stencillist/",
dataType:"xml",type:"POST",cache:!1,decoder:function(a,b,c,d,e){"success"==b?d(a,b):e(c,b,e)}});amplify.request.define("paramset","ajax",{url:c+"paramsets?"+d,dataType:"json",type:"GET",decoder:b});amplify.request.define("ietracker","ajax",{url:c.replace("https","http")+"ietracker/track/",cache:!1,type:"POST",dataType:"json",contentType:"application/json"});amplify.request.define("component_event","ajax",{url:a+"events/component/{action}/",cache:!1,type:"POST",dataType:"json",beforeSend:f,contentType:"application/json"});
amplify.request.define("bom_event","ajax",{url:a+"events/bom-{action}/",cache:!1,type:"POST",dataType:"json",beforeSend:f,contentType:"application/json"});amplify.request.define("partsearch_event","ajax",{url:a+"events/vendor-search/{vendor}/",cache:!1,type:"POST",dataType:"json",beforeSend:f,contentType:"application/json"});amplify.request.define("reference_design_event","ajax",{url:a+"events/open-reference-design-project/",cache:!1,type:"POST",dataType:"json",beforeSend:f,contentType:"application/json"})})();
var eeCompPropertyMixins={paramDefs:null,getParamDefs:function(){null===this.paramDefs&&(this.paramDefs={refdes:{disp_name:l("refdes"),type:"text"},notes:{disp_name:l("notes"),type:"textarea"},desc:{disp_name:l("description"),type:"textarea"}});return this.paramDefs},getPropertiesName:function(){return"Component"},getPropertiesFields:function(){var a=[],b={};this.paramsets&&_.each(this.paramsets,function(c){c in eeParameterSets&&_.each(eeParameterSets[c].byorder,function(c){var d={name:c.name,disp_name:l(c.disp_name),
val:c.default_val,type:c.fldtype,rule:c.rule,show:"show"==c.visibility?!0:!1,tip:c.tip,ro:c.ro||!1};"refdes"===c.name&&this.hasParameter("refprefix")&&(d.prefix=this.getParameter("refprefix"));"vendorpn"===c.name&&(d=this.formatVendorPNField(d));"list"===c.fldtype&&(d.items=c.items);this.hasParameter(c.name)&&(d.val=this.getParameter(c.name),null===d.val&&null!==c.default_val&&(d.val=c.default_val),d.ro=this.isParamReadonly(c.name),d.show=c.name in this.labelsByName?!0:!1);if(c.name in b)c=b[c.name],
a[c.idx]=d,d.idx=c.idx;else{var e=a.push(d);d.idx=e-1;b[c.name]=d}},this)},this);var c=this.getParamList(),d=this.getParamDefs();_.each(c,function(c){c in b||(field={name:c,val:this.getParameter(c),ro:this.isParamReadonly(c),show:!1,type:"text",disp_name:l(c)},"refdes"===c&&this.hasParameter("refprefix")&&(field.prefix=this.getParameter("refprefix")),c in d&&(field.disp_name=d[c].disp_name,field.type=d[c].type),c in this.labelsByName&&(field.show=!0),a.push(field))},this);return a},formatVendorPNField:function(a){var b=
EEWeb.app.getVendor();a.disp_name=b.getVendorPartNumberTitle();return a},cancelProperties:function(){},setProperties:function(a){EEWeb.app.getGraph().model.beginUpdate();var b=Math.floor((new Date).getTime()/1E3),c;for(c in a){var d=a[c];d.value===this.getParameter(c)&&d.show===this.isParameterVisible(c)||EEWeb.app.getGraph().model.setProperty(this,c,d.value,d.show,b)}this.processLabelQueue();a=this.getView();a.clear(this,!1,!0);a.validate();EEWeb.app.getGraph().model.endUpdate()},setProperty:function(a,
b){var c={value:null,show:null,updated_on:null};this.hasParameter(a)?(c.value=this.getParameter(a),c.show=this.isParameterVisible(a),c.updated_on=this.updated_on,void 0===b||null===b.value?this.removeParameter(null,a):(this.setParameter(null,a,b.value),this.setParameterVisibility(a,b.show))):void 0!==b&&null!==b.value&&(this.setParameter(null,a,b.value),b.show&&this.setParameterVisibility(a,!0));this.updated_on=b.updated_on;return c},setBomIncludeUserAllowed:function(a){var b=!1,c=this.bom_include_user_allowed;
EEWeb.app.getGraph().model.beginUpdate();(this.bom_include_user_allowed=a)&&!c?(amplify.publish(EEWeb.events.COMPONENT_ADDED,new ALEvent({comp:this,redo:!1,newcomp:!1})),b=!0):!a&&c&&(amplify.publish(EEWeb.events.COMPONENT_DELETED,new ALEvent({comp:this,redo:!1,newcomp:!1,remove:!1})),b=!0);b&&amplify.publish(EEWeb.events.COMPONENT_UPDATED,new ALEvent({cell:this,id:this.id,name:null,value:null,readonly:null,bom_include:null,bom_include_user_allowed:a,source:null}));EEWeb.app.getGraph().model.endUpdate()}};
function ALEvent(a){_.extend(this,a)}ALEvent.prototype.getProperty=function(a){return"undefined"!==typeof this[a]?this[a]:null};
function eeEventLog(a,b){return EEWeb.eventLog&&"undefined"!==typeof EEWeb.eventLog?EEWeb.eventLog:this instanceof eeEventLog?(this.errorLimit=a,this.errorByUrlLimit=b,this.events=[],this.maxEvents=50,this.dateObj=new Date,this.eeLoggrErrCount=0,this.eeLoggrErrorsByUrl={},this.internalEventsLimit=20,this.internalEvents={},eeEventObj.prototype.dateObj=this.dateObj,EEWeb.eventLog=this,this.initEventListeners(),this):new eeEventLog(arguments)}
function eeEventObj(a,b){this.event=a;this.info=b;this.timems=this.dateObj.getTime()}eeEventObj.prototype.dateObj=null;eeEventObj.prototype.toString=function(){return"<tr><td>"+this.timems+"</td><td>"+this.event+"</td><td>"+this.info+"</td></tr>"};eeEventLog.prototype.initEventHandler=function(a){var b=this;a.model.addListener(mxEvent.UNDO,function(a,d){for(var e=d.getProperty("edit").changes,f=0;f<e.length;f++)b.logEvent("undo["+f+"]",e[f].toString())})};
eeEventLog.prototype.initEventListeners=function(){var a=this;amplify.subscribe(EEWeb.events.PROJECT_PARSER_ERROR,function(b){a.logProjectParserError(b)})};eeEventLog.prototype.logEvent=function(a,b){for(;this.events.length>=this.maxEvents;)this.events.shift();var c=new eeEventObj(a,b);this.events.push(c)};
eeEventLog.prototype.ajaxError=function(a,b,c,d){a="Url: "+c.url+"\nStatus: "+b.status+"\nResponse: \n"+b.responseText+"\n";d&&(a=a+"Exception: "+d+"\n");c&&c.resourceId&&(a=a+"Resource ID: "+c.resourceId+"\n");c&&c.data&&(a=a+"Data: "+c.data+"\n");EEWeb.log?EEWeb.log.error(a):console.log(a);5100<a.length&&(a=a.substr(0,5100));d={extra:{event:"Ajax error"}};_.contains(["component_event","bom_event","partsearch_event","simulation_event"],c.resourceId)||EEWeb.raven&&EEWeb.raven.captureMessage(a,d)};
eeEventLog.prototype.logError=function(a,b,c){this.eeLoggrErrCount++;EEWeb.log&&EEWeb.log.error(b+": Line "+c+"\n"+a);try{if(!(b&&"string"===typeof b&&0===b.indexOf("extension")||this.eeLoggrErrCount>this.errorLimit)){var d=c+b;null==d&&(d="");100<d.length&&(d=d.substr(0,100));d in this.eeLoggrErrorsByUrl?this.eeLoggrErrorsByUrl[d]++:this.eeLoggrErrorsByUrl[d]=1;if(this.eeLoggrErrorsByUrl[d]>this.errorByUrlLimit)this.eeLoggrErrCount--;else if("Error loading script"==a)this.eeLoggrErrCount--;else if("Script error"!=
a||null!=b&&""!=b){a&&5100<a.length&&(a=a.substr(0,5100));var e=this.toString(!0),d="Javascript runtime error",d=475>a.length?d+(" :"+a):d+(" :"+a.substr(0,475));a={extra:{event:e,url:b,line:c,message:a}};EEWeb.raven&&EEWeb.raven.captureMessage(d,a)}else this.eeLoggrErrCount--}}catch(f){EEWeb.raven&&EEWeb.raven.captureException(f),EEWeb.log&&EEWeb.log.error("Exception:"+f)}};
eeEventLog.prototype.logProjectParserError=function(a){a={extra:a};EEWeb.raven&&EEWeb.raven.captureMessage("DOMParser Error",a)};eeEventLog.prototype.sendEvent=function(a,b,c,d){try{a in this.internalEvents?this.internalEvents[a]++:this.internalEvents[a]=1,this.internalEvents[a]>this.internalEventsLimit||(d+=EEWeb.eventLog.toString(!0),a={extra:{key:a,tags:b,data:d}},EEWeb.raven&&EEWeb.raven.captureMessage(c,a))}catch(e){EEWeb.raven&&EEWeb.raven.captureException(e),EEWeb.log.error("Exception:"+e)}};
eeEventLog.prototype.captureException=function(a){EEWeb.raven&&EEWeb.raven.captureException(a)};
eeEventLog.prototype.trackCompEvent=function(a,b){var c=EEWeb.app.getVendor().getVendorPartNumberKey(),d,e,f,g;e=a.params;d=e.manpn?e.manpn.val:"";e=e[c]?e[c].val:"";f=a.updated_on;g=a.hasParameterValue("manpn")||a.hasParameterValue(c);var h,k,m;k=b.params;h=k.manpn?k.manpn.val:"";k=k[c]?k[c].val:"";m=b.updated_on;c=b.hasParameterValue("manpn")||b.hasParameterValue(c);f!=m&&(!g&&c?this.sendCompEvent("add",b):g&&c?d!=h||e!=k?(this.sendCompEvent("delete",b),this.sendCompEvent("add",b)):this.sendCompEvent("update",
b):g&&!c&&this.sendCompEvent("delete",b))};eeEventLog.prototype.sendCompEvent=function(a,b){var c=this.buildCompEventData(a,b);amplify.request({resourceId:"component_event",data:c})};eeEventLog.prototype.buildCompEventData=function(a,b){var c={},d=b.params,e=EEWeb.app.getVendor(),f=e.getVendorPartNumberLabel(),e=e.getVendorPartNumberKey();c.action=a;c.component=d.name?d.name.val:"";c.part_number=d.manpn?d.manpn.val:"";c.manufacturer=d.manu?d.manu.val:"";c[f]=d[e]?d[e].val:"";return c};
eeEventLog.prototype.sendBomEvent=function(a,b){var c=this.buildBomEventData(a,b);amplify.request({resourceId:"bom_event",data:c})};
eeEventLog.prototype.buildBomEventData=function(a,b){var c={},d={},e=EEWeb.app.getProjectHandler();d.id=e.getId()||"";d.name=e.getName()||"";var e=EEWeb.app.getVendor(),f=e.getVendorPartNumberLabel(),g=e.getVendorPartNumberKey(),h=[];_.each(b,function(a){var b={};b.component=a.name||"";b.part_number=a.manpn||"";b.manufacturer=a.manu||"";b[f]=a[g]||"";h.push(b)});c.action=a;c.project=d;c.components=h;return c};
eeEventLog.prototype.sendPartSearchEvent=function(a,b){var c=EEWeb.app.getVendor().getName(),c=c.replace(/[-., ]/ig,"");null!=a&&""!=a&&amplify.request({resourceId:"partsearch_event",data:{vendor:c,keyword:a,results_count:b}})};eeEventLog.prototype.sendSimStartEvent=function(a){var b=EEWeb.app.getUser().uid||"";amplify.request({resourceId:"simulation_event",data:{action:"start",simulation_id:a,user_id:b}})};
eeEventLog.prototype.sendReferenceDesignEvent=function(a,b){var c=EEWeb.app.getUser();amplify.request({resourceId:"reference_design_event",data:{project_id:b,project_name:a,user_id:c.id||0,user_name:c.name||"guest"}})};eeEventLog.prototype.setUserContext=function(a){EEWeb.raven&&EEWeb.raven.setUserContext(a)};
eeEventLog.prototype.toString=function(a){for(var b="<table><tr><th>Time (ms)</th><th>Event</th><th>Info</th></tr>",c=0,d=this.events.length;c<d;c++)b+=this.events[c].toString();a&&(this.events=[]);return b+"</table>"};function eeEventSource(){this.handlers={}}eeEventSource.prototype.init=function(){return"undefined"!==typeof EEWeb.eventSource?EEWeb.eventSource:this instanceof eeEventSource?(EEWeb.eventSource=this,this):new eeEventSource};
eeEventSource.prototype.addHandler=function(a,b,c){"undefined"===typeof this.handlers[a]&&(this.handlers[a]=[]);this.handlers[a].push({h:b,info:c})};eeEventSource.prototype.removeHandler=function(a,b){this.handlers[a]instanceof Array&&(this.handlers[a]=_.filter(this.handlers[a],function(a){return a.h!==b}))};eeEventSource.prototype.fire=function(a){this.handlers[a._name]instanceof Array&&_.each(this.handlers[a._name],function(b){b.h(a)})};
eeEventSource.prototype.fire2=function(a,b,c){this.fire(new eeEventObject(a,b,c))};function eeEventObject(a,b,c){this._name=a;this._src=b;this._consumed=!1;_.extend(this,c)}eeEventObject.prototype.getProperty=function(a){return"undefined"!==typeof this[a]?this[a]:null};eeEventObject.prototype.isConsumed=function(){return this._consumed};eeEventObject.prototype.consume=function(){this._consumed=!0};eeEventObject.prototype.getName=function(){return this._name};eeEventObject.prototype.getSource=function(){return this._src};
var eeConstants={LABEL_REFDES:"refdes",LABEL_REFPREFIX:"refprefix",LABEL_VALUE:"value",LABEL_INFO:"info",LABEL_PARTNUM:"partnumber",LABEL_NETNAME:"netname",LABEL_MODEL:"model",LABEL_NETDCPOINT:"dcpoint",LABEL_NAME:"name",LABEL_MANPN:"manpn",LABEL_DKPN:"dkpn",LABEL_VENDORPN:"vendorpn",LABEL_DESC:"desc",LABEL_NOTES:"notes",LABEL_MANUFACTURER:"manu",MAX_PAGE_CNT:8,PAGE_FORMAT_5000:new mxRectangle(0,0,5E3,5E3)},EEWeb=void 0===EEWeb?{}:EEWeb;
EEWeb.events={UPDATE_PAGE_COUNT:"upd_pg_cnt",PAGE_CLICK:"page_click",PAGE_CHANGED:"page_changed",PAGE_COUNT_CHANGED:"page_cnt_changed",PAGE_EDIT:"page_edit",PAGE_NAME_CHANGE:"page_name_change",PAGE_DELETE:"page_delete",PAGE_DELETED:"page_deleted",PAGE_ADD:"page_add",PAGE_ADDED:"page_added",PAGE_MORE:"page_more",NEW_PROJECT:"project_new",OPEN_REFERENCE_DESIGN_PROJECT:"open_reference_design_project",LOAD_PROJECT:"project_load",LOAD_PROJECT_COMPLETE:"project_load_complete",PROJECT_SAVE_SESSION:"project_save_session",
PROJECT_RESTORE_SESSION:"project_restore_session",APP_LOADED:"app_loaded",AUTO_LOAD:"auto_load",TAB_CLICK:"tab_click",TAB_CHANGED:"tab_changed",NET_ADDED:"net_added",NET_DELETED:"net_deleted",NET_NAME_CHANGED:"net_name_changed",SIM_RESET:"sim_reset",SIM_STARTED:"sim_started",SIM_QUEUED:"sim_queued",SIM_DONE:"sim_done",SIM_FAILED:"sim_failed",SIM_DATA:"sim_data",SIM_CANCELLED:"sim_cancelled",SIM_STATUS:"sim_status",SIM_RUNNING:"sim_running",PROBES_CHANGED:"probes_changed",SHOW_DC_LABELS:"show_dc_labels",
SIM_REPORT_UPDATED:"sim_report_updated",DIALOG_CLOSED:"dialog_closed",USER_UPDATED:"user_updated",USER_LOGIN:"user_login",USER_LOGOUT:"user_logout",USER_SIGNUP:"user_signup",USER_LIVE_CHAT:"user_live_chat",USER_CONTACT_US:"user_contact_us",USER_IS_LOGGED_IN:"user_is_logged_in",USER_CHECK_ID:"user_check_id",CONTACT_US_OPTIONS:"contact_us_options",COMPONENT_UPDATED:"comp_updated",COMPONENT_ADDED:"comp_added",COMPONENT_DELETED:"comp_deleted",COMPONENTS_LOADED:"comps_loaded",REFRESH_BOM:"refresh_bom",
RESIZE:"resize",RESIZE_DONE:"resize_done",PROJECT_NAME_CHANGED:"proj_name_changed",PROJECT_MODIFIED:"proj_modified",CLEAR_PROJECT:"clear_proj",PROJECT_PARSER_ERROR:"project_parser_error",DKBAR_HIDE:"dkbar_hide",DKBAR_SHOW:"dkbar_show",COMP_DKBAR_HIDE:"comp_dkbar_hide",COMP_DKBAR_SHOW:"comp_dkbar_show",VENDORBAR_HIDE:"vendorbar_hide",VENDORBAR_SHOW:"vendorbar_show",REPOS_DIALOGS:"repos_dialogs",ZOOM_IN:"zoom_in",ZOOM_OUT:"zoom_out",ZOOM_TO:"zoom_to",ZOOM_RESET:"zoom_reset",ZOOM_POS_TO:"zoom_pos_to",
ZOOM_FIT:"zoom_fit",INSERT_TEXT_BOX:"insert_text_box",RENEW_ACCESS_TOKEN:"renew_access_token",COMP_CLEAR_DRAG:"comp_clear_drag",CHECK_IS_DUPLICATE_REFDES:"check_is_duplicate_refdes",OPEN_PRINT_PREVIEW_SETUP:"open_print_preview_setup",OPEN_NOTES:"open_notes",BOM_EXPORT_XML:"bom_export_xml",OPEN_SAVE_AS_PROJECT_DLG:"open_save_as_dlg",CLOSE_SAVE_AS_PROJECT_DLG:"close_save_as_dlg",SAVE_AS_PROJECT:"save_as_project",BOM_QUOTE:"bom_quote",BOM_EXPORT:"bom_export",BOM_ORDER:"bom_order",ROTATE_SYMBOL:"rotate-symbol",
INIT_CATEGORIES:"init_categories",INIT_DLG_CATEGORY_APPLICATION:"init_dlg_category_application",INIT_DLG_CATEGORY_TYPE:"init_dlg_category_type",SAVE_CATEGORIES:"save_categories",REMOVE_CATEGORIES:"remove_categories",REMOVE_DLG_CATEGORY_APPLICATION:"remove_dlg_category_application",REMOVE_DLG_CATEGORY_TYPE:"remove_dlg_category_type",INIT_TAGS:"init_tags",INIT_DLG_TAGS:"init_dlg_tags",SAVE_TAGS:"save_tags",REMOVE_TAGS:"remove_tags",REMOVE_DLG_TAGS:"remove_dlg_tags",SHOW_ALERT:"show_alert",OPEN_LINK_URL_DIALOG:"open_link_url_dialog",
OPEN_IMAGE_URL_DIALOG:"open_image_url_dialog",EDIT_COMP_IMAGE_URL:"edit_comp_image_url",USER_MODELS_UPDATED:"user_models_updated",MODEL_LIST_UPDATED:"model_list_updated",SELECTED_MODEL_UPDATED:"selected_model_updated"};function eeHelper(){return this instanceof eeHelper?(this.dragElement=null,this.hitRect=new mxRectangle(0,0,0,0),this.currData=null,this.isDragStart=!1,this):new eeHelper}eeHelper.prototype.init=function(){this.initHandlers()};eeHelper.prototype.getData=function(){return this.currData};
eeHelper.prototype.setData=function(a){return this.currData=a};
eeHelper.prototype.initHandlers=function(){var a=this,b=$("#schematic");b.bind("mousemove",function(b,d){a.onMouseMove(b.clientX,b.clientY)});b.bind("click",function(b,d){a.onSchematicClick(b.clientX,b.clientY,b.shiftKey)});amplify.subscribe(EEWeb.events.INSERT_TEXT_BOX,function(){var a=EEWeb.app.getUtils(),b=a.getCenterPtOnSchematic(190,120);a.newComponentFromSidebar(b,{component_type:"uml",attributes:{style:"text;html=1;verticalAlign=top;align=left;spacingTop=5;whiteSpace=wrap;overflow=hidden;textAlign=left;fillColor=transparent;strokeColor=transparent",name:"Textbox",
geometry:{y:0,x:0,height:120,width:190},text:"<p style='margin:0px;'><font style='font-size:2em;'><b>Heading</b></font></p><p style='margin-top:5px;'>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>",bom_include:!1,description:""}})});amplify.subscribe(EEWeb.events.RESIZE_DONE,function(){a.onResizeDone()});amplify.subscribe(EEWeb.events.COMP_CLEAR_DRAG,function(){a.clearDragElement()});amplify.subscribe(EEWeb.events.ROTATE_SYMBOL,
function(){a.rotateDragElement()})};eeHelper.prototype.getDragElement=function(){return this.dragElement};eeHelper.prototype.getRotation=function(){return this.objectRotation};eeHelper.prototype.getPreview=function(){return this.preview};eeHelper.prototype.validDragElement=function(){return null!==this.dragElement};
eeHelper.prototype.setDragElement=function(a){$("body").attr("unselectable","off").removeClass(".no_select");null!==this.dragElement&&($(this.dragElement).remove(),this.dragElement=null);a&&(this.dragElement=a,$("body").attr("unselectable","on").addClass(".no_select"),AspenLabs.ieVersion&&"8"==AspenLabs.ieVersion&&0<$("#schematic > div").length?$("#schematic > div").append(a):$("#schematic").append(a))};
eeHelper.prototype.clearDragElement=function(){this.setDragElement(null);$(document).unbind(".compdrag");this.isDragStart=!1;this.preview=null;this.objectRotation=0};
eeHelper.prototype.createDragElement=function(a){this.clearDragElement();var b=null,c=EEWeb.app.getGraph();c.connectionHandler.reset();c.clearSelection();this.bindDragCancel();var d=$(a).data("component");if(d){this.setData(d);var e=d.obj.component_type;if("uml"===e)b=$(".component-preview",a).clone();else if(d.obj.stencil){var f=d.obj,b=$("<div></div>");a=new mxGraph(b.get(0));a.cellsSelectable=!1;var g="component;shape=component_"+f.stencil,f=mxStencilRegistry.getStencil("component_"+f.stencil),
c=a.insertVertex(a.getDefaultParent(),null,"",0,0,f.w0*c.view.scale,f.h0*c.view.scale,g);EEWeb.log.info("Created mxGraph Drag Element");b=$("> div",b)[0]||b[0];this.dragSymbol=c;this.preview=a}else"dk"===d.type||"assign_draggable"===d.type?(EEWeb.log.info("Created clone Drag Element"),b=$(a).clone(),c=$(a).attr("src"),d.obj.setElementSource(c)):"mouser"===d.type?(EEWeb.log.info("Created clone Drag Element"),b=$(a).clone(),c=$(a).attr("src"),d.obj.imageUrl!=c&&(d.obj.imageUrl=c)):(EEWeb.log.info("Created a template or stencil item."),
b=$(".component-preview",a).clone());this.dragElementComponentType=e}b&&$(b).css({position:"absolute","z-index":3E3,left:"-1000px",top:"-1000px",opacity:0.75});EEWeb.eventLog.logEvent("eeHelper.createDragElement","type: "+(d?d.type:"no type"));return b};eeHelper.prototype.rotateDragElement=function(){if(this.validDragElement()&&this.isRotatableDragElementType()){EEWeb.eventLog.logEvent("dragElement.rotate","");var a=this.dragSymbol;EEWeb.app.getEditor().execute("rotate",a);this.updateRotation()}};
eeHelper.prototype.isRotatableDragElementType=function(){return 0>["uml","t"].indexOf(this.dragElementComponentType)};eeHelper.prototype.updateRotation=function(){this.objectRotation=(this.objectRotation+90)%360};eeHelper.prototype.onMouseMove=function(a,b){if(!this.isDragStart&&this.validDragElement()){var c=$("#schematic").offset(),d=a-c.left,c=b-c.top;EEWeb.log.info("Drag element moved to "+c+","+d+".");$(this.dragElement).css({left:d+"px",top:c+"px"})}};
eeHelper.prototype.onSchematicClick=function(a,b,c){EEWeb.eventLog.logEvent("schematicItem.click","");if(!this.isDragStart&&this.validDragElement()){var d=this.getData();this.onInsertItem(d,a,b);c||this.clearDragElement()}EEWeb.app.getGraph().hasAssignableSelectedObject()?amplify.publish("component-selected"):amplify.publish("component-deselected")};
eeHelper.prototype.onResizeDone=function(){var a=$("#schematic-wrapper"),b=a.offset(),c=a.width(),a=a.height();this.hitRect=new mxRectangle(b.left,b.top,c,a)};
eeHelper.prototype.onDragStart=function(a){EEWeb.eventLog.logEvent("eeHelper.onDragStart","");var b=null;this.clearDragElement();this.dragCancel=!1;b=this.createDragElement(a);this.setDragElement(b);this.isDragStart=!0;EEWeb.app.getGraph().hasAssignableSelectedObject()?amplify.publish("component-selected"):amplify.publish("component-deselected");return b};
eeHelper.prototype.onDrag=function(a,b,c){this.dragCancel||(a=$(a).data("draggable"))&&a.offset&&a.offset.click&&(a.offset.click.top=0,a.offset.click.left=0);return!this.dragCancel};eeHelper.prototype.onDragStop=function(a,b,c){EEWeb.eventLog.logEvent("listItems.dragstop","");$(a).css({top:0,left:0});a=this.getData();this.onInsertItem(a,b,c);this.clearDragElement()};eeHelper.prototype.onDragCancel=function(){this.clearDragElement();$(document).unbind(".compdrag");this.dragCancel=!0};
eeHelper.prototype.onClick=function(a){this.isDragStart=!1;var b=null;this.clearDragElement();b=this.createDragElement(a);this.setDragElement(b);return b};
eeHelper.prototype.onInsertItem=function(a,b,c){if(b=this.getSchematicPoint(b,c)){c=EEWeb.app.getUtils();var d=this.getRotation();c.setRotation(d);d=a.hasOwnProperty("type")?a.type:a.obj.component_type;EEWeb.eventLog.logEvent("eeHelper.onInsertItem","type: "+d);switch(d){case "t":c.newTemplateFromSidebar(b,a.obj);break;case "assign_draggable":(a=this.getTargetComponent())&&amplify.publish("component-assign",!1,[a]);break;case "dk":c.newComponentFromDKSearch(b,a.obj);break;case "mouser":c.newComponentFromVendorSearch(b,
a.obj,"MO");break;default:c.newComponentFromSidebar(b,a.obj)}}};eeHelper.prototype.getTargetComponent=function(){return EEWeb.app.getGraph().getDragItemHandler().getComponent()};eeHelper.prototype.bindDragCancel=function(){$(document).unbind(".compdrag");this.dragCancel=!1;var a=this;$(document).bind("keyup.compdrag",function(b){27===b.keyCode&&a.validDragElement()&&(b.stopPropagation(),a.onDragCancel(),$(document).trigger("mouseup"),amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({})))})};
eeHelper.prototype.getSchematicPoint=function(a,b){if(!mxUtils.contains(this.hitRect,a,b))return null;var c=EEWeb.app.getGraph(),d=mxUtils.convertPoint(c.container,a,b),e=c.view.scale,f=c.view.translate;d.x=c.snap(d.x/e-f.x);d.y=c.snap(d.y/e-f.y);return d};eeHelper.prototype.getDomainName=function(){return eeServerData.vendorDomainName||eeServerData.domainName};eeHelper.prototype.getHomePage=function(){return eeServerData.homePage};eeHelper.prototype.getChatUrl=function(){return eeServerData.chatUrl};
function testWireConnector(){var a=EEWeb.app.getGraph(),b=a.getModel().getCell(2),c=b.children[1],b=a.getView().getState(b,!0),a=a.getView().getState(c,!0),c=[new mxPoint(200,220),new mxPoint(100,230),new mxPoint(80,350),new mxPoint(200,360)];b.absolutePoints=[new mxPoint(200,190),new mxPoint(190,260)];var d=[];d.push(b.absolutePoints[0]);mxEdgeStyle.WireConnector(b,a,null,c,d);b.absolutePoints=[new mxPoint(200,190),new mxPoint(200,260)];var e=[];e.push(b.absolutePoints[0]);mxEdgeStyle.WireConnector(b,
a,null,c,e);EEWeb.log.info("\n"+EEWeb.app.getUtils().pointsToString("result1",d)+"\n"+EEWeb.app.getUtils().pointsToString("result2",e))}
mxEdgeStyle.WireConnector=function(a,b,c,d,e){var f=!0,g=null;if("object"===typeof b&&null!==b&&a.view.graph.model.isEdge(b.cell))f="horizontal"===a.style.sourceConstraint;else if("object"===typeof b&&null!==b){var f="vertical"!=b.style.portConstraint,h=b.style[mxConstants.STYLE_DIRECTION];if("north"===h||"south"===h)f=!f}var h=a.absolutePoints,k=h[0]?h[0].clone():null,m=null;"object"===typeof b&&null!==b&&(m=new mxPoint(b.getCenterX(),b.getCenterY()));null===k&&"object"===typeof b&&null!==b&&(k=
m);if(null!==k){b=k;if(null!==d&&0<d.length)for(m=0;m<d.length;m++){var f=!f,n=d[m];null===n?(EEWeb.log.error("Waypoint["+m+"] is null!"),n="<ul><li>"+EEWeb.app.getUtils().pointsToString("waypts",d)+"</li><li>"+EEWeb.app.getUtils().pointsToString("result",e)+"</li><li>"+EEWeb.app.getUtils().pointsToString("abspts",a.absolutePoints)+"</li><li>horizontal? "+f+"</li></ul><br>",EEWeb.eventLog.sendEvent("edgewp","wiring","Detected a wiring issue",n)):(g=a.view.transformControlPoint(a,n),null===g?EEWeb.log.error("transformed waypoint is null!"):
f?k.y!==g.y&&(k.y=g.y,e.push(k.clone())):k.x!==g.x&&(k.x=g.x,e.push(k.clone())))}else g=k;k=h[h.length-1];null===k&&"object"===typeof c&&null!==c&&(k=new mxPoint(a.view.getRoutingCenterX(c),a.view.getRoutingCenterY(c)));null!==k&&null!==g&&null!==b?f?k.y!==g.y&&b.x!==k.x&&e.push(new mxPoint(k.x,g.y)):k.x!==g.x&&b.y!==k.y&&e.push(new mxPoint(g.x,k.y)):(EEWeb.log.error("terminal point won't be calculated!"),n="<ul><li>"+EEWeb.app.getUtils().pointsToString("waypts",d)+"</li><li>"+EEWeb.app.getUtils().pointsToString("result",
e)+"</li><li>"+EEWeb.app.getUtils().pointsToString("abspts",a.absolutePoints)+"</li><li>horizontal? "+f+"</li></ul><br>",EEWeb.eventLog.sendEvent("edgeterm","wiring","Terminal point problem",n));EEWeb.debug.LogEdgeStyle&&EEWeb.log.info(" "+EEWeb.app.getUtils().pointsToString("waypts",d)+" "+EEWeb.app.getUtils().pointsToString("result",e)+" "+EEWeb.app.getUtils().pointsToString("abspts",a.absolutePoints)+" horizontal? "+f)}};mxStyleRegistry.putValue("wireEdgeStyle",mxEdgeStyle.WireConnector);
function eeValidationRules(){this.init()}eeValidationRules.prototype.rules=null;eeValidationRules.prototype.factors=null;eeValidationRules.prototype.types=null;eeValidationRules.prototype.init=function(){this.factors="m u n p f k MEG G".split(" ");this.initConverters();this.initRules()};
eeValidationRules.prototype.initConverters=function(){this.types={voltage:{units:["V",l("volts")],converter:null},current:{units:["A",l("amps")],converter:null},resistance:{units:["Ohm",l("ohms")],converter:null},time:{units:["S",l("seconds")],converter:null},capacitance:{units:["F",l("farads")],converter:null},inductance:{units:["H",l("henrys")],converter:null},conductance:{units:["Mhos",l("mhos")],converter:null},frequency:{units:["Hz",l("hertz")],converter:null}};_.each(_.values(this.types),function(a){a.converter=
this.buildConverter(this.factors,a.units)},this)};
eeValidationRules.prototype.initRules=function(){this.rules={};this.rules.voltage=this.validateFloatUnits(l("voltage"),null,null,"T Meg k K m u n f p".split(" "),["V",l("volts")]);this.rules.current=this.validateFloatUnits(l("current"),null,null,"kKmunfp".split(""),["A",l("amps"),l("amperes")]);this.rules.resistance=this.validateFloatUnits(l("resistance"),0,null,"T G Meg k K m u n".split(" "),[l("ohm"),l("ohms")]);this.rules.capacitance=this.validateFloatUnits(l("capacitance"),0,null,"m u n p f k K Meg T".split(" "),
["F",l("farads")]);this.rules.conductance=this.validateFloatUnits(l("conductance"),0,null,"m u n p f k K Meg T".split(" "),[l("ohm"),l("ohms")]);this.rules.inductance=this.validateFloatUnits(l("inductance"),0,null,"m u n p f k Meg".split(" "),["H",l("henrys")]);this.rules.delaytime=this.validateFloatUnits(l("time"),null,null,"p f n u m K Meg".split(" "),["S",l("seconds")]);this.rules.meter=this.validateFloatUnits(l("meter"),null,null,"p f n u m K Meg".split(" "),["m",l("meter")]);this.rules.posdelaytime=
this.validateFloatUnits(l("time"),0,null,"p f n u m K Meg".split(" "),["S",l("seconds")]);this.rules.seconds=this.validateFloatUnits(l("seconds"),null,null,"p f n u m K Meg".split(" "),["S",l("seconds")]);this.rules.posseconds=this.validateFloatUnits(l("seconds"),0,null,["p","f","n","u","m"],["S",l("seconds")]);this.rules.frequency=this.validateFloatUnits(l("frequency"),0,null,["k","K","Meg","G","T"],["Hz",l("hertz")]);this.rules.posint=this.validateInt(0,null);this.rules.stepint=this.validateInt(2,
null);this.rules.npts={errorText:null,isValid:function(a){if(null!=a&&0<a)return!0;this.errorText=l("value_is_min",{minval:1});return!1}};this.rules["1fexponent"]=this.validateFloat(0,2);this.rules.couplcoeff=this.validateFloat(0,1);this.rules.temp=this.validateTemp(-273,1E3,["C","F"]);this.rules["float"]=this.validateFloat(null,null);this.rules.posfloat=this.validateFloat(0,null);this.rules.refdes=this.validateRefdes();this.rules["default"]={errorText:null,isValid:function(){return!0}};this.rules.required=
{errorText:null,isValid:function(a){if(null!=a&&0<a.length)return!0;this.errorText=l("fieldisrequired");return!1}};for(var a in this.rules)this.rules[a].name=a};eeValidationRules.prototype.getRule=function(a){return a in this.rules?this.rules[a]:this.rules["default"]};
eeValidationRules.prototype.getFactor=function(a){var b=1;switch(a){case "m":b=0.001;break;case "u":b=1E-6;break;case "n":b=1E-9;break;case "p":b=1E-12;break;case "f":b=1E-15;break;case "K":case "k":b=1E3;break;case "Meg":b=1E6;break;case "G":b=1E9;break;case "T":b=1E9}return b};eeValidationRules.prototype.splitFloat=function(a,b,c){return/^-?(?:(\d+(\.\d+)?|\.?\d+)([eE]-?\d+)?)\s*([A-Za-z]*)$/g.exec(a)};
eeValidationRules.prototype.validateFloatUnits=function(a,b,c,d,e){var f="(?:"+e.join("|")+")",g="("+d.join("|")+")",h=RegExp("^"+g+"$","i"),k=RegExp("^"+f+"$","i"),m=RegExp("^"+g+f+"$","i"),n=RegExp("^"+g+"(.*)$","i"),p=RegExp("^(.*)"+f+"$","i"),q=this;return{errorText:null,isValid:function(f,g){this.errorText=null;if(""===f)return!0;var r=q.splitFloat(f);if(r){var w=r[1],s=1;if(r[4])if(r=r[4],m.test(r))s=m.exec(r),s=q.getFactor(s[1]);else if(h.test(r))s=h.exec(r),s=q.getFactor(s[1]);else if(!k.test(r)){if(s=
n.exec(r))return this.errorText=l("invalid_units",{units:s[2]})+"<br>"+ +l("invalid_units_mustbe",{valid_units:e.join(",")}),!1;if(s=p.exec(r))return this.errorText=l("invalid_multiplier",{multiplier:s[1]})+"<br>"+l("invalid_multiplier_mustbe",{valid_multiplier:d.join(",")}),!1;this.errorText=l("invalid_characters",{characters:r})+"<br>"+l("invalid_characters_mustbe",{valid_multiplier:d.join(","),valid_units:e.join(",")});return!1}w=parseFloat(w);w*=s;return null!=b&&w<b?(this.errorText=l("value_mustbe_min",
{minval:b}),!1):null!=c&&w>c?(this.errorText=l("value_mustbe_max",{minval:c}),!1):!0}this.errorText=l("value_not_valid",{value:a});return!1}}};eeValidationRules.prototype.validateInt=function(a,b){return{errorText:null,isValid:function(c,d){c=String(c);if(""===c)return!0;if(c.match(/^[0-9]+$/)){var e=parseInt(c,10);return null!==a&&e<a?(this.errorText=l("value_is_min",{minval:a}),!1):null!==b&&e>b?(this.errorText=l("value_is_max",{maxval:b}),!1):!0}this.errorText=l("expectedaninteger");return!1}}};
eeValidationRules.prototype.validateFloat=function(a,b){var c=this;return{errorText:null,isValid:function(d,e){if(""===d)return!0;var f=c.splitFloat(d);if(f){if(f[4])return this.errorText=l("nounitsormultiallowed_floatvalue"),!1;f=parseFloat(f[1]);return null!=a&&f<a?(this.errorText=l("value_is_min",{minval:a}),!1):null!=b&&f>b?(this.errorText=l("value_is_max",{maxval:b}),!1):!0}this.errorText=l("expectedfloatingpointnumber");return!1}}};
eeValidationRules.prototype.validateTemp=function(a,b,c){var d=this;return{errorText:null,isValid:function(c,f){this.errorText=null;if(""===c)return!0;if(g=d.splitFloat(c,null,g)){if(g[4]){var g=g[4];if("C"===g||"F"===g)return!0;this.errorText=1<g.length?l("temptoolong_mustbecorf"):l("tempunitsmustbe_corforblank");return!1}g=parseFloat(g[1]);return null!==a&&g<a?(this.errorText=l("temp_is_min",{minval:a}),!1):null!==b&&g>b?(this.errorText=l("temp_is_max",{maxval:b}),!1):!0}this.errorText=l("tempmustbefloatingpoint");
return!1}}};
eeValidationRules.prototype.validateRefdes=function(){return{errorText:null,isValid:function(a,b){this.errorText=null;if("string"===typeof a&&""!==a){var c=b.prefix.length,d=amplify.publish(EEWeb.events.CHECK_IS_DUPLICATE_REFDES,a);if(a.length<=c)this.errorText=l("refdes_invalid",{prefix:b.prefix});else if(d)this.errorText=l("duplicate_refdes");else if(/[^A-Za-z]/g.test(a.substr(0,1)))this.errorText=l("refdes_prefix_invalid_character");else if(/[\W\s]+/g.test(a))this.errorText=l("refdes_invalid_format");else{if(a.substr(0,
c)===b.prefix)return!0;this.errorText=l("refdes_prefix_invalid",{prefix:b.prefix})}return!1}return!0}}};eeValidationRules.prototype.convertType=function(a,b){return b in this.types?this.types[b].converter(a):null};
eeValidationRules.prototype.buildConverter=function(a,b){var c=RegExp("^(?:"+b.join("|")+")$","i"),d={};_.each(a,function(a){d[a]=!0});var e=this;return function(a,b){this.errorText=null;if(""===a)return null;var h=e.splitFloat(a);if(!h)return null;var k=h[1],m=1;if(h[4]){var h=h[4],n=h.slice(0,1);if(n in d){if(m=e.getFactor(n),h=h.slice(1),0<h.length&&!c.test(h))return null}else if(!c.test(h))return null}k=parseFloat(k);return k*m}};
function eeUtils(){return EEWeb.utils&&"undefined"!==typeof EEWeb.utils?EEWeb.utils:this instanceof eeUtils?(this.previewSprite=EEBasepath+"img/symbols/preview-sprite.png",this.shapesSprite=EEBasepath+"img/symbols/shapes-sprite.png",this.stencilFile=EEBasepath+"resources/customsymbol.xml",EEWeb.utils=this,this):new eeUtils}eeUtils.prototype.getProperty=function(a,b){var c=a.getProperty(b);return"undefined"===typeof c?null:c};
eeUtils.prototype.loadStencils=function(a){EEWeb.eventLog.logEvent("eeUtils.loadStencils","");a=a||this.stencilFile;for(a=mxUtils.load(a).getDocumentElement().firstChild;null!=a;)a.nodeType==mxConstants.NODETYPE_ELEMENT&&mxStencilRegistry.addStencil("component_"+a.getAttribute("name"),new mxStencil(a)),a=a.nextSibling};eeUtils.prototype.loadVendorData=function(){};
eeUtils.prototype.componentStyle=function(a){var b="";a.preview&&(b="background: transparent url('"+(a.preview.image?a.preview.image:this.previewSprite)+"') no-repeat -"+(a.preview.position.x?50*a.preview.position.x:"0")+"px -"+(a.preview.position.y?40*a.preview.position.y:"0")+"px");return b};eeUtils.prototype.loadSpiceModels=function(){amplify.request({resourceId:"component-models",success:function(a,b){eeSpiceModels=a},error:function(a,b){}})};
eeUtils.prototype.loadDynamicStencilDefs=function(){amplify.subscribe("set-stencildefs",function(a){if("undefined"==typeof eeSymbolDict||null==typeof eeSymbolDict)eeSymbolDict={};eeSymbolDict=_.extend(eeSymbolDict,a)})};
eeUtils.prototype.loadComponents=function(){var a=EEWeb.app.getComponentMgr(),b="";mxClient.IS_IE&&(b='onselectstart="return false;" ');var c=_.keys(components);_.each(c,function(c){var e=$("#components_"+c+" ul");_.each(components[c],function(c){"pid"in c&&a.addComponentByPid(c.pid,c);var d=$("<li></li>"),h=this.componentStyle(c);d.append('<div class="component-preview" '+b+'style="'+h+'"></div><div class="component-name" '+b+">"+c.name+'</div><div class="component-description">'+c.description+"</div>");
d.data("component",{type:"c",obj:c});e.append(d)},this)},this)};eeUtils.prototype.loadDynamicComponents=function(){var a=EEWeb.app.getComponentMgr(),b=this;amplify.subscribe("set-component",function(c,d,e){d.attr("style",b.componentStyle(c,e));"pid"in c&&a.addComponentByPid(c.pid,c)})};
eeUtils.prototype.loadDynamicStencils=function(){amplify.subscribe("set-stencil",function(a){EEWeb.eventLog.logEvent("eeUtils.loadDynamicStencils","");for(a=$(a).find("shapes")[0].firstChild;null!=a;)a.nodeType==mxConstants.NODETYPE_ELEMENT&&mxStencilRegistry.addStencil("component_"+a.getAttribute("name"),new mxStencil(a)),a=a.nextSibling})};
eeUtils.prototype.loadSymbols=function(){var a=_.keys(symbols);_.each(a,function(a){var c=$("#symbols_"+a+" ul");_.each(symbols[a],function(a){var b=$("<li></li>");if(a.preview)var f="background: transparent url('"+(a.preview.image?a.preview.image:this.shapesSprite)+"') no-repeat -"+(a.preview.position.x?50*a.preview.position.x:"0")+"px -"+(a.preview.position.y?40*a.preview.position.y:"0")+"px";b.append('<div class="component-preview" style="'+f+'"></div><div class="component-name">'+a.name+"</div>");
b.data("component",{type:"s",obj:a});c.append(b)},this)},this)};
eeUtils.prototype.loadCustomSymbols=function(){var a=$("#custom_templates ul"),b=_.keys(custom_symbols);_.each(b,function(b){var d="symbol"==b?this.shapesSprite:this.previewSprite;_.each(custom_symbols[b],function(e){var f=$("<li></li>");if(e.preview)var g="background: transparent url('"+d+"') no-repeat -"+(e.preview.position.x?50*e.preview.position.x:"0")+"px -"+(e.preview.position.y?40*e.preview.position.y:"0")+"px";f.append('<div class="component-preview" style="'+g+'"></div><div class="component-name">'+
e.name+'</div><div class="component-description">'+e.description+"</div>");e.symType=b;f.data("component",{type:"t",obj:e});a.append(f)},this)},this)};eeUtils.prototype.loadComponentData=function(){EEWeb.eventLog.logEvent("eeUtils.loadComponentData","");this.loadComponents();this.loadSymbols();this.loadCustomSymbols();$("ul.level_3 > li:only-child span").hide().siblings("ul.level_4").show()};
eeUtils.prototype.loadParameterSets=function(){var a=this,b=this.fetchInterval?this.fetchInterval:10;amplify.request({resourceId:"paramset",success:function(a,b){_.extend(a,window.eeParameterSets?window.eeParameterSets:{});window.eeParameterSets=a},error:function(c,d){var e=1E3*b;setTimeout(function(){a.loadParameterSets()},e);a.fetchInterval=b+10;a.timeInWords(e/1E3);EEWeb.eventLog.logError("Failed to load the paramsets.","eeUtils.prototype.loadParameterSets","351")}})};
eeUtils.prototype.getVertexLocations=function(a){var b=EEWeb.app.getGraph(),c=[];a=null!=a?a:b.getDefaultParent();if(null!=a)for(var d=b.model.getChildCount(a)-1;0<=d;d--){var e=b.model.getChildAt(a,d),c=c.concat(this.getVertexLocations(e));if(b.isCellVisible(e)&&b.model.isVertex(e)&&e instanceof eeComp){var f=b.view.getState(e);c.push("Cell id("+e.id+") at "+f.toString())}}return c};
eeUtils.prototype.calcEdgeLocation=function(a,b,c){var d=EEWeb.app.getGraph(),e=d.view.scale,f=d.getCellBounds(a),g=f.x,h=f.y,k=f.width,f=f.height,m=null,n=null,p=null;switch(b){case "Top":b=d.snap(c.x-g)/10;do m=g+10*b,n=h-20*e,b++,p=d.getCellAt(m,n,a,!0,!1);while(p&&p.isASmartPin());break;case "Bottom":b=d.snap(c.x-g)/10;do m=g+10*b,n=h+f,b++,p=d.getCellAt(m,n,a,!0,!1);while(p&&p.isASmartPin());break;case "Left":b=d.snap(c.y-h)/10;do m=g-20*e,n=h+10*b,b++,p=d.getCellAt(m,n,a,!0,!1);while(p&&p.isASmartPin());
break;case "Right":b=d.snap(c.y-h)/10;do m=g+k,n=h+10*b,b++,p=d.getCellAt(m,n,a,!0,!1);while(p&&p.isASmartPin())}e=d.view.scale;return new mxPoint((m-g)/e,(n-h)/e)};eeUtils.prototype.getRotation=function(){return this.componentRotation};eeUtils.prototype.setRotation=function(a){this.componentRotation=a};eeUtils.prototype.rotateInsertedCell=function(a){for(var b=this.getRotation()/90,c=EEWeb.app.getEditor();0<b;)c.execute("rotate",a),b--};
eeUtils.prototype.newTemplateFromSidebar=function(a,b){EEWeb.eventLog.logEvent("eeUtils.newTemplateFromSidebar","");var c=EEWeb.app.getGraph();c.getModel().beginUpdate();try{var d=null,d=b.stencil?this.newStencilTemplate(a,b):this.newCustomComponent(a,b);this.rotateInsertedCell(d);c.setSelectionCells([d]);amplify.publish(EEWeb.events.COMPONENT_ADDED,new ALEvent({comp:d,redo:!1,newcomp:!0}))}finally{c.getModel().endUpdate()}};
eeUtils.prototype.newStencilTemplate=function(a,b){EEWeb.eventLog.logEvent("eeUtils.newTemplateFromSidebar","stencil");var c=EEWeb.app.getGraph(),d="component;shape=component_"+b.stencil,e=mxStencilRegistry.getStencil("component_"+b.stencil),f=c.view.scale,g=c.view.translate,h=new mxPoint(a.x,a.y);h.x=c.snap((h.x+g.x)*f);h.y=c.snap((h.y+g.y)*f);if((f=c.getCellAt(h.x,h.y,null,!0,!1))&&f instanceof eeCusComp){var g=f.nextPinNumber++,k=b.text+g,h=this.calcEdgeLocation(f,b.pinLoc,h),m=b&&("Top"==b.pinLoc||
"Bottom"==b.pinLoc),n=b&&("Left"==b.pinLoc||"Right"==b.pinLoc);h.x>=f.geometry.width&&m&&(h.x=f.geometry.width-b.width);h.y>=f.geometry.height&&n&&(h.y=f.geometry.height-b.height);d=EEWeb.app.addSmartPin(f,k,g,b.pinLoc,c.snap(h.x),c.snap(h.y),e.w0,e.h0,d);for(e=0;e<b.pins.length;e++){f=b.pins[e];g="horizontal";if("north"==f.direction||"south"==f.direction)g="vertical";k=new mxPoint(0,0);null!=f.position&&(k=new mxPoint(f.position.x,f.position.y));h=new mxPoint(8,8);null!=f.dimensions&&(h=new mxPoint(f.dimensions.x,
f.dimensions.y));g=c.insertVertex(d,f.id,f.text,k.x,k.y,h.x,h.y,(f.label?"pin-label-"+f.label:"pin-label-top")+";portConstraint="+g);g.geometry.offset=new mxPoint(f.offset.x,f.offset.y);g.geometry.relative=!0;g.direction=f.direction;g.isCustomPin=!0}return d}EEWeb.app.getUtils().show_alert(l("alertdroppinon_customsymbol"))};
eeUtils.prototype.newCustomComponent=function(a,b){EEWeb.eventLog.logEvent("eeUtils.newTemplateFromSidebar","no stencil");var c=EEWeb.app.getGraph(),d=130,e=50;b.width&&(d=b.width);b.height&&(e=b.height);var f=[{anchor:"BL",lbldefault:b.partnumber?b.partnumber:"Default Part Number",line:0,name:"manpn",pos:"TL"},{anchor:"BR",lbldefault:b.value?b.value:"Default Value",line:1.5,name:"value",pos:"LT"}],d=EEWeb.app.addCustomComponent("U","","",c.snap(a.x),c.snap(a.y),d,e,b.style,f,null);mxUtils.setCellStyles(c.model,
[d],mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);mxUtils.setCellStyles(c.model,[d],mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);mxUtils.setCellStyles(c.model,[d],mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_TOP);mxUtils.setCellStyles(c.model,[d],mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM);b.bom_include&&(d.bom_include=!0);null!=b.description&&d.setParameter(null,"desc",b.description);b.paramsets&&d.initParamSets(b.paramsets);d.updateParametersFromData(b);
return d};
eeUtils.prototype.newComponentFromSidebar=function(a,b){EEWeb.eventLog.logEvent("eeUtils.newComponentFromSidebar","");var c=EEWeb.app.getGraph();c.getModel().beginUpdate();try{var d=null,e=b.component_type,d="generic"==e||"vendor"==e||"C"==e?this.newStencilComponent(a,b):"system_level"==e||"L"==e?this.newStencilSymbol(a,b):"uml"==e?this.newUMLComponent(a,b.attributes):this.newSymbolComponent(a,b);this.rotateInsertedCell(d);c.setSelectionCells([d]);if(AspenLabs.ieVersion&&8>=AspenLabs.ieVersion){var f=$("#schematic-wrapper"),
g=$("#schematic"),h=f.offset().left-g.offset().left,k=f.offset().top-g.offset().top;g.focus();f.scrollLeft(h);f.scrollTop(k)}amplify.publish(EEWeb.events.COMPONENT_ADDED,new ALEvent({comp:d,redo:!1,newcomp:!0}))}finally{c.getModel().endUpdate()}};
eeUtils.prototype.newStencilComponent=function(a,b){var c="component;shape=component_"+b.stencil,d=EEWeb.app.getGraph(),c=c+";"+mxConstants.STYLE_DIRECTION+"=east;rotation=0",e=mxStencilRegistry.getStencil("component_"+b.stencil),f=null,f=EEWeb.app.insertComponent(b.pid,b.ref_prefix,"",b.spice_type?b.spice_type:"",d.snap(a.x),d.snap(a.y),e.w0,e.h0,c,b.labels,b.labelStart);b.bom_include?f.bom_include=!0:eeServerData.bomIncludeAllowAll&&(f.bom_include_user_allowed=!1);b.paramsets&&f.initParamSets(b.paramsets);
b.params&&f.initParameters(b.params);f.setConnectable(!1);f.setCreationDate();b.name&&f.setParameter(null,"name",b.name);b.part_number&&f.setParameter(null,"manpn",b.part_number,0);b.manufacturer&&f.setParameter(null,"manu",b.manufacturer,0);b.description&&f.setParameter(null,"desc",b.description);c=mxConstants.ALIGN_RIGHT;b.label&&b.label.align&&(c=b.label.align);mxUtils.setCellStyles(d.model,[f],mxConstants.STYLE_LABEL_POSITION,c);mxUtils.setCellStyles(d.model,[f],mxConstants.STYLE_VERTICAL_LABEL_POSITION,
mxConstants.ALIGN_MIDDLE);d=this.getComponentPinsFromData(b);c=this.getPinNets(b);this.addComponentPins(f,d,c);this.updateSpiceNameList(f,d);b.searchParams&&f.setSearchParams(b.searchParams);b.searchKeys&&f.setSearchKeys(b.searchKeys);f.updateParametersFromData(b);b.pk&&(f.pk=b.pk);b.links&&(f.links=b.links);return f};
eeUtils.prototype.newStencilSymbol=function(a,b){var c=EEWeb.app.getGraph(),d="shape=component_"+b.stencil+";"+mxConstants.STYLE_DIRECTION+"=east;rotation=0",e=mxStencilRegistry.getStencil("component_"+b.stencil),d=EEWeb.app.insertComponentSymbol("","","","",c.snap(a.x),c.snap(a.y),e.w0,e.h0,d,[{anchor:"BL",line:0,name:"name",pos:"TL"}],"");d.setConnectable(!0);d.setCreationDate();b.bom_include&&(d.bom_include=!0);b.paramsets&&d.initParamSets(b.paramsets);b.params&&d.initParameters(b.params);b.name&&
d.setParameter(null,"name",b.name);b.description&&d.setParameter(null,"desc",b.description);e=mxConstants.ALIGN_RIGHT;b.label&&b.label.align&&(e=b.label.align);mxUtils.setCellStyles(c.model,[d],mxConstants.STYLE_LABEL_POSITION,e);e=mxConstants.ALIGN_MIDDLE;b.label&&b.label.vertical_align&&(e=b.label.vertical_align);mxUtils.setCellStyles(c.model,[d],mxConstants.STYLE_VERTICAL_LABEL_POSITION,e);c=this.getComponentPinsFromData(b);e=this.getPinNets(b);this.addComponentPins(d,c,e);b.searchParams&&d.setSearchParams(b.searchParams);
b.searchKeys&&d.setSearchKeys(b.searchKeys);d.updateParametersFromData(b);return d};
eeUtils.prototype.newSymbolComponent=function(a,b){var c=mxStencilRegistry.getStencil("component_"+b.stencil),d=this.getSymbolDimension(c,b),c=d.width,d=d.height;this.ptInGraphBound(a,d,c);var e=this.getSymbolStyle(b),f=b.text?b.text:"";"Label"==b.stencil&&(e="label",f="text");var g=EEWeb.app.getGraph(),e=g.insertVertex(g.getDefaultParent(),null,f,g.snap(a.x),g.snap(a.y),c,d,e);b.edge&&(e.edge=!0,e.geometry.setTerminalPoint(new mxPoint(g.snap(a.x),g.snap(a.y)+c),!0),e.geometry.setTerminalPoint(new mxPoint(g.snap(a.x)+
d,g.snap(a.y)),!1));return e};eeUtils.prototype.newImageSymbolComponent=function(a,b,c){var d=b?b.width:100,e=b?b.height:100;_.isEmpty(c)&&(c=this.getCenterPtOnSchematic(b.width,b.height));b=EEWeb.app.getGraph();a=b.insertVertex(b.getDefaultParent(),null,"",b.snap(c.x),b.snap(c.y),d,e,"image;image="+a);a.imageComp=!0;return a};
eeUtils.prototype.newTextLink=function(){var a=this.getCenterPtOnSchematic(130,30),b=EEWeb.app.getGraph(),a=b.insertVertex(b.getDefaultParent(),null,"Link",b.snap(a.x),b.snap(a.y),130,30,"text;whiteSpace=wrap;align=center;fontColor=#0000EE;fontStyle=4;fillColor=none;strokeColor=transparent;");b.setLinkForCell(a,window.location.href);return a};
eeUtils.prototype.getCenterPtOnSchematic=function(a,b){var c=EEWeb.app.getGraph().getView().getScale(),d=$("#schematic-wrapper"),e=d.width()/2,f=d.height()/2,g=d.scrollTop(),d=d.scrollLeft();return{x:(e+d-(a?a/2*c:0))/c,y:(f+g-(b?b/2*c:0))/c}};eeUtils.prototype.updateSelectedCellsImage=function(a,b){EEWeb.app.getGraph().setCellStyles(mxConstants.SHAPE_IMAGE,a,b)};
eeUtils.prototype.newUMLComponent=function(a,b){var c,d=EEWeb.app.getGraph(),e=b.isEdgeOnly?!0:!1,f=b.geometry.width,g=b.geometry.height;this.ptInGraphBound(a,g,f);var h=d.snap(a.x),k=d.snap(a.y),m=b.style,n=b.text?b.text:"",p=d.getDefaultParent();e||(c=d.insertVertex(p,null,n,h,k,f,g,m),c.setAllowHtmlLabels(!0));if(b.edges){var q=null;_.each(b.edges,function(a){var b=a.geometry,b=b?new mxGeometry(b.x,b.y,b.width,b.height):new mxGeometry(0,0,0,0);q=new eeConnection(a.title,b,a.style);q.setEdge(!0);
a.relative&&(q.geometry.relative=!0);var f;a.terminalPoints&&_.each(a.terminalPoints,function(a){var b=h+a.x,c=k+a.y;f=a.isSource;q.geometry.setTerminalPoint(new mxPoint(b,c),f)});b=d.getCellStyle(q);b=mxUtils.clone(b);b.rounded=!0;d.setStyleEnds(b,q);a.outGoing&&_.each(a.outGoing,function(a){c.insertEdge(q,a)});a.labels&&_.each(a.labels,function(a){var b=new eeLabel(a.value,a.style,a.name);b.geometry.x=a.geometryX?a.geometryX:b.geometry.x;b.geometry.y=a.geometryY?a.geometryY:b.geometry.y;a=new mxPoint(a.offsetX|
0,a.offsetY|0);b.geometry.offset=a;q.insert(b)});d.addEdge(q,p,f||e?null:c,!f||e?null:c)})}e&&(c=q);return c};eeUtils.prototype.getSymbolDimension=function(a,b){var c={width:0,height:0};"builtin_shape"==b.component_type?(c.width=130,c.height=50):(c.width=a.w0,c.height=a.h0);return c};eeUtils.prototype.getSymbolStyle=function(a){return"shape=component_"+a.stencil+";"};
eeUtils.prototype.ptInGraphBound=function(a,b,c){var d=EEWeb.app.getGraph().getMaximumGraphBounds();0>a.x&&(a.x=0);0>a.y&&(a.y=0);a.x>d.width-b&&(a.x=d.width-b);a.y>d.height-c&&(a.y=d.height-c)};
eeUtils.prototype.getPtWithinGraphBounds=function(a,b){var c=EEWeb.app.getGraph(),d=c.getView().getScale(),e=c.getMaximumGraphBounds(),c=e.width*d,f=e.height*d,d=b&&b.left?b.left:0,c=b&&b.right?c+b.right:c,e=b&&b.top?b.top:0,f=b&&b.bottom?f+b.bottom:f,g=b&&b.x?b.x:0,h=b&&b.y?b.y:0,k="undefined"!==typeof a.defaultX?a.defaultX:a.x,m="undefined"!==typeof a.defaultY?a.defaultY:a.y,n=new mxPoint(a.x,a.y);n.x=a.x<d?d+g:k;n.x=a.x>c?c+g:n.x;n.y=a.y<e?e+h:m;n.y=a.y>f?f+h:n.y;return n};
eeUtils.prototype.getComponentPinsFromData=function(a){var b=[];a.pins&&(b=a.pins);return b};eeUtils.prototype.getPinNets=function(a){return null};eeUtils.prototype.updateSpiceNameList=function(a,b){};eeUtils.prototype.addComponentPins=function(a,b,c){for(var d=0,e=b.length;d<e;d++){var f=b[d];EEWeb.app.addPin(a,f,d,c?c[f.id]:null)}};
eeUtils.prototype.exportSvgFromGraph=function(a,b,c){EEWeb.eventLog.logEvent("eeUtils.exportSVGFromGraph","start");var d,e;d="";b=b||"none";var f={letter:{x:8.5,y:11},legal:{x:8.5,y:14},a3:{x:11.7,y:16.5},a4:{x:8.27,y:11.7},b3:{x:13.9,y:19.7},b4:{x:9.84,y:13.9}};c=c?f[c]?c:"letter":"none";mxRectangleShape.prototype.crisp=!0;mxConstants.SHADOWCOLOR="#C0C0C0";mxConstants.SHADOW_OPACITY=0.5;mxConstants.SHADOW_OFFSET_X=5;mxConstants.SHADOW_OFFSET_Y=6;mxConstants.SVG_SHADOWTRANSFORM="translate("+mxConstants.SHADOW_OFFSET_X+
" "+mxConstants.SHADOW_OFFSET_Y+")";var g=EEWeb.app.getGraph(),h=g.view.scale;"none"!=c&&2!=h&&g.zoomTo(2);d="";e=g.getGraphBounds();var k=Math.ceil(e.width+8),m=Math.ceil(e.height+8),n=g.view.scale;if(a)if("none"==c)f=e.x-4,e=e.y-4,d+=" translate("+-f+","+-e+")";else{c=f[c];var f=c.x,p=c.y;"landscape"==b&&(b=f,f=p,p=b);b=Math.round(96*f);c=Math.round(96*p);f=Math.round(96*(f-1));p=Math.round(96*(p-1));p=Math.round(100*Math.min(f>k?1:f/k,p>m?1:p/m))/100;f=(b-k*p)/2+48-e.x;e=(c-m*p)/2+48-e.y;k=b;m=
c;d=d+(" scale("+p+")")+(" translate("+f+","+e+")")}else k=g.pageFormat.width,m=g.pageFormat.height;b=mxUtils.createXmlDocument();b.createElementNS?(e=b.createElementNS(mxConstants.NS_SVG,"svg"),e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",mxConstants.NS_XLINK),c=b.createElementNS(mxConstants.NS_SVG,"g")):(e=b.createElement("svg"),e.setAttribute("xmlns",mxConstants.NS_SVG),e.setAttribute("xmlns:xlink",mxConstants.NS_XLINK),c=b.createElement("g"));e.setAttribute("version","1.1");
e.appendChild(c);b.appendChild(e);e.setAttribute("width",k);e.setAttribute("height",m);b=new mxSvgCanvas2D(c);1!==g.pageScale&&a&&(d+=" scale("+1/g.pageScale+")");1===n||a||(d+=" scale("+1/n+")");""!==d&&c.setAttribute("transform",d);a=new mxImageExport;d=EEWeb.app.getCurrentPage();a.drawState(g.getView().getState(d),b);mxClient.IS_FF&&(a=e.getElementsByTagName("ellipse"),_.each(a,function(a){a.setAttribute("fill","none")}));d=this.isFirefoxVersion(20)?(new XMLSerializer).serializeToString(e):mxUtils.getXml(e);
h!=n&&g.zoomTo(h);EEWeb.eventLog.logEvent("eeUtils.exportSVGFromGraph","end");return{svg:d,bounds:{width:k,height:m}}};eeUtils.prototype.isFirefoxVersion=function(a){var b=navigator.userAgent.toLowerCase().indexOf("firefox");return-1<b&&parseInt(navigator.userAgent.slice(b).split("/")[1],10)===a?!0:!1};eeUtils.prototype.isWindowsFirefox=function(){var a=/firefox/,b=navigator.userAgent.toLowerCase();return/windows|win32/.test(b)&&a.test(b)};eeUtils.prototype.sidebarSearchSubmit=function(){return!1};
eeUtils.prototype.show_alert=function(a,b,c){c=c||!0;$("<p>"+a+"</p>").dialog({draggable:!1,dialogClass:c?"graph-popup-error":"graph-popup-dialog",modal:!0,resizable:!1,title:b||l("default_alert"),buttons:[{text:l("default_ok"),click:function(){$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};
eeUtils.prototype.newComponentFromDKSearch=function(a,b){EEWeb.eventLog.logEvent("eeUtils.newComponentFromDKSearch","");var c=EEWeb.app.getGraph(),d=b.getElementSource();c.getModel().beginUpdate();try{v=EEWeb.app.insertComponent(null,"DK","","",c.snap(a.x),c.snap(a.y),100,100,"dkpart;image="+d),v.setConnectable(!1),v.setCreationDate(),v.bom_include=b.getBOMInclude(),v.initParamSets(["standard"]),v.updateParameters(b.getParams()),c.setSelectionCells([v])}finally{c.getModel().endUpdate()}};
eeUtils.prototype.newComponentFromVendorSearch=function(a,b,c){EEWeb.eventLog.logEvent("eeUtils.newComponentFromVendorSearch","");var d=EEWeb.app.getGraph();d.getModel().beginUpdate();try{v=EEWeb.app.insertComponent(null,c,"","",d.snap(a.x),d.snap(a.y),100,100,"dkpart;image="+b.imageUrl),b.paramsets&&v.initParamSets(b.paramsets),v.setConnectable(!1),v.setCreationDate(),v.bom_include=b.BOMInclude,v.updateParameters(b.getParameters()),d.setSelectionCells([v])}finally{d.getModel().endUpdate()}};
eeUtils.prototype.isValidEmailAddress=function(a){var b=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,c=a.split(",");if(c&&0<c.length){a=0;for(var d=c.length;a<d;a++){var e=$.trim(c[a]);if(!b.test(e))return!1}}else if(!b.test($.trim(a)))return!1;return!0};eeUtils.prototype.pointsToString=function(a,b){var c=a+":";if(null!=b)for(var d=0;d<b.length;d++)c=null!=b[d]?c+(" ("+b[d].x+","+b[d].y+"),"):c+" (null),";return c};
eeUtils.prototype.array2Str=function(a){var b="";if(null!=a)for(var c=0;c<a.length;c++)var d=a[c],b=null!=d?b+("("+d.x+","+d.y+"),"):b+"(null),";else b+=" ";return b.substr(0,b.length-1)};eeUtils.prototype.array2Str2=function(a,b){var c=a;if(null!=b)for(var d=0;d<b.length;d++)var e=b[d],c=null!=e?c+("("+e.x+","+e.y+"),"):c+"(null),";else c+=" [] ";return c.substr(0,c.length-1)};eeUtils.prototype.hasNullPoints=function(a){if(null==a)return!0;for(var b=0,c=a.length;b<c;b++)if(null==a[b])return!0;return!1};
eeUtils.prototype.findNearestSegment=function(a,b,c){var d=-1;if(0<a.absolutePoints.length)for(var e=a.absolutePoints[0],f=null,g=1;g<a.absolutePoints.length;g++){var h=a.absolutePoints[g];if(null==e||null==h)EEWeb.eventLog.sendEvent("nearseg","wiring","Null in segment","i="+g);else if(e=mxUtils.ptSegDistSq(e.x,e.y,h.x,h.y,b,c),null==f||e<f)f=e,d=g-1;e=h}return d};
eeUtils.prototype.stripSpecialChars=function(a,b){var c=/[`=[\]\\;',\/*+~!@#$%\^&*()+{}|:"<>?]/ig;return a?a.replace(c,"").replace(/[-_ ]+/g,"-"):b};eeUtils.prototype.sendAjaxSubmitForm=function(a,b,c){a=_.clone(amplify.request.resources[a]);b=_.extend(a,b);a="";c&&(a='<input type="hidden" name="csrfmiddlewaretoken" value="'+c+'" />');$("<form method='post' >"+a+"</form>").appendTo("body").ajaxSubmit(b)};
eeUtils.prototype.attachFilenameToUrl=function(a,b,c){b.url=amplify.request.resources[a].url+c};eeUtils.prototype.trackBomLink=function(a,b){var c=EEWeb.project.name||"N/A",d=EEWeb.project.id||"N/A",e=EEWeb.user.name,f=EEWeb.user.email,g=EEWeb.user.id,d=d.toString(),g=g.toString();"undefined"!=typeof ga&&ga("send","event","outbound","click",a,{dimension1:b,dimension2:d,dimension3:c,dimension4:g,dimension5:e,dimension6:f});return!0};
eeUtils.prototype.isCellsInGraphBounds=function(a,b,c){var d=!1;if(!_.isEmpty(b)){d=a.getView().getScale();c=c||{x:0,y:0};var e=mxUtils.clone(a.getMaximumGraphBounds());e.width*=d;e.height*=d;a=a.graphHandler.getBoundingBox(b);a.x+=c.x*d;a.y+=c.y*d;d=this.containsBounds(e,a)}return d};
eeUtils.prototype.containsBounds=function(a,b){var c=mxUtils.contains(a,b.x,b.y),c=mxUtils.contains(a,b.x+b.width,b.y)?c:!1,c=mxUtils.contains(a,b.x,b.y+b.height)?c:!1;return c=mxUtils.contains(a,b.x+b.width,b.y+b.height)?c:!1};eeUtils.prototype.timeInWords=function(a){var b=parseInt(a/3600)%24,c=parseInt(a/60)%60;a%=60;return(0<b?b+"hr ":"")+(0<c?c+"min ":"")+(0<a?a+"s":"")};
eeUtils.prototype.convertToEllipsis=function(a,b,c){return'<div class="ellipsis-cell '+(c?c:"")+'" style="width: '+(b||50)+'px">'+(a||"&nbsp;")+"</div>"};mxPoint.prototype.toString=function(){return"("+this.x+","+this.y+")"};mxRectangle.prototype.toString=function(){return"("+this.x+","+this.y+" w:"+this.width+" h:"+this.height+")"};
mxGeometry.prototype.toString=function(){var a=mxRectangle.prototype.toString.apply(this,null);this.sourcePoint&&(a+=" sp:"+this.sourcePoint.toString());this.targetPoint&&(a+=" tp:"+this.targetPoint.toString());return a=this.points?a+EEWeb.app.getUtils().array2Str2(" pts",this.points):a+" pts(null)"};mxUndoableEdit.prototype.toString=function(){try{for(var a=this.significant?"signif.":"insignif.",b=0;b<this.changes.length;b++)a+="c["+b+"]="+this.changes[b].toString();return a}catch(c){return"exception"}};
mxRootChange.prototype.toString=function(){return"mxRootChange"};mxChildChange.prototype.toString=function(){var a="mxChildChange",a=null==this.parent?a+"null,":a+"pa,";return a=null==this.previous?a+"null":a+"pr"};mxTerminalChange.prototype.toString=function(){var a="mxTerminalChange",a=this.previous?a+" p!=null":a+" p==null";return a=this.terminal?a+" t!=null":a+" t==null"};mxValueChange.prototype.toString=function(){return"mxValueChange old:"+this.previous+" new:"+this.value};
mxStyleChange.prototype.toString=function(){return"mxStyleChange old:"+this.previous+" new:"+this.style};mxGeometryChange.prototype.toString=function(){var a="mxGeometryChange ";this.previous&&(a+="prev:"+this.previous.toString());this.geometry&&(a+="curr:"+this.geometry.toString());return a};mxCollapseChange.prototype.toString=function(){var a;a="mxCollapseChange old:"+this.previous;return a+=" new:"+this.collapsed};
mxVisibleChange.prototype.toString=function(){var a;a="mxVisibleChange old:"+this.previous;return a+=" new:"+this.vislble};mxCellAttributeChange.prototype.toString=function(){var a="mxCellAttributeChange Attr:"+this.attribute,a=a+(" old:"+this.previous);return a+=" new:"+this.value};function dkUtils(){eeUtils.call(this)}mxUtils.extend(dkUtils,eeUtils);
dkUtils.prototype.componentStyle=function(a,b){var c=a.stencil,d="undefined"!=typeof eeSymbolDict&&eeSymbolDict[c]||a,e="";if(d){if(d.preview){var f=b||d.preview.image||this.previewSprite,c=d.preview.position.x?50*d.preview.position.x:"0",e=d.preview.position.y?40*d.preview.position.y:"0";"xpx"in d.preview.position&&"ypx"in d.preview.position?(c=d.preview.position.xpx,e=d.preview.position.ypx):(c*=-1,e*=-1);d=a.stencil?b:f;d=a.smartPin?this.previewSprite:d;e="position: relative; background: transparent url('"+
d+"') no-repeat "+c+"px "+e+"px"}}else EEWeb.eventLog.logEvent("eeUtils.componentStyle","Missing info for stencil:"+c);return e};dkUtils.prototype.getComponentPinsFromData=function(a){var b=[];return b=a.pins?a.pins:eeSymbolDict[a.stencil].pins};dkUtils.prototype.getSymbolStyle=function(a){var b=a.attributes?a.attributes.style:null;return null!=b?b:eeUtils.prototype.getSymbolStyle.call(this,a)};dkUtils.prototype.trackBomLink=function(a,b){};
function eeCompMgr(){return"undefined"!==typeof EEWeb.compMgr?EEWeb.compMgr:this instanceof eeCompMgr?(this.componentByPID={},EEWeb.compMgr=this,this):new eeCompMgr}eeCompMgr.prototype.componentByPID=null;eeCompMgr.prototype.addComponentByPid=function(a,b){this.componentByPID[a]=b};eeCompMgr.prototype.getComponentByPid=function(a){return a in this.componentByPID?this.componentByPID[a]:null};function eeLineStyle(){return this instanceof eeLineStyle?this:new eeLineStyle}
eeLineStyle.prototype.loadLineStyles=function(){var a=$("#line_type"),b=$("#line_start"),c=$("#line_end");a.is(":empty")&&(this.addLineStyleItem(a,"linetype_straight").attr("title","Straight"),this.addLineStyleItem(a,"linetype_entity").attr("title","Entity Relation"),this.addLineStyleItem(a,"linetype_horizontal").attr("title","Horizontal"),this.addLineStyleItem(a,"linetype_vertical").attr("title","Vertical"),this.addLineStyleItem(a,"linetype_segment").attr("title","Manual"),this.addLineStyleItem(a,
"linetype_orthogonal").attr("title","Automatic"));b.is(":empty")&&(this.addLineStyleItem(b,"linestart_noarrow").attr("title","None"),this.addLineStyleItem(b,"linestart_classic").attr("title","Classic"),this.addLineStyleItem(b,"linestart_open").attr("title","Open Arrow"),this.addLineStyleItem(b,"linestart_block").attr("title","Block"),this.addLineStyleItem(b,"linestart_oval").attr("title","Oval"),this.addLineStyleItem(b,"linestart_diamond").attr("title","Diamond"),this.addLineStyleItem(b,"linestart_thindiamond").attr("title",
"Diamond Thin"),this.addLineStyleItem(b,"linestart_classictrans").attr("title","Classic"),this.addLineStyleItem(b,"linestart_blocktrans").attr("title","Block"),this.addLineStyleItem(b,"linestart_ovaltrans").attr("title","Oval"),this.addLineStyleItem(b,"linestart_diamondtrans").attr("title","Diamond"),this.addLineStyleItem(b,"linestart_thindiamondtrans").attr("title","Diamond Thin"));c.is(":empty")&&(this.addLineStyleItem(c,"lineend_noarrow").attr("title","None"),this.addLineStyleItem(c,"lineend_classic").attr("title",
"Classic"),this.addLineStyleItem(c,"lineend_open").attr("title","Open Arrow"),this.addLineStyleItem(c,"lineend_block").attr("title","Block"),this.addLineStyleItem(c,"lineend_oval").attr("title","Oval"),this.addLineStyleItem(c,"lineend_diamond").attr("title","Diamond"),this.addLineStyleItem(c,"lineend_thindiamond").attr("title","Diamond Thin"),this.addLineStyleItem(c,"lineend_classictrans").attr("title","Classic"),this.addLineStyleItem(c,"lineend_blocktrans").attr("title","Block"),this.addLineStyleItem(c,
"lineend_ovaltrans").attr("title","Oval"),this.addLineStyleItem(c,"lineend_diamondtrans").attr("title","Diamond"),this.addLineStyleItem(c,"lineend_thindiamondtrans").attr("title","Diamond Thin"))};eeLineStyle.prototype.addLineStyleItem=function(a,b){var c=$('<li id="'+b+'"></li>'),d=$("<div></div>");d.addClass("img_disabled");c.append(d);a.append(c);return c};
eeLineStyle.prototype.lineStyleChange=function(a,b){if(EEWeb.app.getGraph().selectionHasEEConnections()){var c=EEWeb.app.getGraph();c.getModel().beginUpdate();try{for(var d=0;d<a.length;d++)c.setCellStyles(a[d],b[d])}finally{c.getModel().endUpdate()}}};
function eeBom(a){return EEWeb.bom&&"undefined"!==typeof EEWeb.bom?EEWeb.bom:this instanceof eeBom?(this.refs={},this.list={},this.nonbom_list={},this.usedRefdes={},this.reuseDeletedRefs=!0,this.viewObj=a,this.viewObj.setModel(this),this.isDkBom=this.updatingComponent=!1,this.quoteDialog=this.bomImportDialog=this.errFld=this.errTxt=null,this.fields=this.getFields(),this.fieldnames=this.getFieldNames(),this.fieldids={},this._patRefdes=RegExp(/^([A-Z])([?A-Za-z0-9]+)$/),EEWeb.bom=this,this):new eeBom(a)}
eeBom.prototype.getFields=function(){return{INDEX:0,NAME:1,VALUE:2,MANUFACTURER:3,MANUFACTURER_PN:4,DIGIKEY_PN:5,DESCRIPTION:6,NOTES:7}};eeBom.prototype.getFieldNames=function(){return[eeConstants.LABEL_REFDES,eeConstants.LABEL_NAME,eeConstants.LABEL_VALUE,eeConstants.LABEL_MANUFACTURER,eeConstants.LABEL_MANPN,eeConstants.LABEL_DKPN,eeConstants.LABEL_DESC,eeConstants.LABEL_NOTES]};
eeBom.prototype.clearBom=function(){this.refs={};this.list={};this.nonbom_list={};this.usedRefdes={};this.reuseDeletedRefs=!0};eeBom.prototype.getView=function(){return this.viewObj};eeBom.prototype.init=function(){EEWeb.eventLog.logEvent("eeBom.init","");for(var a=0,b=this.fieldnames.length;a<b;a++)this.fieldids[this.fieldnames[a]]=a;this.getView().init();this.initHandlers()};
eeBom.prototype.initHandlers=function(){var a=this;amplify.subscribe(EEWeb.events.LOAD_PROJECT_COMPLETE,function(){a.syncWithModel()});amplify.subscribe(EEWeb.events.PAGE_DELETED,function(){a.syncWithModel()});amplify.subscribe(EEWeb.events.NEW_PROJECT,function(){a.newProject()});amplify.subscribe(EEWeb.events.REFRESH_BOM,function(){a.onRefresh()});amplify.subscribe(EEWeb.events.RESIZE,function(){a.onResize()});amplify.subscribe(EEWeb.events.COMPONENT_DELETED,function(b){var c=!0===b.redo,d=!0===
b.newcomp;a.removeCell(b.comp,c,d,"undefined"==typeof b.remove?!0:b.remove);var e=EEWeb.app.getVendor().getVendorPartNumberKey();!b.comp.hasParameterValue("manpn")&&!b.comp.hasParameterValue(e)||d||c||EEWeb.eventLog.sendCompEvent("delete",b.comp)});amplify.subscribe(EEWeb.events.COMPONENT_ADDED,function(b){var c=!0===b.redo,d=!0===b.newcomp;a.addComponent(b.comp,c,d);var e=EEWeb.app.getVendor().getVendorPartNumberKey();!b.comp.hasParameterValue("manpn")&&!b.comp.hasParameterValue(e)||d||c||EEWeb.eventLog.sendCompEvent("add",
b.comp)});amplify.subscribe(EEWeb.events.COMPONENT_UPDATED,function(b){"bom"!==b.source&&(b.bom_include||b.bom_include_user_allowed)&&a.updateBomValue(b.id,b.name,b.value)});amplify.subscribe(EEWeb.events.CLEAR_PROJECT,function(){a.clearBom()});amplify.subscribe(EEWeb.events.BOM_QUOTE,function(){a.doBomQuote()});amplify.subscribe(EEWeb.events.BOM_EXPORT,function(){a.doBomExport()});amplify.subscribe(EEWeb.events.BOM_ORDER,function(){a.doBomOrder()});amplify.subscribe(EEWeb.events.CHECK_IS_DUPLICATE_REFDES,
function(b){return a.isDuplicateRefdes(b)});amplify.subscribe(EEWeb.events.BOM_EXPORT_XML,function(b){return a.doExportXML(b.extension)})};eeBom.prototype.fieldIdToName=function(a){return"number"===typeof a&&0<=a&&a<this.fieldnames.length?this.fieldnames[a]:null};eeBom.prototype.fieldNameToId=function(a){return a in this.fieldids&&this.fieldids.hasOwnProperty(a)?this.fieldids[a]:null};eeBom.prototype.newProject=function(){this.refs={};this.list={};this.usedRefdes={};this.onRefresh()};
eeBom.prototype.getNextRefdes=function(a){if("string"!==typeof a||""===a)return null;var b=1,c=a+b;if(this.reuseDeletedRefs)for(;this.isDuplicateRefdes(c);)b++,c=a+b;else for((a in this.refs)||(this.refs[a]=1),b=this.refs[a]++,c=a+b;c in this.usedRefdes&&this.usedRefdes.hasOwnProperty(c);)b=this.refs[a]++,c=a+b;this.incRefdes(c);return c};
eeBom.prototype.incRefdes=function(a){if("string"!==typeof a||""===a)return null;a in this.usedRefdes&&this.usedRefdes.hasOwnProperty(a)?this.usedRefdes[a]++:this.usedRefdes[a]=1;return this.usedRefdes[a]};eeBom.prototype.decRefdes=function(a){a in this.usedRefdes&&this.usedRefdes.hasOwnProperty(a)&&(this.usedRefdes[a]--,0===this.usedRefdes[a]&&delete this.usedRefdes[a])};eeBom.prototype.isRefdesUsed=function(a){return a in this.usedRefdes&&this.usedRefdes.hasOwnProperty(a)};
eeBom.prototype.prefixFromRefdes=function(a){return(a=this._patRefdes.exec(a))?a[1]:"UNK"};
eeBom.prototype.updateComponentRefdes=function(a,b){if(!(a instanceof eeComp))return null;var c;c=a.getParameter(eeConstants.LABEL_REFPREFIX);var d=a.getParameter(eeConstants.LABEL_REFDES);this._patRefdes.exec(d);if(b){if(c)return c=this.getNextRefdes(c),this.setCompParameter(a,eeConstants.LABEL_REFDES,c),c;d&&a.removeParameter("bom",eeConstants.LABEL_REFDES);return null}if(d){if(this._patRefdes.test(d)){if(this.isRefdesUsed(d))return c=this.prefixFromRefdes(d),c=this.getNextRefdes(c),this.setCompParameter(a,
eeConstants.LABEL_REFDES,c),c;this.incRefdes(d);return d}EEWeb.app.getValidator().getRule("refdes").isValid(d,{prefix:c})||a.removeParameter("bom",eeConstants.LABEL_REFDES);return null}if(!c)return null;c=this.getNextRefdes(c);this.setCompParameter(a,eeConstants.LABEL_REFDES,c);return c};eeBom.prototype.isDuplicateRefdes=function(a){return a in this.usedRefdes&&this.usedRefdes.hasOwnProperty(a)};
eeBom.prototype.setCompParameter=function(a,b,c){try{this.updatingComponent=!0;var d=jQuery.extend(!0,{},a);a.setParameter("bom",b,c);EEWeb.eventLog.trackCompEvent(d,a)}catch(e){EEWeb.log.error("Error detected while setting "+b+" to "+c+":"+e)}finally{this.updatingComponent=!1}};
eeBom.prototype.addComponent=function(a,b,c){if("object"===typeof a&&null!==a){var d="       ".split(" "),e={},f="",e="";EEWeb.eventLog.logEvent("eeBom.addComponent","");"syncLabels"in a&&a.syncLabels();if("bom_include"in a||"bom_include_user_allowed"in a&&a.bom_include_user_allowed)if(a.id in this.list)d=this.list[a.id],this.getView().addRow(a.id,d),e=d[this.fields.INDEX],a instanceof eeComp&&(a.syncLabels(),this.setCompParameter(a,eeConstants.LABEL_REFDES,e)),this.isDkBom&&a.setParameterVisibility(eeConstants.LABEL_REFDES,
!0),this.onRefresh();else{if(a instanceof eeComp){for(var e=a.getAllParameters(),d="       ".split(" "),g=0,h=this.fieldnames.length;g<h;g++)f=this.fieldnames[g],f in e&&(d[g]=e[f].value);c||"bom_include"in a?e=this.updateComponentRefdes(a,!0):(e=a.getParameter(eeConstants.LABEL_REFDES),this.nonbom_list[a.id]&&delete this.nonbom_list[a.id]);d[this.fields.INDEX]=e;this.list[a.id]=d;a.syncLabels();!b&&this.isDkBom&&a.setParameterVisibility(eeConstants.LABEL_REFDES,!0);this.onRefresh()}}else this.nonbom_list[a.id]||
(this.updateComponentRefdes(a,!0),"syncLabels"in a&&a.syncLabels(),this.nonbom_list[a.id]=!0)}};eeBom.prototype.removeCell=function(a,b,c,d){EEWeb.eventLog.logEvent("eeBom.removeCell","");a instanceof eeComp&&((b=a.getParameter(eeConstants.LABEL_REFDES))&&d&&this.decRefdes(b),a.id in this.list&&(delete this.list[a.id],this.onRefresh()),this.nonbom_list[a.id]&&delete this.nonbom_list[a.id],!1!=a.bom_include_user_allowed||d||(this.nonbom_list[a.id]=!0))};
eeBom.prototype.getArray=function(){var a=[],b;for(b in this.list)this.list.hasOwnProperty(b)&&a.push([b].concat(this.list[b]));return a};eeBom.prototype.updateBomValue=function(a,b,c){var d;!this.updatingComponent&&a in this.list&&(a=this.list[a],b=this.fieldNameToId(b),b===this.fields.INDEX&&(d=a[b],d!==c&&(this.decRefdes(d),this.incRefdes(c))),a[b]=c,this.onRefresh())};
eeBom.prototype.onValueChanged=function(a,b,c){if(a in this.list&&b in this.list[a]){var d=this.updateComponent(a,b,c);this.list[a][b]=d}return d};eeBom.prototype.updateComponent=function(a,b,c){EEWeb.eventLog.logEvent("eeBom.updateComponent","");a=this.getCellById(a);var d,e=!0;a&&(b=this.fieldIdToName(b))&&(d=a.getParameter(b),e=this.validate(a,c,b),b===eeConstants.LABEL_REFDES&&e&&d!==c&&(this.decRefdes(d),this.incRefdes(c)),e&&(d=c,this.setCompParameter(a,b,c)));return d};
eeBom.prototype.validate=function(a,b,c){var d=this,e=!0;a=a.getPropertiesFields();_.each(a,function(a){if(a.name===c){var g=a.rule,g="undefined"!==typeof g?g.split(","):[];_.each(g,function(g){g=EEWeb.app.getValidator().getRule(g);g.isValid(b,a)||(d.errTxt=g.errorText,d.errFld=c,e=!1)})}});return e};eeBom.prototype.getCellById=function(a){return EEWeb.app.getGraph().model.getCell(a)};
eeBom.prototype.syncWithModel=function(){EEWeb.eventLog.logEvent("eeBom.syncWithModel","");var a=this.getAllComponents(),b="       ".split(" "),c,d="";this.list={};this.nonbom_list={};this.usedRefdes={};this.refs={};_.each(a,function(a){this.updateComponentRefdes(a,!1);"bom_include"in a||"bom_include_user_allowed"in a&&a.bom_include_user_allowed?(c=a.getAllParameters(),b="       ".split(" "),_.each(this.fieldnames,function(a,e){a in c&&(d=c[a].value?c[a].value:"",b[e]=_.isString(d)?d:d.toString())}),
this.list[a.id]=b):this.nonbom_list[a.id]=!0},this);this.onRefresh()};eeBom.prototype.getAllComponents=function(){return EEWeb.app.getModel().filterDescendants(function(a){return a instanceof eeComp})};eeBom.prototype.onRefresh=function(){this.getView().onRefresh()};eeBom.prototype.onResize=function(){this.getView().onResize()};eeBom.prototype.getPartList=function(){var a=[],b,c;for(b in this.list)this.list.hasOwnProperty(b)&&(c=this.list[b],c=this.getBOMData(c),a.push(c));return a};
eeBom.prototype.getBOMData=function(a){return{index:a[this.fields.INDEX],name:a[this.fields.NAME],value:a[this.fields.VALUE],manu:a[this.fields.MANUFACTURER],manpn:a[this.fields.MANUFACTURER_PN],dkpn:a[this.fields.DIGIKEY_PN],desc:a[this.fields.DESCRIPTION],notes:a[this.fields.NOTES]}};eeBom.prototype.createRequestQuoteDialog=function(){return new eeRequestQuoteDialog("#request_quote_dialog",this,EEWeb.app.getProjectHandler(),l("request_quote"))};eeBom.prototype.doBomQuote=function(){};
eeBom.prototype.doBomExport=function(){var a=EEWeb.helper.getDomainName();EEWeb.eventLog.logEvent("eeBom","bom export");var b=this.getValidVendorPartList();if(null!==b){var c=this,a=' <a href="https://'+a+'/classic/Help.aspx?id=New%20BOM%20Wizard&site=us&lang=en" target="_blank">'+l("alertmessage_xls_bom")+"</a> ",a="<p>"+l("alertmessage_xls")+a+l("alertmessage_xls_quote")+"</p>";$(a).dialog({title:l("downloadbom"),resizable:!1,modal:!0,draggable:!0,dialogClass:"graph-popup-dialog",width:400,height:"auto",
buttons:[{text:l("downloadbom_cancel"),click:function(){$(this).dialog("close")}},{text:l("downloadbom_download"),click:function(){$(this).dialog("close");c.onBomDownload(b)}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})}};eeBom.prototype.doExportXML=function(a){EEWeb.eventLog.logEvent("eeBom","bom export xml");var b=this.getValidVendorPartList();if(null!==b)this.onBomDownload(b,a)};eeBom.prototype.onBomDownload=function(a,b){};
eeBom.prototype.getProjectName=function(){return EEWeb.app.getProjectHandler().getName()};eeBom.prototype.buildBomExportData=function(a){for(var b=[],c=a.length,d=null,e=0;e<c;e++)d=a[e],b.push([d.index,d.name,d.value,d.manu,d.manpn,d.dkpn||d.vendorpn||"",d.qty,d.desc,d.notes]);return b};
eeBom.prototype.getVendorPartList=function(){var a={},b=[],c=this.getPartList(),c=_.filter(c,function(a){var b=a.dkpn||a.vendorpn||"";a=a.manpn||"";b=null!==b&&""!==mxUtils.trim(b.toString());a=null!==a&&""!==mxUtils.trim(a.toString());return b||a});_.each(c,function(c){var e=c.dkpn||c.vendorpn||"",f=c.manpn||"";e in a?a[e].qty++:f in a?a[f].qty++:(c.qty=1,e?a[e]=c:a[f]=c,b.push(c))});return b};
eeBom.prototype.getAssemblyNumberMessage=function(){var a=[];a.push('<div id="bom_assembly_dialog">');a.push("<p>"+l("bom_please_specify_number_of_assemblies")+"</p>");a.push('<p class="zend_form">');a.push(l("bom_assemblies")+': <input type="text" id="bom_assembly_count">');a.push("</p>");a.push("</div>");return a.join("")};eeBom.prototype.validateAssemblyCount=function(){var a=$("#bom_assembly_count").val(),b=a.match(/^[0-9]+$/);if(0==a||!b)return!1;this.assemblyCount=a;return!0};
eeBom.prototype.invalidAssemblyCount=function(){$("#bom_assembly_count").addClass("bom_assembly_count_error");var a=$(".ui-dialog-buttonpane"),b=$("#alert_message"),c=$('<div id="alert_message" class="alert_message"></div>');c.append('<span class="bom_error_alert">'+l("alert")+": </span>");c.append('<span class="bom_error_message">'+l("error_bom_assembly_number")+"</span>");0<b.length||(0<a.length?a.prepend(c):$("#bom_assembly_dialog").append(c))};eeBom.prototype.clearBomOrderOptions=function(){$(".alert_message").remove()};
eeBom.prototype.getValidVendorPartList=function(){var a=this.getVendorPartList();return 0===a.length?($(this.getPartListErrorDlgContent()).dialog({title:l("errornoparts_order"),resizable:!1,modal:!0,draggable:!0,dialogClass:"graph-popup-dialog",width:400,height:"auto",buttons:[{text:l("errornoparts_number_ok"),click:function(){$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}}),null):a};
eeBom.prototype.getPartListErrorDlgContent=function(){return"<p>"+l("errornoparts_number")+"</p>"};
eeBom.prototype.doBomOrder=function(){EEWeb.eventLog.logEvent("dkProject","bom order");var a=this.getValidVendorPartList();if(null!==a){var b=this,c=this.getAssemblyNumberMessage();this.dlg=$(c).dialog({title:l("bom_order_options"),resizable:!1,modal:!0,draggable:!0,dialogClass:"graph-popup-dialog",width:"420px",height:"auto",buttons:[{text:l("bom_assembly_number_ok"),click:function(){b.submitOrder(b,a)&&$(this).dialog("close")}}],close:function(){b.clearBomOrderOptions();amplify.publish(EEWeb.events.DIALOG_CLOSED,
new ALEvent({}));$(this).remove()}});this.dlg.keyup(function(c){27==c.keyCode&&(b.clearBomOrderOptions(),$(this).dialog("close"));13==c.keyCode&&b.submitOrder(b,a)&&$(this).dialog("close")})}};eeBom.prototype.submitOrder=function(a,b){if(a.validateAssemblyCount())return a.doBomCheckout(b),!0;a.invalidAssemblyCount();return!1};
eeBom.prototype.doBomCheckout=function(a){var b=EEWeb.helper.getDomainName();EEWeb.eventLog.logEvent("eeBom","bom checkout");EEWeb.eventLog.sendBomEvent("order",a);var b="http://"+b+"/classic/ordering/fastadd.aspx",c=this.assemblyCount,d=this.getCustomerReference(),e={};_.each(a,function(a,b){e["part"+(b+1)]=a.dkpn||a.vendorpn||a.manpn;e["qty"+(b+1)]=a.qty*c;d&&(e["cref"+(b+1)]=d)});e.webid=-1;e.site="us";e.lang="en";a=b+"?"+$.param(e);window.open(a)};
eeBom.prototype.getCustomerReference=function(){return eeServerData.customerReference||null};eeBom.prototype.getDefaultProjectName=function(){return l("newproject")};function eeBomView(a){return this instanceof eeBomView?(this.model=this.table=null,this.domid=a,this):new eeBomView(a)}eeBomView.prototype.setModel=function(a){this.model=a};
eeBomView.prototype.init=function(){this.initSettings();this.calculateCellWidth();var a=this.initColumnDefOptions();this.table=$(this.domid).dataTable({oLanguage:{sSearch:l("Search")+":",sZeroRecords:l("no_match_records"),sEmptyTable:l("no_data_in_table")},bJQueryUI:!0,bLengthChange:!1,iDisplayLength:-1,bPaginate:!1,sPaginationType:"full_numbers",sScrollY:$(window).height()-189+"px",aaData:this.getArray(),aoColumnDefs:a}).tooltip({position:{my:"left top",at:"left bottom",collision:"flipfit"}});this.table.fnAdjustColumnSizing()};
eeBomView.prototype.initSettings=function(){this.dynamicWidthColumnCount=7;this.columnCount=8;this.sidePadding=20};
eeBomView.prototype.calculateCellWidth=function(){var a=$(".dataTables_scrollBody"),b=$("<div />");a.append(b);var a=$("#bom_page"),c=a.width(),a=a.width()-b.width();b.remove();this.setDynamicColumnWidth(c,80,this.dynamicWidthColumnCount);b=this.getDynamicColumnWidth();this.columnWidth={};this.columnWidth[0]="";this.columnWidth[1]=80;for(c=2;c<=this.columnCount;c++)this.columnWidth[c]=b;this.columnWidth[c-1]=b-a};
eeBomView.prototype.setDynamicColumnWidth=function(a,b,c){this.dynamicColumnWidth=Math.floor((a-b)/c)};eeBomView.prototype.getDynamicColumnWidth=function(){return this.dynamicColumnWidth};
eeBomView.prototype.initColumnDefOptions=function(){var a=this,b=EEWeb.app.getVendor().getVendorPartNumberTitle(),c=function(b,c,f,g,h){a.onCellCreated.apply(a,arguments)};return this.dataTableOptions=[{sTitle:l("index"),bSearchable:!1,bVisible:!1,aTargets:[0],fnCreatedCell:c},{sTitle:l("refdes"),sType:"refdes",aTargets:[1],width:a.columnWidth[1]+"px",fnCreatedCell:c},{sTitle:l("name"),aTargets:[2],width:a.columnWidth[2]+"px",fnCreatedCell:c},{sTitle:l("value"),aTargets:[3],width:a.columnWidth[3]+
"px",fnCreatedCell:c},{sTitle:l("manufacturer_name"),aTargets:[4],width:a.columnWidth[8]+"px",fnCreatedCell:c},{sTitle:l("partnumber"),aTargets:[5],width:a.columnWidth[4]+"px",fnCreatedCell:c},{sTitle:b,sClass:"read_only",aTargets:[6],width:a.columnWidth[5]+"px",fnCreatedCell:c},{sTitle:l("description"),aTargets:[7],width:a.columnWidth[6]+"px",fnCreatedCell:c},{sTitle:l("notes"),aTargets:[8],width:a.columnWidth[7]+"px",fnCreatedCell:c}]};
eeBomView.prototype.onCellCreated=function(a,b,c,d,e){d=EEWeb.app.getUtils();var f=EEWeb.app.getVendor(),g=$(a),h=this.columnWidth[e];g.attr("title",b);$(a).width(h);6===e&&(a=encodeURIComponent(b),c=encodeURIComponent(c[4]),b=f.getVendorPartNumberLink(a,c,b));g.html(d.convertToEllipsis(b,h-this.sidePadding))};
eeBomView.prototype.onRefresh=function(){if(this.table){var a=$(".dataTables_scrollBody");this.bomScrollTop=a.scrollTop();this.table.tooltip("disable");this.table.fnClearTable(!0);this.table.fnAddData(this.getArray());this.makeEditable();this.table.fnAdjustColumnSizing();this.table.tooltip("enable");a.scrollTop(this.bomScrollTop)}};
eeBomView.prototype.onResize=function(){if(this.table){var a=this;this.resizeTimer&&clearTimeout(this.resizeTimer);this.refreshTimer&&clearTimeout(this.refreshTimer);this.resizeTimer=setTimeout(function(){a.refreshTimer&&clearTimeout(a.refreshTimer);a.refreshTimer=setTimeout(function(){a.calculateCellWidth();a.onRefresh()},200)},500)}};
eeBomView.prototype.makeEditable=function(){var a=this,b=this.table.fnGetNodes();$("td",b).not(".read_only").each(function(){var b=$(this).find("div");0<b.length?a.makeEditableCell(b):a.makeEditableCell($(this))})};
eeBomView.prototype.makeEditableCell=function(a){var b=this,c,d=EEWeb.app.getUtils(),e=$(".dataTables_scrollBody");if(a){a=$(a);var f=a.width();a.editable(function(a,b){return a},{name:"field"+Math.floor(1E4*Math.random()+1E4),height:"14px",placeholder:"",onblur:"submit",onedit:function(){"&nbsp;"==this.innerHTML&&(this.innerHTML="");b.table.tooltip("disable");b.bomScrollTop=e.scrollTop()},onsubmit:function(g,h){if(!h.parentElement)return!1;var k=b.table.fnGetPosition(h.parentElement);c=b.table.fnGetData(k[0])[0];
var m=$('input[name="'+g.name+'"]'),n=m.val();if(void 0===n)return!0;var p=b.onValueChanged(c,k[1],n);if(p===n||!0===p)b.model.errTxt=null,b.model.errFld=null,b.table.tooltip("enable"),a.parent().attr("title",p),p=d.convertToEllipsis(p,f),b.table.fnUpdate(p,k[0],k[2]),b.makeEditable($(p));if(b.model&&n)null!==b.model.errTxt&&($(this).css("background-color","red"),k=b.model.errTxt,n=b.model.errFld+' "'+n+'"',b.model.errTxt=null,b.model.errFld=null,b.dlgOpen||(b.dlgOpen=!0,b.showValidationError(k,n,
m)));else return b.model.errTxt=null,b.model.errFld=null,$(this).css("background-color",""),!0;e.scrollTop(b.bomScrollTop);return!1}})}};eeBomView.prototype.getArray=function(){var a=this.model?this.model.getArray():[],b=this.columnCount;return a=_.map(a,function(a){return a.slice(0,b+1)})};
eeBomView.prototype.getPartNumberLink=function(a){var b=a[5],c=encodeURIComponent(b),d=encodeURIComponent(a[4]);d&&b&&(a[5]="<a href='http://www.digikey.com/product-detail/en/"+d+"/"+c+"' target='_blank'>"+b+"</a>");return a};eeBomView.prototype.addRow=function(a,b){this.table.dataTable().fnAddData([a].concat(b))};eeBomView.prototype.onValueChanged=function(a,b,c){return this.model?this.model.onValueChanged(a,b,c):!0};
eeBomView.prototype.showValidationError=function(a,b,c){var d=this;$("<p>"+a+"</p>").dialog({title:"Invalid "+b,resizable:!1,modal:!0,draggable:!0,dialogClass:"graph-popup-dialog",width:"auto",height:"auto",buttons:[{text:l("default_ok"),click:function(){$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));c.click().select();d.dlgOpen=null;$(this).remove()}})};
jQuery.fn.dataTableExt.oSort["refdes-asc"]=function(a,b){var c=a.match(/^([a-z]+)([0-9]+)$/i),d=b.match(/^([a-z]+)([0-9]+)$/i);return null==c?null==d?0:1:null==d?-1:c[1]!=d[1]?c[1]<d[1]?-1:1:parseInt(c[2],10)<parseInt(d[2],10)?-1:parseInt(c[2],10)>parseInt(d[2],10)?1:0};
jQuery.fn.dataTableExt.oSort["refdes-desc"]=function(a,b){var c=a.match(/^([a-z]+)([0-9]+)$/i),d=b.match(/^([a-z]+)([0-9]+)$/i);return null==c?null==d?0:-1:null==d?1:c[1]!=d[1]?c[1]<d[1]?1:-1:parseInt(c[2],10)<parseInt(d[2],10)?1:parseInt(c[2],10)>parseInt(d[2],10)?-1:0};
function dkBom(a){return EEWeb.bom&&void 0!==EEWeb.bom?EEWeb.bom:this instanceof dkBom?(eeBom.call(this,a),this.isDkBom=!0,this.loggedIn=!1,this.bomImportDialog=this.selectedBomSymbol=this.popupMenu=this.userId=null,this.bomImportCategories=[],EEWeb.bom=this,this):new dkBom(a)}mxUtils.extend(dkBom,eeBom);dkBom.prototype.getJSON=function(){return JSON.stringify({refs:this.refs,list:this.list})};
dkBom.prototype.restoreJSON=function(a){EEWeb.eventLog.logEvent("eeBom.restoreJSON","");try{var b=JSON.parse(a);b?(this.refs=b.refs,this.list=b.list,this.onRefresh()):this.newProject()}catch(c){console.log("Failed to parse bom data."),this.newProject()}};
dkBom.prototype.initHandlers=function(){var a=this;eeBom.prototype.initHandlers.apply(this,arguments);amplify.subscribe(EEWeb.events.USER_UPDATED,function(b){a.onUserUpdated(b)});amplify.subscribe(EEWeb.events.USER_IS_LOGGED_IN,function(b){b(a.loggedIn)});amplify.subscribe(EEWeb.events.USER_CHECK_ID,function(b){b(a.userId)})};dkBom.prototype.onUserUpdated=function(a){this.loggedIn=a.bLoggedIn;this.userId=a.uid;a.bLoggedIn||amplify.publish("close-imported-bom-section")};
dkBom.prototype.doBomQuote=function(){EEWeb.eventLog.logEvent("dkBom.doBomQuote","");null===this.quoteDialog?(this.quoteDialog=this.createRequestQuoteDialog(),this.quoteDialog.init()):this.quoteDialog.show()};
dkBom.prototype.onBomDownload=function(a,b){b=b||".xls";var c=EEWeb.app.getUtils(),d=this.getProjectName(),c=c.stripSpecialChars(d,this.getDefaultProjectName())+b,d=this.buildBomExportData(a),e=$("<form method='post' />"),f=_.clone(amplify.request.resources.ajaxSubmit_bom_export),g=f.url+c;e.appendTo("body").ajaxSubmit(_.extend(f,{url:g,data:{bom:JSON.stringify(d),projectname:c}}));EEWeb.eventLog.sendBomEvent("export",a)};dkBom.prototype.getDefaultProjectName=function(){return"schemeit-"+l("project")};
function dkBomView(a){if(this instanceof dkBomView)eeBomView.call(this,a);else return new dkBomView(a)}mxUtils.extend(dkBomView,eeBomView);dkBomView.prototype.getPartNumberLink=function(a){var b=EEWeb.helper.getDomainName(),c=a[5],d=encodeURIComponent(c),e=encodeURIComponent(a[4]);e&&c&&(a[5]="<a href='http://"+b+"/product-detail/"+eeServerData.sess_language+"/"+e+"/"+d+"' target='_blank'>"+c+"</a>");return a};
function eeConnectionHandler(a,b){mxConnectionHandler.apply(this,arguments);this.lastevt=null}mxUtils.extend(eeConnectionHandler,mxConnectionHandler);
eeConnectionHandler.prototype.initKeyHandlers=function(){var a=this,b=new mxKeyHandler(this.graph);b.bindKey(32,function(){if(a.lastevt){var b=a.lastevt;b.consumed=!1;b.state=null;a.mouseDown.call(a,null,b);b.consumed=!1;b.state=null;a.mouseUp.call(a,null,b)}});b.bindKey(8,function(){if(a.isConnecting()&&a.waypointsEnabled&&a.waypoints&&0<a.waypoints.length){a.waypoints.pop();for(var b=[],d=0;d<a.waypoints.length;d++){var e=a.waypoints[d].clone();a.convertWaypoint(e);b[d]=e}a.graph.view.updatePoints(a.edgeState,
b,a.previous,a.currentState);null!=a.shape&&null!=a.edgeState&&(a.shape.points=a.edgeState.absolutePoints,a.drawPreview())}})};
eeConnectionHandler.prototype.saveEvent=function(a){if(a!=this.lastevt){var b=a.evt,b=new mxMouseEvent({clientX:b.clientX,clientY:b.clientY,shiftKey:b.shiftKey,altKey:b.altKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey,type:b.type,cancelBubble:b.cancelBubble,returnValue:b.returnValue,isConsumed:b.isConsumed},a.state);b.graphX=a.graphX;b.graphY=a.graphY;b.state=a.state;b.consumed=a.consumed;this.lastevt=b}};
eeConnectionHandler.prototype.createShape=function(){var a=mxConnectionHandler.prototype.createShape.apply(this,arguments);a.updateVmlDashStyle=function(){this.isDashed?"1 1"!=this.strokeNode.dashstyle&&(this.strokeNode.dashstyle="1 1"):"solid"!=this.strokeNode.dashstyle&&(this.strokeNode.dashstyle="solid")};a.updateSvgScale=function(a){var c=Math.round(Math.max(1,this.strokewidth*this.scale));a.setAttribute("stroke-width",c);this.isDashed&&(c=Math.max(1,Math.round(1*this.scale*this.strokewidth)),
a.setAttribute("stroke-dasharray",c+" "+c));this.crisp&&(this.roundedCrispSvg||!0!=this.isRounded)?a.setAttribute("shape-rendering","crispEdges"):a.removeAttribute("shape-rendering")};return a};eeConnectionHandler.prototype.isConnectableCell=function(a){if(this.graph.getModel().isEdge(a))return!0;if(null!=a){if(a instanceof eeLabel)return!1;if(a instanceof eePin)return a.isConnectable();if(a.isASmartPin())return!1;if(a.geometry.relative)return!0}else return!1};
eeConnectionHandler.prototype.createMarker=function(){var a=mxConnectionHandler.prototype.createMarker.apply(this,arguments);a.intersects=function(a,c){return!0};return a};eeConnectionHandler.prototype.createIcons=function(a){return this.graph.getModel().isEdge(a.cell)?null:mxConnectionHandler.prototype.createIcons.apply(this,arguments)};eeConnectionHandler.prototype.isStartEvent=function(a){return"connect"==EEWeb.mode||mxConnectionHandler.prototype.isStartEvent.apply(this,arguments)};
eeConnectionHandler.prototype.mouseDown=function(a,b){this.saveEvent(b);mxConnectionHandler.prototype.mouseDown.apply(this,arguments)};
eeConnectionHandler.prototype.createEdgeState=function(a){if(!(a instanceof mxMouseEvent))return null;var b=this.graph.createEdge();null!=this.sourceConstraint&&null!=this.previous?b.style=mxConstants.STYLE_EXIT_X+"="+this.sourceConstraint.point.x+";"+mxConstants.STYLE_EXIT_Y+"="+this.sourceConstraint.point.y+";":this.graph.model.isEdge(a.getCell())&&(a=this.graph.getPointForEvent(a.getEvent()),b.geometry.setTerminalPoint(a,!0));return this.graph.view.createState(b)};
eeConnectionHandler.prototype.updateCurrentState=function(a,b){mxConnectionHandler.prototype.updateCurrentState.apply(this,arguments);if(null!=this.edgeState&&(this.edgeState.cell.geometry.setTerminalPoint(null,!1),null!=this.shape&&null!=this.currentState&&this.currentState.view.graph.model.isEdge(this.currentState.cell))){var c=this.graph.view.scale,d=this.graph.view.translate,c=new mxPoint(this.graph.snap(a.getGraphX()/c)-d.x,this.graph.snap(a.getGraphY()/c)-d.y);this.edgeState.cell.geometry.setTerminalPoint(c,
!1)}};eeConnectionHandler.prototype.mouseMove=function(a,b){this.saveEvent(b);mxConnectionHandler.prototype.mouseMove.apply(this,arguments)};eeConnectionHandler.prototype.isStopEvent=function(a){return null!=a.getState()||mxEvent.isRightMouseButton(a.getEvent())};
eeConnectionHandler.prototype.mouseUp=function(a,b){EEWeb.eventLog.logEvent("eeConnectionHandler.mouseUp","");mxEvent.isRightMouseButton(b.getEvent())&&this.reset();if(this.previous){var c=b.getState(),d=c?c.cell:null,e=this.previous,e=e?e.cell:null;if(c&&(d&&"group"===d.getStyle()||d.isASmartPin()||!this.validateState(d,e)))return}this.saveEvent(b);if(null!=this.first&&null!=this.previous&&(d=mxUtils.convertPoint(this.graph.container,b.getX(),b.getY()),c=Math.abs(d.x-this.first.x),d=Math.abs(d.y-
this.first.y),c<this.graph.tolerance&&d<this.graph.tolerance)){"connect"!=EEWeb.mode&&this.graph.getModel().isEdge(this.previous.cell)&&this.reset();return}c=(c=this.constraintHandler?this.constraintHandler.currentFocus:null)?c.cell:null;this.previous&&c==this.previous.cell||mxConnectionHandler.prototype.mouseUp.apply(this,arguments)};
eeConnectionHandler.prototype.createEdge=function(a,b,c,d){EEWeb.eventLog.logEvent("eeConnectionHandler.ceateEdge","");var e=null;null!=this.factoryMethod&&(e=this.factoryMethod(b,c,d),e.setValue(a));null==e&&(e=new eeEdge(a||""),e.setEdge(!0),e.setStyle(d),a=new mxGeometry,a.relative=!0,e.setGeometry(a));return e};eeConnectionHandler.prototype.validateState=function(a,b,c,d){return a.isConnectableTo(b?b:null,this.allowDiagramToComponentConnections())};
eeConnectionHandler.prototype.allowDiagramToComponentConnections=function(){return eeServerData.allowDiagramToComponentConnections?eeServerData.allowDiagramToComponentConnections:!1};eeConnectionHandler.prototype.validateConnection=function(a,b){return a===b&&a.useConnectImage()&&!this.isConnecting()?null:mxConnectionHandler.prototype.validateConnection.apply(this,arguments)};
function eeLabelHandler(a){this.graph=a;this.graph.addMouseListener(this);this.graph.addListener(mxEvent.MOVE_CELLS,mxUtils.bind(this,function(a,c){if(this.isEnabled())this.onMoveCells(c)}))}eeLabelHandler.prototype.graph=null;eeLabelHandler.prototype.mxhandler=null;eeLabelHandler.prototype.setmxHandler=function(a){this.mxhandler=a};eeLabelHandler.prototype.enabled=!0;eeLabelHandler.prototype.highlightEnabled=!0;eeLabelHandler.prototype.cloneEnabled=!1;eeLabelHandler.prototype.moveEnabled=!0;
eeLabelHandler.prototype.guidesEnabled=!1;eeLabelHandler.prototype.guide=null;eeLabelHandler.prototype.currentDx=null;eeLabelHandler.prototype.currentDy=null;eeLabelHandler.prototype.updateCursor=!0;eeLabelHandler.prototype.selectEnabled=!0;eeLabelHandler.prototype.removeCellsFromParent=!1;eeLabelHandler.prototype.connectOnDrop=!1;eeLabelHandler.prototype.scrollOnMove=!0;eeLabelHandler.prototype.minimumSize=6;eeLabelHandler.prototype.previewColor="black";eeLabelHandler.prototype.htmlPreview=!1;
eeLabelHandler.prototype.shape=null;eeLabelHandler.prototype.scaleGrid=!1;eeLabelHandler.prototype.crisp=!0;eeLabelHandler.prototype.isEnabled=function(){return this.enabled};eeLabelHandler.prototype.setEnabled=function(a){this.enabled=a};eeLabelHandler.prototype.isCloneEnabled=function(){return this.cloneEnabled};eeLabelHandler.prototype.setCloneEnabled=function(a){this.cloneEnabled=a};eeLabelHandler.prototype.isMoveEnabled=function(){return this.moveEnabled};
eeLabelHandler.prototype.setMoveEnabled=function(a){this.moveEnabled=a};eeLabelHandler.prototype.isSelectEnabled=function(){return this.selectEnabled};eeLabelHandler.prototype.setSelectEnabled=function(a){this.selectEnabled=a};eeLabelHandler.prototype.isRemoveCellsFromParent=function(){return this.removeCellsFromParent};eeLabelHandler.prototype.setRemoveCellsFromParent=function(a){this.removeCellsFromParent=a};eeLabelHandler.prototype.onMoveCells=function(a){};
eeLabelHandler.prototype.createPreviewShape=function(a){a=new mxRectangleShape(a,null,this.previewColor);a.isDashed=!0;a.crisp=this.crisp;this.htmlPreview?(a.dialect=mxConstants.DIALECT_STRICTHTML,a.init(this.graph.container)):(a.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,a.init(this.graph.getView().getOverlayPane()),a.dialect==mxConstants.DIALECT_SVG?a.node.setAttribute("style","pointer-events:none;"):a.node.style.background="");return a};
eeLabelHandler.prototype.mouseDown=function(a,b){if(!b.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&!EEWeb.app.editor.rubberband.isForceRubberbandEvent(b)&&null!=b.getState()){EEWeb.eventLog.logEvent("eeLabelHandler.mouseDown","");this.cell=null;var c=b.getCell();null!=c&&c instanceof eeLabel&&(0<EEWeb.debug.EELabelHandler&&EEWeb.log.info("eeLabelHandler.mouseDown on eeLabel:"+c.toString()),this.delayedSelection=this.graph.isCellSelected(c),this.isSelectEnabled()&&!this.delayedSelection&&
this.graph.selectCellForEvent(c,b.getEvent()),this.isMoveEnabled()&&(this.graph.model.getGeometry(c),this.graph.isCellMovable(c)&&this.start(c,b.getX(),b.getY()),this.cellWasClicked=!0,!mxClient.IS_SF&&!mxClient.IS_GC||"SELECT"!=b.getSource().nodeName?b.consume():mxClient.IS_SF&&"SELECT"==b.getSource().nodeName&&(this.cellWasClicked=!1,this.first=null)))}};
eeLabelHandler.prototype.start=function(a,b,c){this.cell=a;this.first=mxUtils.convertPoint(this.graph.container,b,c);this.cells=[this.cell];this.bounds=this.graph.getView().getBounds(this.cells);this.guidesEnabled&&(this.guide=new mxGuide(this.graph,this.getGuideStates()));0<EEWeb.debug.EELabelHandler&&EEWeb.log.info("eeLabelHandler.start with cell "+a.value+" at "+b+","+c)};
eeLabelHandler.prototype.specialDebugWindow=function(a,b){if(!b.isConsumed()){null==this.nlWindow&&(this.nlContent=document.createElement("div"),this.nlPre=document.createElement("pre"),this.nlContent.appendChild(this.nlPre),this.nlWindow=new mxWindow("Scale",this.nlContent,700,140,300,200,!0,!0),this.nlWindow.setScrollable(!0),this.nlWindow.setResizable(!0),this.nlWindow.setVisible(!0),this.nlWindow.show());var c=EEWeb.app.getGraph(),d=new mxPoint(b.getX(),b.getY()),e=EEWeb.app.getSchematicPointNoScale(d.y,
d.x),f=EEWeb.app.getSchematicPoint(d.y,d.x),g=mxUtils.convertPoint($("#schematic-wrapper").get(0),d.x,d.y),h=c.getPointForEvent(b.evt),k=$("#schematic-wrapper"),m=[],n=c.getCellAt(e.x,e.y,null,!0,!1),p=c.getCellAt(f.x,f.y,null,!0,!1);m.push("Mouse   : "+d.toString());m.push("No Scale:"+e.toString());m.push("Scale   :"+f.toString());m.push("mxPt    :"+g.toString());m.push("evtPt   :"+h.toString());m.push("Scroll Left:"+k.scrollLeft()+" Top:"+k.scrollTop());c=["Top","Right","Bottom","Left"];n&&(m.push("t1 matched"),
_.each(c,function(a){var b=EEWeb.app.getUtils().calcEdgeLocation(n,a,e);m.push("Client Point ("+a+"):"+b.toString())}));p&&(m.push("t2 matched"),_.each(c,function(a){var b=EEWeb.app.getUtils().calcEdgeLocation(p,a,e);m.push("Client Point ("+a+"):"+b.toString())}));c=EEWeb.app.getUtils().getVertexLocations();m=m.concat(c);this.nlPre.innerHTML=mxUtils.htmlEntities(m.join("\n"),!1).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;")}};
eeLabelHandler.prototype.mouseMove=function(a,b){var c=this.graph;if(!b.isConsumed()&&c.isMouseDown&&null!=this.cell&&null!=this.first&&null!=this.bounds){var d=mxUtils.convertPoint(c.container,b.getX(),b.getY()),e=d.x-this.first.x,f=d.y-this.first.y,g=c.tolerance;1<EEWeb.debug.EELabelHandler&&EEWeb.log.info("eeLabelHandler.mouseMove Cell:"+this.cell.toString()+" "+e+","+f);if(null!=this.shape||Math.abs(e)>g||Math.abs(f)>g){null==this.highlight&&(this.highlight=new mxCellHighlight(c,mxConstants.DROP_TARGET_COLOR,
3));null==this.shape&&(this.shape=this.createPreviewShape(this.bounds));var g=c.getView().scale,h=c.isGridEnabledEvent(b.getEvent()),k=!0;if(null!=this.guide&&this.useGuidesForEvent(b))f=this.guide.move(this.bounds,new mxPoint(e,f),h),k=!1,e=f.x,f=f.y;else if(h)var m=c.getView().translate,h=this.bounds.x-(c.snap(this.bounds.x/g-m.x)+m.x)*g,m=this.bounds.y-(c.snap(this.bounds.y/g-m.y)+m.y)*g,f=this.mxhandler.snap(new mxPoint(e,f)),e=f.x-h,f=f.y-m;null!=this.guide&&k&&this.guide.hide();c.isConstrainedEvent(b.getEvent())&&
(Math.abs(e)>Math.abs(f)?f=0:e=0);c=this.getPosChange(d,g,e,f);this.currentDx=c.x;this.currentDy=c.y;this.shape.bounds=new mxRectangle(this.bounds.x+e,this.bounds.y+f,this.bounds.width,this.bounds.height);this.shape.redraw()}b.consume();mxEvent.consume(b.getEvent())}else!this.isMoveEnabled()&&!this.isCloneEnabled()||!this.updateCursor||b.isConsumed()||null==b.getState()||c.isMouseDown||(e=c.getCursorForCell(b.getCell()),null==e&&c.isEnabled()&&c.isCellMovable(b.getCell())&&(e=mxConstants.CURSOR_MOVABLE_VERTEX),
b.getState().setCursor(e),b.consume())};eeLabelHandler.prototype.getPosChange=function(a,b,c,d){var e=EEWeb.app.getGraph().getMaximumGraphBounds(),f=a.x/b;a=a.y/b;c={x:c,y:d};0>f-this.bounds.width&&(c.x=this.currentDx?this.currentDx:0);0>a-this.bounds.height&&(c.y=this.currentDy?this.currentDy:0);f+this.bounds.width>e.width&&(c.x=this.currentDx?this.currentDx:0);a+this.bounds.height>e.height&&(c.y=this.currentDy?this.currentDy:0);return c};
eeLabelHandler.prototype.mouseUp=function(a,b){if(!b.isConsumed()){var c=this.graph;if(null!=this.cell&&null!=this.first&&null!=this.shape&&null!=this.currentDx&&null!=this.currentDy){EEWeb.eventLog.logEvent("eeLabelHandler.mouseUp","");var d=c.getView().scale;c.isCloneEvent(b.getEvent())&&c.isCellsCloneable()&&this.isCloneEnabled();var e=this.currentDx/d,d=this.currentDy/d;b.getCell();0<EEWeb.debug.EELabelHandler&&null!=this.cell&&EEWeb.log.info("eeLabelHandler.mouseUp with cell "+this.cell.toString());
c.moveCells(this.cells,e,d,!1,this.cell.parent,b.getEvent())}else this.isSelectEnabled()&&this.delayedSelection&&null!=this.cell&&c.selectCellForEvent(this.cell,b.getEvent())}this.cellWasClicked&&(0<EEWeb.debug.EELabelHandler&&EEWeb.log.info("eeLabelHandler.mouseUp - consuming event."),b.consume());this.reset()};
eeLabelHandler.prototype.reset=function(){EEWeb.eventLog.logEvent("eeLabelHandler.reset","");this.destroyShapes();this.delayedSelection=this.cellWasClicked=!1;this.target=this.cell=this.first=this.guides=this.currentDy=this.currentDx=null};eeLabelHandler.prototype.destroyShapes=function(){null!=this.shape&&(this.shape.destroy(),this.shape=null);null!=this.guide&&(this.guide.destroy(),this.guide=null);null!=this.highlight&&(this.highlight.destroy(),this.highlight=null)};
eeLabelHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.destroyShapes()};function eePinHandler(a){this.graph=a;this.graph.addMouseListener(this);this.graph.addListener(mxEvent.MOVE_CELLS,mxUtils.bind(this,function(a,c){if(this.isEnabled())this.onMoveCells(c)}))}eePinHandler.prototype.graph=null;eePinHandler.prototype.mxhandler=null;eePinHandler.prototype.setmxHandler=function(a){this.mxhandler=a};eePinHandler.prototype.enabled=!0;
eePinHandler.prototype.highlightEnabled=!0;eePinHandler.prototype.cloneEnabled=!1;eePinHandler.prototype.moveEnabled=!0;eePinHandler.prototype.guidesEnabled=!1;eePinHandler.prototype.guide=null;eePinHandler.prototype.currentDx=null;eePinHandler.prototype.currentDy=null;eePinHandler.prototype.updateCursor=!0;eePinHandler.prototype.selectEnabled=!0;eePinHandler.prototype.removeCellsFromParent=!1;eePinHandler.prototype.connectOnDrop=!1;eePinHandler.prototype.scrollOnMove=!0;
eePinHandler.prototype.minimumSize=6;eePinHandler.prototype.previewColor="black";eePinHandler.prototype.htmlPreview=!1;eePinHandler.prototype.shape=null;eePinHandler.prototype.scaleGrid=!1;eePinHandler.prototype.crisp=!0;eePinHandler.prototype.isEnabled=function(){return this.enabled};eePinHandler.prototype.setEnabled=function(a){this.enabled=a};eePinHandler.prototype.isCloneEnabled=function(){return this.cloneEnabled};eePinHandler.prototype.setCloneEnabled=function(a){this.cloneEnabled=a};
eePinHandler.prototype.isMoveEnabled=function(){return this.moveEnabled};eePinHandler.prototype.setMoveEnabled=function(a){this.moveEnabled=a};eePinHandler.prototype.isSelectEnabled=function(){return this.selectEnabled};eePinHandler.prototype.setSelectEnabled=function(a){this.selectEnabled=a};eePinHandler.prototype.isRemoveCellsFromParent=function(){return this.removeCellsFromParent};eePinHandler.prototype.setRemoveCellsFromParent=function(a){this.removeCellsFromParent=a};
eePinHandler.prototype.onMoveCells=function(a){};
eePinHandler.prototype.createPreviewShape=function(a){a=new mxRectangleShape(a,null,this.previewColor);a.isDashed=!0;a.crisp=this.crisp;this.htmlPreview?(a.dialect=mxConstants.DIALECT_STRICTHTML,a.init(this.graph.container)):(a.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,a.init(this.graph.getView().getOverlayPane()),a.dialect==mxConstants.DIALECT_SVG?a.node.setAttribute("style","pointer-events:none;"):a.node.style.background="");return a};
eePinHandler.prototype.mouseDown=function(a,b){var c=this.graph;if(!b.isConsumed()&&this.isEnabled()&&c.isEnabled()&&!EEWeb.app.editor.rubberband.isForceRubberbandEvent(b)&&null!=b.getState()){this.cell=null;var d=b.getCell();if(null!=d&&d.isASmartPin()&&(this.delayedSelection=c.isCellSelected(d),this.isSelectEnabled()&&!this.delayedSelection&&c.selectCellForEvent(d,b.getEvent()),this.isMoveEnabled())){var e=c.getCellBounds(d.getParent());c.isCellMovable(d)&&null!=e&&this.start(d,b.getX(),b.getY());
this.cellWasClicked=!0;!mxClient.IS_SF&&!mxClient.IS_GC||"SELECT"!=b.getSource().nodeName?b.consume():mxClient.IS_SF&&"SELECT"==b.getSource().nodeName&&(this.cellWasClicked=!1,this.first=null)}}};eePinHandler.prototype.start=function(a,b,c){var d=this.graph;this.cell=a;this.myParent=a.getParent();this.side=a.pinLoc;this.first=mxUtils.convertPoint(d.container,b,c);this.cells=[this.cell];this.bounds=d.getView().getBounds(this.cells);this.guidesEnabled&&(this.guide=new mxGuide(d,this.getGuideStates()))};
eePinHandler.prototype.mouseMove=function(a,b){var c=this.graph;if(!b.isConsumed()&&c.isMouseDown&&null!=this.cell&&null!=this.first&&null!=this.bounds){var d=mxUtils.convertPoint(c.container,b.getX(),b.getY()),e=d.x-this.first.x,d=d.y-this.first.y,f=c.tolerance;if(null!=this.shape||Math.abs(e)>f||Math.abs(d)>f){null==this.highlight&&(this.highlight=new mxCellHighlight(c,mxConstants.DROP_TARGET_COLOR,3));null==this.shape&&(this.shape=this.createPreviewShape(this.bounds));var g=c.isGridEnabledEvent(b.getEvent()),
f=c.getView().scale;if(null!=this.guide&&this.useGuidesForEvent(b))d=this.guide.move(this.bounds,new mxPoint(e,d),g),e=d.x,d=d.y;else if(g)var h=c.getView().translate,g=this.bounds.x-(c.snap(this.bounds.x/f-h.x)+h.x)*f,h=this.bounds.y-(c.snap(this.bounds.y/f-h.y)+h.y)*f,d=this.mxhandler.snap(new mxPoint(e,d)),e=d.x-g,d=d.y-h;var k=c.getCellBounds(this.myParent),c=k.y,g=k.x,h=k.y+k.height-20*f,f=k.x+k.width-20*f;switch(this.side){case "Top":case "Bottom":this.bounds.x+e>f&&(e=f-this.bounds.x);this.bounds.x+
e<g&&(e=g-this.bounds.x);d=0;break;case "Left":case "Right":this.bounds.y+d>h&&(d=h-this.bounds.y),this.bounds.y+d<c&&(d=c-this.bounds.y),e=0}this.currentDx=e;this.currentDy=d;this.shape.bounds=new mxRectangle(this.bounds.x+e,this.bounds.y+d,this.bounds.width,this.bounds.height);this.shape.redraw()}b.consume();mxEvent.consume(b.getEvent())}else!this.isMoveEnabled()&&!this.isCloneEnabled()||!this.updateCursor||b.isConsumed()||null==b.getState()||c.isMouseDown||(e=c.getCursorForCell(b.getCell()),null==
e&&c.isEnabled()&&c.isCellMovable(b.getCell())&&(e=mxConstants.CURSOR_MOVABLE_VERTEX),b.getState().setCursor(e),b.consume())};
eePinHandler.prototype.mouseUp=function(a,b){if(!b.isConsumed()){var c=this.graph;if(null!=this.cell&&null!=this.first&&null!=this.shape&&null!=this.currentDx&&null!=this.currentDy){var d=c.getView().scale;c.isCloneEvent(b.getEvent())&&c.isCellsCloneable()&&this.isCloneEnabled();var e=this.currentDx/d,d=this.currentDy/d;b.getCell();c.moveCells(this.cells,e,d,!1,this.cell.parent,b.getEvent())}else this.isSelectEnabled()&&this.delayedSelection&&null!=this.cell&&c.selectCellForEvent(this.cell,b.getEvent())}this.cellWasClicked&&
b.consume();this.reset()};eePinHandler.prototype.reset=function(){this.destroyShapes();this.delayedSelection=this.cellWasClicked=!1;this.target=this.cell=this.first=this.guides=this.currentDy=this.currentDx=null};eePinHandler.prototype.destroyShapes=function(){null!=this.shape&&(this.shape.destroy(),this.shape=null);null!=this.guide&&(this.guide.destroy(),this.guide=null);null!=this.highlight&&(this.highlight.destroy(),this.highlight=null)};
eePinHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.destroyShapes()};function eeVertexHandler(a){mxVertexHandler.call(this,a)}mxUtils.extend(eeVertexHandler,mxVertexHandler);
eeVertexHandler.prototype.start=function(a,b,c){mxVertexHandler.prototype.start.apply(this,arguments);var d=this.state.cell,e=d.getSmartPins(),d=this.graph.getCellBounds(d),f=this.graph.view.scale;this.origBounds=d;this.minRight=d.x/f+20;this.maxLeft=(d.x+d.width)/f-20;this.maxTop=(d.y+d.height)/f-20;this.minBottom=d.y/f+20;if(e&&0<e.length)for(var g=0,h=e.length;g<h;g++){var k=e[g];if("Right"==k.pinLoc||"Left"==k.pinLoc)this.maxTop=Math.min(this.maxTop,k.geometry.offset.y+d.y/f),this.minBottom=Math.max(this.minBottom,
k.geometry.offset.y+d.y/f+20);else if("Bottom"==k.pinLoc||"Top"==k.pinLoc)this.maxLeft=Math.min(this.maxLeft,k.geometry.offset.x+d.x/f),this.minRight=Math.max(this.minRight,k.geometry.offset.x+d.x/f+20)}};
eeVertexHandler.prototype.resizeCell=function(a,b,c,d,e,f,g){var h=this.graph.model.getGeometry(a),k=this.graph.view.scale;if(d==mxEvent.LABEL_HANDLE)b=Math.round((this.labelShape.bounds.getCenterX()-this.startX)/k),c=Math.round((this.labelShape.bounds.getCenterY()-this.startY)/k),h=h.clone(),null==h.offset?h.offset=new mxPoint(b,c):(h.offset.x+=b,h.offset.y+=c),this.graph.model.setGeometry(a,h);else{var m=this.origBounds;m.x/=k;m.y/=k;m.width/=k;m.height/=k;b=this.union(m,b,c,d,e,1,new mxPoint(0,
0),f);"group"==a.parent.style&&(b.x=h.x-(m.x-b.x),b.y=h.y-(m.y-b.y));this.graph.resizeCell(a,b,g)}};
eeVertexHandler.prototype.union=function(a,b,c,d,e,f,g,h){if(this.singleSizer)return d=a.x+a.width+b,g=a.y+a.height+c,e&&(d=this.graph.snap(d/f)*f,g=this.graph.snap(g/f)*f),f=new mxRectangle(a.x,a.y,0,0),f.add(new mxRectangle(d,g,0,0)),f;var k=a.x-g.x*f,m=k+a.width,n=a.y-g.y*f;a=n+a.height;4<d?(a+=c,a<this.minBottom&&(a=this.minBottom),e&&(a=this.graph.snap(a/f)*f)):3>d&&(n+=c,n>this.maxTop&&(n=this.maxTop),e&&(n=this.graph.snap(n/f)*f));if(0==d||3==d||5==d)k+=b,k>this.maxLeft&&(k=this.maxLeft),e&&
(k=this.graph.snap(k/f)*f);else if(2==d||4==d||7==d)m+=b,m<this.minRight&&(m=this.minRight),e&&(m=this.graph.snap(m/f)*f);e=m-k;c=a-n;h&&(h=this.graph.getCellGeometry(this.state.cell),null!=h&&(h=h.width/h.height,1==d||2==d||7==d||6==d?e=c*h:c=e/h,0==d&&(k=m-e,n=a-c)));0>e&&(k+=e,e=Math.abs(e));0>c&&(n+=c,c=Math.abs(c));d=new mxRectangle(k+g.x*f,n+g.y*f,e,c);null!=this.minBounds&&(d.width=Math.max(d.width,this.minBounds.x*f+this.minBounds.width*f+Math.max(0,this.x0*f-d.x)),d.height=Math.max(d.height,
this.minBounds.y*f+this.minBounds.height*f+Math.max(0,this.y0*f-d.y)));return d};
eeVertexHandler.prototype.init=function(){mxVertexHandler.prototype.init.apply(this,arguments);var a=!1,b=mxUtils.bind(this,function(){null!=this.linkHint&&(this.linkHint.style.display=1==this.graph.getSelectionCount()?"":"none");this.redrawHandles()});this.selectionHandler=mxUtils.bind(this,function(a,c){b()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.selectionHandler);this.changeHandler=mxUtils.bind(this,function(a,c){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell));
b()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);var c=this.graph.getLinkForCell(this.state.cell);null!=c&&(a=c,60<a.length&&(a=a.substring(0,36)+"..."+a.substring(a.length-20)),this.linkHint=function(){var a=document.createElement("div");a.className="geHint";a.style.whiteSpace="nowrap";a.style.position="absolute";return a}(),this.linkHint.style.padding="4px 10px 6px 10px",this.linkHint.style.fontSize="90%",this.linkHint.style.opacity="1",this.linkHint.style.filter="",this.updateLinkHint(c),
this.graph.container.appendChild(this.linkHint),a=!0);a&&this.redrawHandles()};
eeVertexHandler.prototype.updateLinkHint=function(a){if(null!=this.linkHint){var b=a;60<b.length&&(b=b.substring(0,36)+"..."+b.substring(b.length-20));var c=document.createElement("a");c.setAttribute("href",a);c.setAttribute("title",a);c.setAttribute("target","_blank");null!=this.graph.linkTarget&&c.setAttribute("target",this.graph.linkTarget);mxUtils.write(c,b);this.linkHint.innerHTML="";this.linkHint.appendChild(c);this.graph.isEnabled()&&(a=document.createElement("img"),a.setAttribute("src",EEBasepath+
"img/web20px//edit_new.png"),a.setAttribute("title",l("edit_link")),a.setAttribute("width","11"),a.setAttribute("height","11"),a.style.marginLeft="10px",a.style.marginBottom="-1px",a.style.cursor="pointer",this.linkHint.appendChild(a),mxEvent.addListener(a,"click",mxUtils.bind(this,function(a){var b=this.state.cell,c=this.graph.getLinkForCell(b);this.graph.setSelectionCell(b);amplify.publish(EEWeb.events.OPEN_LINK_URL_DIALOG,{cell:b,url:c});mxEvent.consume(a)})))}};
eeVertexHandler.prototype.redrawHandles=function(){mxVertexHandler.prototype.redrawHandles.apply(this);if(null!=this.state&&null!=this.connectorImg){var a=new mxPoint,b=this.state;mxVertexHandler.prototype.singleSizer?(a.x=b.x+b.width-this.connectorImg.offsetWidth/2,a.y=b.y-this.connectorImg.offsetHeight/2):(a.x=b.x+b.width+((null!=this.handleImage?this.handleImage.width:mxConstants.HANDLE_SIZE)+this.horizontalOffset+this.tolerance+this.connectorImg.offsetWidth)/2,a.y=b.y+b.height/2);var c=mxUtils.toRadians(mxUtils.getValue(b.style,
mxConstants.STYLE_ROTATION,0));if(0!=c)var d=Math.cos(c),c=Math.sin(c),b=new mxPoint(b.getCenterX(),b.getCenterY()),a=mxUtils.getRotatedPoint(a,d,c,b);this.connectorImg.style.left=Math.round(a.x-this.connectorImg.offsetWidth/2)+"px";this.connectorImg.style.top=Math.round(a.y-this.connectorImg.offsetHeight/2)+"px"}null!=this.state&&null!=this.linkHint&&(a=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),d=new mxRectangle(this.state.x,this.state.y-22,this.state.width+24,this.state.height+
22),a=mxUtils.getBoundingBox(d,this.state.style[mxConstants.STYLE_ROTATION]||"0",a),d=null!=a?mxUtils.getBoundingBox(this.state,this.state.style[mxConstants.STYLE_ROTATION]||"0"):this.state,null==a&&(a=this.state),this.linkHint.style.left=Math.round(d.x+(d.width-this.linkHint.clientWidth)/2)+"px",this.linkHint.style.top=Math.round(a.y+a.height+this.verticalOffset/2+6+this.state.view.graph.tolerance)+"px")};
eeVertexHandler.prototype.destroy=function(a,b){mxVertexHandler.prototype.destroy.apply(this,arguments);null!=this.linkHint&&(this.linkHint.parentNode.removeChild(this.linkHint),this.linkHint=null);null!=this.connectorImg&&(this.connectorImg.parentNode.removeChild(this.connectorImg),this.connectorImg=null);null!=this.selectionHandler&&(this.graph.getSelectionModel().removeListener(this.selectionHandler),this.selectionHandler=null);null!=this.changeHandler&&(this.graph.getModel().removeListener(this.changeHandler),
this.changeHandler=null)};mxEdgeHandler.prototype.isConnectableCell=function(a){return this.graph.connectionHandler.isConnectableCell(a)};mxEdgeHandler.prototype.getPointForEvent=function(){var a=mxEdgeHandler.prototype.getPointForEvent;return function(b){var c=a.apply(this,arguments);return c=EEWeb.app.getUtils().getPtWithinGraphBounds(c)}}();
mxEdgeSegmentHandler.prototype.clonePreviewState=function(a,b){var c=mxEdgeHandler.prototype.clonePreviewState.apply(this,arguments);c.cell=c.cell.clone();if(this.isSource||this.isTarget)c.cell.geometry=c.cell.geometry.clone(),this.graph.getModel().isEdge(c.cell)?c.cell.geometry.setTerminalPoint(a,this.isSource):c.cell.geometry.setTerminalPoint(null,this.isSource);return c};mxEdgeHandlerCreateMarker=mxEdgeHandler.prototype.createMarker;
mxEdgeHandler.prototype.createMarker=function(){var a=mxEdgeHandlerCreateMarker.apply(this,arguments);a.highlight.highlight=this.graph.connectionHandler.marker.highlight.highlight;return a};function eeCellRenderer(){this.shapes=mxUtils.clone(this.defaultShapes)}mxUtils.extend(eeCellRenderer,mxCellRenderer);function dkConnectionHandler(a,b){eeConnectionHandler.apply(this,arguments)}mxUtils.extend(dkConnectionHandler,eeConnectionHandler);
dkConnectionHandler.prototype.createIcons=function(a){var b=a.cell;b&&b.useConnectImage()?(b=new mxImage(EEBasepath+"/img/connector.png",15,15),mxConnectionHandler.prototype.connectImage=b):mxConnectionHandler.prototype.connectImage=null;return eeConnectionHandler.prototype.createIcons.apply(this,arguments)};
dkConnectionHandler.prototype.isConnectableCell=function(a){var b=null,c=null,d=null;return null!=a?(this.previous&&(b=this.previous.cell),a.target&&(c=a.target),a.source&&(d=a.source),this.validateState(a,b,c,d)):!1};dkConnectionHandler.prototype.reset=function(){mxConnectionHandler.prototype.reset.apply(this,arguments);this.waypoints=null;this.marker.destroy()};function eePanningHandler(a,b){mxPanningHandler.call(this,a);this.isEmbed=b;this.addGuiHandler(b)}mxUtils.extend(eePanningHandler,mxPanningHandler);
eePanningHandler.prototype.addGuiHandler=function(a){if(a){var b=this;$("#schematic").on("mouseenter",function(a){b.updatePanningOnEvent(a)})}};eePanningHandler.prototype.updatePanningOnEvent=function(a){this.active&&0===("undefined"!==typeof a.buttons?a.buttons:a.which)&&(this.graph.isMouseDown=!1,this.mouseUp(this.graph,new mxMouseEvent(a)))};
eePanningHandler.prototype.mouseDown=function(a,b){this.mouseDownEvent=b;!b.isConsumed()&&this.isPanningEnabled()&&(this.panningTrigger=this.isPanningEnabled()&&this.isPanningTrigger(b),this.startX=b.getX(),this.startY=b.getY(),this.dy=this.dx=null,this.dx0=this.graph.getView().translate.x,this.dy0=this.graph.getView().translate.y,this.panningTrigger&&(this instanceof mxPanningHandler?"consumePanningTrigger"in this?this.consumePanningTrigger(b):b.consume():b.consume()))};
eePanningHandler.prototype.mouseMove=function(a,b){this.dx=b.getX()-this.startX;this.dy=b.getY()-this.startY;if(this.active){if(this.previewEnabled)if(this.isEmbed){var c=this.graph.getView().scale,d=this.dx0+this.dx/c,c=this.dy0+this.dy/c;this.useGrid&&(d=this.graph.snap(d),c=this.graph.snap(c));this.panGraph(d,c)}else 0!=this.dx&&(this.dx/=2),0!=this.dy&&(this.dy/=2),$("#schematic-wrapper")[0].scrollLeft+=-this.dx,$("#schematic-wrapper")[0].scrollTop+=-this.dy,this.startX=b.getX()-this.dx,this.startY=
b.getY()-this.dy;this.fireEvent(new mxEventObject(mxEvent.PAN,"event",b))}else this.panningTrigger&&(d=this.active,this.active=Math.abs(this.dx)>this.graph.tolerance||Math.abs(this.dy)>this.graph.tolerance,!d&&this.active&&this.fireEvent(new mxEventObject(mxEvent.PAN_START,"event",b)));(this.active||this.panningTrigger)&&b.consume()};
eePanningHandler.prototype.mouseUp=function(a,b){if(this.active){if(null!=this.dx&&null!=this.dy){this.graph.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.graph.container);if(this.isEmbed){var c=this.graph.getView().scale,d=this.graph.getView().translate,d=new mxPoint(this.graph.panLeft+d.x*c,this.graph.panTop+d.y*c);this.graph.setPosScale({scale:c,pos:d})}b.consume()}this.fireEvent(new mxEventObject(mxEvent.PAN_END,"event",b))}this.panningTrigger=!1;this.mouseDownEvent=null;this.active=!1;
this.dy=this.dx=null};function eeDragItemHandler(a){this.graph=a;this.marker=this.createMarker();this.graph.addMouseListener(this)}eeDragItemHandler.prototype.graph=null;eeDragItemHandler.prototype.comp=null;eeDragItemHandler.prototype.createMarker=function(){return new mxCellMarker(this.graph,"#00FF00")};
eeDragItemHandler.prototype.mouseMove=function(a,b){var c=EEWeb.helper,d=this.getAssignableComponent(b);c.validDragElement()&&d?(c=c.getData(),c=c.hasOwnProperty("type")?c.type:c.obj.component_type,this.isValidTarget(d,c)&&(this.setComponent(d),this.mark(d))):this.invalidTarget()};eeDragItemHandler.prototype.mouseUp=function(a,b){};eeDragItemHandler.prototype.mouseDown=function(a,b){};eeDragItemHandler.prototype.setComponent=function(a){this.comp=a};eeDragItemHandler.prototype.getComponent=function(){return this.comp};
eeDragItemHandler.prototype.getAssignableComponent=function(a){a=(a=a.getState())?a.cell:null;var b;a&&((b=a.isAssignable?a.isAssignable():!1)||(a=null));return a};eeDragItemHandler.prototype.mark=function(a){this.marker.markCell(a)};eeDragItemHandler.prototype.unmark=function(){this.marker.reset()};eeDragItemHandler.prototype.isValidTarget=function(a,b){return"assign_draggable"==b};eeDragItemHandler.prototype.invalidTarget=function(){this.comp&&(this.setComponent(null),this.unmark())};
function eeGraphHandler(a){mxGraphHandler.call(this,a)}mxUtils.extend(eeGraphHandler,mxGraphHandler);eeGraphHandler.prototype.updatePreviewShape=function(){if(null!=this.shape){var a=this.getMousePosWithinGraph();this.currentDx=a.x;this.currentDy=a.y}mxGraphHandler.prototype.updatePreviewShape.call(this)};
eeGraphHandler.prototype.getMousePosWithinGraph=function(){var a={x:this.pBounds.x+this.currentDx-this.graph.panDx,y:this.pBounds.y+this.currentDy-this.graph.panDy,defaultX:this.currentDx,defaultY:this.currentDy},b={x:this.graph.panDx-this.pBounds.x,y:this.graph.panDy-this.pBounds.y,right:-this.pBounds.width,bottom:-this.pBounds.height};return EEWeb.app.getUtils().getPtWithinGraphBounds(a,b)};function eeGraphView(a){mxGraphView.call(this,a);this.myMouseListener=null}mxUtils.extend(eeGraphView,mxGraphView);
eeGraphView.prototype.updateFixedTerminalPoint=function(a,b,c,d){var e=null;null!=d&&(e=this.graph.getConnectionPoint(b,d));if(null==e){d=this.scale;var f=this.translate,g=a.origin,h=this.graph.getCellGeometry(a.cell),e=h.getTerminalPoint(c);null!=e?(e=new mxPoint(d*(f.x+e.x+g.x),d*(f.y+e.y+g.y)),null!=b&&null!=b.absolutePoints?(g=EEWeb.app.getUtils().findNearestSegment(b,e.x,e.y),d=c?"sourceConstraint":"targetConstraint",-1!=g?(f=b.absolutePoints[g],b=b.absolutePoints[g+1],g=0==f.x-b.x,a.style[d]=
g?"horizontal":"vertical",g?(e.x=f.x,e.y=Math.min(e.y,Math.max(f.y,b.y)),e.y=Math.max(e.y,Math.min(f.y,b.y))):(e.y=f.y,e.x=Math.min(e.x,Math.max(f.x,b.x)),e.x=Math.max(e.x,Math.min(f.x,b.x)))):a.style[d]="vertical"):null!=b&&null==b.absolutePoints&&(e=this.getTerminalConnectionPoint(b),h.setTerminalPoint(null,c))):null!=b&&b.cell.geometry.relative&&(e=new mxPoint(this.getRoutingCenterX(b),this.getRoutingCenterY(b)))}a.setAbsoluteTerminalPoint(e,c)};
eeGraphView.prototype.getTerminalConnectionPoint=function(a){return a.cell.isAPin()?new mxPoint(this.getRoutingCenterX(a),this.getRoutingCenterY(a)):null};eeGraphView.prototype.addElementListener=function(a,b,c){$(a).on(b+".graphview",c)};
eeGraphView.prototype.installListeners=function(){var a=this.graph,b=a.container;if(null!=b){mxClient.IS_TOUCH&&(this.addElementListener(b,"gesturestart",mxUtils.bind(this,function(b){a.fireGestureEvent(b);mxEvent.consume(b)})),this.addElementListener(b,"gesturechange",mxUtils.bind(this,function(b){a.fireGestureEvent(b);mxEvent.consume(b)})),this.addElementListener(b,"gestureend",mxUtils.bind(this,function(b){a.fireGestureEvent(b);mxEvent.consume(b)})));this.eeGraphMouseDown=mxUtils.bind(this,function(b){!this.isContainerEvent(b)||
(mxClient.IS_IE||mxClient.IS_IE11||mxClient.IS_GC||mxClient.IS_OP||mxClient.IS_SF)&&this.isScrollEvent(b)||a.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(b))});this.eeGraphMouseMove=mxUtils.bind(this,function(b){this.isContainerEvent(b)&&a.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(b))});this.eeGraphMouseUp=mxUtils.bind(this,function(b){this.isContainerEvent(b)&&a.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(b))});mxEvent.addGestureListeners(b,this.eeGraphMouseDown,this.eeGraphMouseMove,
this.eeGraphMouseUp);this.addElementListener(b,"dblclick",mxUtils.bind(this,function(b){this.isContainerEvent(b)&&a.dblClick(b)}));var c=function(c){var e=null;mxClient.IS_TOUCH&&(e=mxEvent.getClientX(c),c=mxEvent.getClientY(c),c=mxUtils.convertPoint(b,e,c),e=a.view.getState(a.getCellAt(c.x,c.y)));return e};this.myMouseListener={name:"eeGraphView Listener",mouseDown:function(b,c){a.popupMenuHandler.hideMenu()},mouseMove:function(){},mouseUp:function(){}};a.addMouseListener(this.myMouseListener);this.moveHandler=
mxUtils.bind(this,function(b){null!=a.tooltipHandler&&a.tooltipHandler.isHideOnHover()&&a.tooltipHandler.hide();this.captureDocumentGesture&&a.isMouseDown&&null!=a.container&&!this.isContainerEvent(b)&&"none"!=a.container.style.display&&"hidden"!=a.container.style.visibility&&!mxEvent.isConsumed(b)&&a.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(b,c(b)))});this.endHandler=mxUtils.bind(this,function(b){this.captureDocumentGesture&&a.isMouseDown&&null!=a.container&&!this.isContainerEvent(b)&&
"none"!=a.container.style.display&&"hidden"!=a.container.style.visibility&&a.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(b))});mxEvent.addGestureListeners(document,null,this.moveHandler,this.endHandler)}};
eeGraphView.prototype.destroy=function(){var a=null!=this.canvas?this.canvas.ownerSVGElement:null;null==a&&(a=this.canvas);null!=a&&null!=a.parentNode&&(this.clear(this.currentRoot,!0),$(document).off(".graphview"),$(this.graph.container).off(".graphview"),a.parentNode.removeChild(a),this.graph.removeMouseListener(this.myMouseListener),this.myMouseListener=null,mxEvent.removeGestureListeners(document,null,this.moveHandler,this.endHandler),mxEvent.removeGestureListeners(this.graph.container,this.eeGraphMouseDown,
this.eeGraphMouseMove,this.eeGraphMouseUp),this.decoratorPane=this.overlayPane=this.drawPane=this.backgroundPane=this.canvas=this.endHandler=this.moveHandler=this.eeGraphMouseUp=this.eeGraphMouseMove=this.eeGraphMouseDown=null)};function eeCellEditor(a){mxCellEditor.call(this,a)}mxUtils.extend(eeCellEditor,mxCellEditor);
eeCellEditor.prototype.startEditing=function(a,b){this.switchSelectionState=null;this.emptyLabelText="";null==this.textarea&&this.init();var c=this.graph.view.getState(a);null!=c&&1==c.style.html?(this.textarea.style.display="none",this.enterStopsCellEditing=this.graph.isEnterStopsCellEditing(),this.graph.setEnterStopsCellEditing(!1)):this.textarea.style.display="block";mxCellEditor.prototype.startEditing.apply(this,arguments);if("none"==this.textarea.style.display){this.text2=document.createElement("div");
this.text2.className="geContentEditable";this.text2.innerHTML=this.textarea.value.replace(/\n/g,"<br/>");mxEvent.addListener(this.text2,mxClient.IS_IE11||mxClient.IS_IE&&!(9<=document.documentMode)?"keypress":"input",mxUtils.bind(this,function(a){this.autoSize&&!mxEvent.isConsumed(a)&&setTimeout(mxUtils.bind(this,function(){this.resize()}),0)}));mxEvent.addListener(this.text2,"keydown",mxUtils.bind(this,function(a){mxEvent.isConsumed(a)||(this.isStopEditingEvent(a)?(this.graph.stopEditing(!1),mxEvent.consume(a)):
27==a.keyCode&&(this.graph.stopEditing(!0),mxEvent.consume(a)))}));this.installListeners(this.text2);var d=this.text2.style;d.backgroundImage="url('"+mxClient.imageBasePath+"/transparent.gif')";d.cursor="text";d.outline="none";d.position="absolute";d.width=parseInt(this.textarea.style.width)+"px";d.height=parseInt(this.textarea.style.height)-4+"px";d.left=parseInt(this.textarea.style.left)+"px";d.top=parseInt(this.textarea.style.top)+"px";d.fontFamily=this.textarea.style.fontFamily;d.fontWeight=this.textarea.style.fontWeight;
d.textAlign=this.textarea.style.textAlign;d.fontSize=this.textarea.style.fontSize;d.color=this.textarea.style.color;null!=c.text&&null!=c.text.node&&null!=c.text.node.ownerSVGElement?(c=mxConstants.ABSOLUTE_LINE_HEIGHT?Math.round(parseInt(this.textarea.style.fontSize)*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT*mxSvgCanvas2D.prototype.lineHeightCorrection,d.lineHeight=c):d.lineHeight=this.textarea.style.lineHeight;this.graph.container.appendChild(this.text2);this.text2.contentEditable=!0;
this.text2.focus();this.isSelectText()&&0<this.text2.innerHTML.length&&document.execCommand("selectAll")}};
eeCellEditor.prototype.stopEditing=function(a){if(null!=this.text2){var b=this.text2.innerHTML;"none"!=this.text2.style.display&&this.textarea.value!=b&&(this.textarea.value=b.replace(/\r\n/g,"").replace(/\n/g,""),this.setModified(!0));try{null!=this.text2.parentNode&&this.text2.parentNode.removeChild(this.text2)}catch(c){}this.text2=null;this.graph.setEnterStopsCellEditing(this.enterStopsCellEditing)}mxCellEditor.prototype.stopEditing.apply(this,arguments)};
eeCellEditor.prototype.focusLost=function(){null==this.text2&&mxCellEditor.prototype.focusLost.apply(this,arguments)};eeCellEditor.prototype.isStopEditingEvent=function(a){return mxCellEditor.prototype.isStopEditingEvent.apply(this,arguments)||13==a.keyCode&&mxEvent.isControlDown(a)};eeCellEditor.prototype.isContentEditing=function(){return null!=this.text2&&"none"!=this.text2.style.display};
function eeComponentDlg(a,b){this.domID=a;this.title=b;this.focusFieldName=null;this.fieldNameToObj={};this.init()}eeComponentDlg.prototype.domID=null;eeComponentDlg.prototype.dlg=null;eeComponentDlg.prototype.title=null;eeComponentDlg.prototype.dlgLoaded=!1;eeComponentDlg.prototype.currComp=null;eeComponentDlg.prototype.currFields=null;eeComponentDlg.prototype.init=function(){this.focusFieldName=null;this.fieldNameToObj={}};
eeComponentDlg.prototype.show=function(a,b){this.currComp=a;this.focusFieldName=b;var c=a.getPropertiesName(),d=a.getPropertiesFields();this.currFields=d;this.dlgLoaded||(this.configure(),this.dlgLoaded=!0);this.configureForm(c,d);this.clearSearchResults();this.dlgshow()};
eeComponentDlg.prototype.configure=function(){var a=this;this.dlg=$(this.domID).dialog({title:this.title,resizable:!0,closeOnEscape:!1,buttons:[{text:l("componentproperties_cancel"),click:function(){$(this).dialog("close");a.onCancel()}},{text:l("componentproperties_save"),click:function(){if(!a.validate(this))return!1;$(this).dialog("close");a.onOkay()}}],open:function(){a.onOpen(this)},close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))},draggable:!0,modal:!0,dialogClass:"graph-popup-dialog comp-dialog",
autoOpen:!1,minWidth:600,minHeight:340});this.dlg.keyup(function(b){27==b.keyCode&&($(this).dialog("close"),a.onCancel());if(13==b.keyCode){var c=$("#component-digikey-search-parts input[type=text]")[0],d=$("#component_search_box_graph")[0];if(b.target==c||b.target==d||!a.validate(this))return!1;$(this).dialog("close");a.onOkay()}})};
eeComponentDlg.prototype.clearSearchResults=function(){var a=$("#component_catalog_list");a.empty();a.parent().find("p").remove();$("#component-digikey-search-parts").trigger("reset");$("#component-digikey-search-parts .search_box_input").val(l("search_box_partsearch"));$("#search_status").remove();$("#component_search_digikey_link").remove();amplify.publish(EEWeb.events.COMP_DKBAR_HIDE,new ALEvent({}))};
eeComponentDlg.prototype.onOpen=function(a){this.focusFieldName&&this.fieldNameToObj[this.focusFieldName]?(console.log("Focused to "+this.focusFieldName),this.fieldNameToObj[this.focusFieldName].focus().select()):console.log("No focus field set")};eeComponentDlg.prototype.validate=function(){var a=this;a.isValid=!0;$("input[rules]",this.domID).each(function(){var b=$(this);a.validateElement(b)||(a.isValid=!1)});return this.isValid};
eeComponentDlg.prototype.ruleEnabled=function(a){var b=a.attr("rulecond"),c=!0;this.isFieldUpdated(a)||(c=!1);if(void 0!=b&&(a=b.match(/if(.*)\((.*)\)/)))switch(b=a[2],a[1]){case "checked":c=$(b,this.domID).prop("checked");break;case "visible":c=$(b,this.domID).is(":visible")}return c};eeComponentDlg.prototype.isFieldUpdated=function(a){var b=a.attr("name"),c=a.val();return"undefined"===typeof _.find(this.currFields,function(a){return a.name===b&&a.val===c})};
eeComponentDlg.prototype.validateElement=function(a){var b=$.trim(a.val());a.attr("name");var c=a.data("field"),d=a.attr("rules").split(","),e=!0,f="";if(this.ruleEnabled(a)){var g=EEWeb.app.getValidator();_.each(d,function(a){var d=a.match(/if(.*)\((.*)\)\s+(.*)/);if(d){a=d[2];switch(d[1]){case "checked":if(!$(a,this.domID).prop("checked"))return;break;case "visible":if(!$(a,this.domID).is(":visible"))return}a=d[3]}d=g.getRule(a);d.isValid(b,c)||(f+=d.errorText,e=!1)},this)}this.updateError(a,f);
return e};eeComponentDlg.prototype.updateError=function(a,b){if(b){a.addClass("invalid");var c=$("p",a.parent());c.length?c.html(b):(c=$("<p></p>").html(b).addClass("errtext"),a.after(c))}else a.removeClass("invalid"),a.parent().find("p").remove()};eeComponentDlg.prototype.configureValidation=function(){var a=this;$("input[rules]",this.domID).bind("blur.validation",function(){var b=$(this);a.validateElement(b)})};
eeComponentDlg.prototype.configureNote=function(a,b){var c=a.filter("[name="+b.name+"]");c.length&&c.val(b.val)};
eeComponentDlg.prototype.configureForm=function(a,b){var c=this;this.tbody=$("#properties_table tbody");this.tbody.empty();var d=$("textarea",this.domID);d.val("");eeServerData.bomIncludeAllowAll&&this.configureBomIncludeOption();_.each(b,function(a){if("note"==a.type||"textarea"==a.type)c.configureNote(d,a);else if("refprefix"!=a.name){var b=$("<tr></tr>");b.append($("<td></td>").addClass("attribute").html(a.disp_name));switch(a.type){case "text":var g=$('<input type="text" />').attr("name",a.name).val(a.val).attr("id",
"compdlg"+a.name);this.fieldNameToObj[a.name]=g;a.tip&&(g.attr("title",a.tip),g.attr("rel","tooltip"));a.rule&&(g.attr("rules",a.rule),g.data("field",a),g.bind("blur.validation",function(){var a=$(this);c.validateElement(a)}));a.ro&&(g.attr("readonly","readonly"),g.addClass("readonly"));$("<td></td>").addClass("value").append(g).appendTo(b);break;case "boolean":g=$('<input type="checkbox" />').attr("name",a.name);a.tip&&(g.attr("title",a.tip),g.attr("rel","tooltip"));a.val&&g.prop("checked",a.val);
$("<td></td>").addClass("value").append(g).appendTo(b);break;case "list":g=$("<select></select>").attr("name",a.name).attr("id","select_"+a.name);a.tip&&g.attr("title",a.tip);for(var h=0,k=a.items.length;h<k;h++){var m=a.items[h],m=m.model||m.state,n=$("<option></option>").val(h).html(m);a.val==m&&n.attr("selected","selected");g.append(n)}$("<td></td>").addClass("value").append(g).appendTo(b)}g=$("<input type='checkbox'/>").attr("name",a.name);a.show&&null!==a.val&&""!==a.val&&g.prop("checked",!0);
$("<td></td>").addClass("visible").append(g).appendTo(b);b.appendTo(this.tbody)}},this);this.configureCompLinks()};
eeComponentDlg.prototype.configureBomIncludeOption=function(){var a=this.currComp,b=$("<tr></tr>");b.append($("<td></td>").addClass("attribute").html(l("include_in_bom")));var c=$('<input type="checkbox" />').attr("name","bom_include_user_allowed").attr("title",l("include_in_bom_tip")).attr("rel","tooltip");a.bom_include&&c.prop("checked",!0).attr("disabled",!0);"undefined"!=typeof a.bom_include_user_allowed&&a.bom_include_user_allowed&&c.prop("checked",!0);$('<td colspan="2"></td>').addClass("value").append(c).appendTo(b);
b.appendTo(this.tbody)};eeComponentDlg.prototype.configureCompLinks=function(){var a=_.filter(this.currComp.links,function(a){return!a.display_in_context});if(!_.isEmpty(a)){var b=$("<tr></tr>");b.append($("<td></td>").addClass("attribute").html(l("references")));a=_.map(a,function(a){return'<div class="link"><a href="'+a.url+'" target="_blank">'+a.title+"</a></div>"});$('<td colspan="2"></td>').addClass("value").append($(a.join(""))).appendTo(b);b.appendTo(this.tbody)}};
eeComponentDlg.prototype.updateForm=function(a){var b=$("#properties_table tbody");$("input:text",b).each(function(){var b=$(this),d=b.attr("name"),e;for(e in a){var f=a[e];e==d&&b.val(f.value)}});b=$("#properties_text");$("textarea",b).each(function(){var b=$(this),d=b.attr("name"),e;for(e in a){var f=a[e];e==d&&b.val(f.value)}})};eeComponentDlg.prototype.dlgshow=function(){var a=$("#component-search-form");this.currComp.isAssignable()?a.show():a.hide();this.dlg.dialog("open")};
eeComponentDlg.prototype.getOptions=function(){EEWeb.eventLog.logEvent("eeComponentDlg","getOptions");var a={},b=$("#properties_table tbody");$("input:text",b).each(function(b,d){var e=$(this),f=e.attr("name"),e=$.trim(e.val());a[f]={value:e}});$("select",b).each(function(b,d){var e=$(this),f=e.attr("name"),e=$("option:selected",e).text();a[f]={value:e}});$(".value input:checkbox",b).not("input[name='bom_include_user_allowed']").each(function(b,d){var e=$(this),f=e.attr("name"),e=e.prop("checked");
a[f]={value:e?f:""}});$("input:checkbox",b).each(function(b,d){var e=$(this),f=e.attr("name"),e=e.prop("checked");f in a&&(a[f].show=e?!0:!1)});$("#properties textarea").each(function(b,d){var e=$(this),f=e.attr("name"),e=$.trim(e.val());a[f]={value:e,show:!1}});return a};
eeComponentDlg.prototype.onOkay=function(){EEWeb.eventLog.logEvent("eeComponentDlg","onOkay");var a=this.getOptions();if(this.currComp){if(eeServerData.bomIncludeAllowAll&&!("bom_include"in this.currComp)){var b=$("#properties input:checkbox[name='bom_include_user_allowed']").prop("checked");this.currComp.setBomIncludeUserAllowed(b)}b=jQuery.extend(!0,{},this.currComp);this.currComp.setProperties(a);EEWeb.eventLog.trackCompEvent(b,this.currComp)}this.currComp=null};
eeComponentDlg.prototype.onCancel=function(){EEWeb.eventLog.logEvent("eeComponentDlg","onCancel");this.currComp&&this.currComp.cancelProperties();this.currComp=null};function eeShareDialog(a,b,c){this.domID=a;this.id=this.dlg=null;this.project=b;this.title=l("shareproject");"undefined"!==typeof c&&(this.title=c);this.isDirect=this.enableEmail=!0}eeShareDialog.prototype.disableEmail=function(){this.enableEmail=!1};
eeShareDialog.prototype.init=function(){EEWeb.eventLog.logEvent("eeProject.doShare","");var a=this;if(0===$(this.domID).length){var b=this.domID.replace(/#/,"");$("body").append('<div id="'+b+'"></div>')}this.id=$(this.domID);this.id.load(this.getShareDialogPath(),function(){a.initPhase2()})};eeShareDialog.prototype.getShareDialogPath=function(){return TemplatePath+"ui-template/"+l_name+"/share_dialog.html"};
eeShareDialog.prototype.initPhase2=function(){this.dlg=this.id.dialog({title:this.title,resizable:!1,width:500,open:function(a,b){},close:function(a,b){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))},buttons:[{id:"share_close",text:l("close"),click:function(){$(this).dialog("close")}}],draggable:!0,modal:!0,dialogClass:"graph-popup-dialog share-dialog",autoOpen:!1});this.addHandlers();this.show()};
eeShareDialog.prototype.initForms=function(){var a=this.project;this.updateLink();this.updateVisibility(a.isPublic());this.enableEmail||$(".share_email",this.id).hide();$(".hide",this.id).hide();$(".email_block",self.id).hide();$("#embed_customize_toggle",this.id).hide();$("#toggle_box",this.id).hide();$("#embed_code",this.id).text(this.getEmbedCode())};eeShareDialog.prototype.updateLink=function(){this.isDirect?$("#share_link_txt",this.id).val(this.getDirectLink()):$("#share_link_txt",this.id).val(this.getPreviewLink())};
eeShareDialog.prototype.updateVisibility=function(a){var b=this,c=this.isOwner(),d=this.project;d.updatePublic(a).always(function(){c?($("#share_public",b.id).show(),$("#share_email",b.id).show()):($("#share_public",b.id).hide(),$("#share_email",b.id).hide());$("#share_embed",b.id).show();d.isPublic()?($("#share_r_public").prop("checked",!0),$(".share_public",b.id).show(),$(".share_private",b.id).hide()):($("#share_r_private").prop("checked",!0),$(".share_public",b.id).hide(),$(".share_private",b.id).show())})};
eeShareDialog.prototype.resetEmail=function(){var a=this.id,b=$("#share_send_list li");b.slice(1).remove();b.eq(0).find("input").val("");$("#share_message",a).val("");$(".email_block",a).hide()};eeShareDialog.prototype.getEmails=function(){var a=EEWeb.app.getUtils(),b=$("#share_send_list li input",this.id),c=[];$.each(b,function(b,e){var f=$(e).val(),f=f.replace(/\s/,"");a.isValidEmailAddress(f)&&c.push(f)});return c.join(",")};
eeShareDialog.prototype.addHandlers=function(){var a=this;$("#share_public input:radio").on("change",function(){var b="public"===$(this).val();a.updateVisibility(b)});$("#share_link_txt",this.id).click(function(){$(this).select()});this.enableEmail&&($("#share_add_recipient_btn",this.id).click(function(){var b=$("#share_send_list li").eq(0).clone();b.addClass("email_block").find("input").val("");$("#share_send_list",a.id).append(b)}),$("#share_send_list",this.id).on("click","button",function(){$(this).parent().remove()}),
$("#share_email_frm",this.id).submit(function(b){a.submitShareViaEmailForm();return!1}),$("#share_send_list li:first-child",this.id).click(function(){EEWeb.log.info("Clicked it..");$(".email_block",a.id).show()}),$("#cancel_submit",this.id).click(function(){$(".email_block",a.id).hide()}));$("#embed_code",this.id).click(function(){$(this).select()})};
eeShareDialog.prototype.getAppPath=function(a){a=a?a:!1;var b=window.location.pathname.replace(RegExp("/"+eeServerData.autoProjId+"/(?:[^/]+/)?"),""),b=b.replace(/\/$/,"");EEWeb.app.isSpecificManufacturer()&&a&&(EEWeb.app.getSpecificManufacturer(),b=b.replace("/manufacturer/","/embed/manufacturer/"));return b};
eeShareDialog.prototype.getPreviewLink=function(){var a=this.getAppPath(),b=[];b.push(window.location.protocol);b.push("//");b.push(window.location.host);b.push(a);b.push("/project/");b.push(this.project.getHashedProject());b.push("/");b.push(this.project.getName().replace(/[^-_.a-z0-9 ]/ig,"").replace(/[-_ ]+/g,"-"));return b.join("")};
eeShareDialog.prototype.getDirectLink=function(){var a=this.getAppPath(),b=[];b.push(window.location.protocol);b.push("//");b.push(window.location.host);b.push(a);b.push("/#");b.push(this.project.getHashedProject());return b.join("")};
eeShareDialog.prototype.getEmbedCode=function(){var a=this.getAppPath(!0),b=[];b.push("<iframe width='500' height='300' frameborder='0' scrolling='no' src='");b.push(window.location.protocol);b.push("//");b.push(window.location.host);b.push(a);EEWeb.app.isSpecificManufacturer()||b.push("/embed/");b.push("#");b.push(this.project.getHashedProject());b.push("'></iframe>");return b.join("")};eeShareDialog.prototype.show=function(){this.initForms();this.dlg.dialog("open")};
eeShareDialog.prototype.submitShareViaEmailForm=function(){var a=this.getEmails(),b=this.getDirectLink(),c=$("#share_message",this.id).val();if(a)this.onShareViaEmail(a,b,c,this.isDirect);else EEWeb.app.getUtils().show_alert(l("alertvalid_email"))};
eeShareDialog.prototype.onShareViaEmail=function(a,b,c,d){EEWeb.eventLog.logEvent("eeProject.onShareViaEmail","");var e=this;amplify.request({resourceId:"share",data:{project_id:this.project.getHashedProject(),project_name:this.project.getName(),email:a,link:encodeURIComponent(b),message:c,isdirect:d?"true":"false"},success:function(a,b){a.error?($("#submit_failure",e.id).show(),window.setTimeout(function(){$("#submit_failure",e.id).hide()},5E3)):($("#submit_success",e.id).show(),window.setTimeout(function(){$("#submit_success",
e.id).hide();e.resetEmail()},5E3))},error:function(a,b,c){EEWeb.log.info("Error");$("#submit_failure",e.id).show();window.setTimeout(function(){$("#submit_failure",e.id).hide()},5E3)}})};eeShareDialog.prototype.isOwner=function(){var a=this.project;return a.getOwnerId()===a.getCurrentUserId()};function eeRequestQuoteDialog(a,b,c,d){this.domID=a;this.id=this.dlg=null;this.bom=b;this.project=c;this.title=l("requestquote");"undefined"!==typeof d&&(this.title=d)}
eeRequestQuoteDialog.prototype.partList=null;eeRequestQuoteDialog.prototype.init=function(){var a=this;if(0===$(this.domID).length){var b=this.domID.replace(/#/,"");$("body").append('<div id="'+b+'"></div>')}this.id=$(this.domID);this.id.load(TemplatePath+"ui-template/"+l_name+"/request_quote.html",function(){a.initPhase2()})};
eeRequestQuoteDialog.prototype.initPhase2=function(){var a=this;this.dlg=this.id.dialog({title:a.title,resizable:!1,width:650,height:600,open:function(a,c){},close:function(a,c){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))},buttons:[{id:"submit_quote_request",text:l("submit_quote_request"),click:function(){a.validateForm()&&($(this).dialog("close"),a.processForm())}},{id:"quote_close",text:l("close"),click:function(){$(this).dialog("close")}}],draggable:!0,modal:!0,dialogClass:"graph-popup-dialog requestquote-dialog",
autoOpen:!1});this.show()};
eeRequestQuoteDialog.prototype.initForms=function(){var a=this.project,b=this.bom.getValidVendorPartList();if(b){this.partList=b;var a=a.getName(),b=EEWeb.app.getUser(),c=b.name?b.name.split(" "):null,d="",e="";if(c){for(var e=c.length-1,f=0;f<e;f+=1)d+=c[f]+" ";e=1<c.length?c[c.length-1]:""}$("#request_quote_fname").val(d);$("#request_quote_lname").val(e);$("#request_quote_email").val(b.email);$("#request_quote_project").val(a);c=new Date;a=c.getDate();b=c.getMonth()+1;c=c.getFullYear();$("#request_date").val(b+
"/"+a+"/"+c)}else this.partList=null};eeRequestQuoteDialog.prototype.show=function(){this.initForms();this.partList&&(this.clearFormErrors(),this.dlg.dialog("open"))};eeRequestQuoteDialog.prototype.clearFormErrors=function(){$(".request_quote_error_message").html("").hide();$("#request_quote_form :input").removeClass("request_quote_error_input")};
eeRequestQuoteDialog.prototype.validateForm=function(){var a=$("#request_quote_form :input"),b=!0;_.each(a,function(a){a=$(a);var d=$("#"+a.attr("id")+"_message"),e="",f=!0,g=a.attr("rules");if("undefined"!==typeof g){var h=$.trim(a.val()),g=g.split(",");_.each(g,function(a){switch(a){case "required":h||(f=!1,e+=l("not_empty"));break;case "name":h.match(/[^0-9a-zA-Z\s\-\.]/g)&&(f=!1,e+=l("invalid_name"));break;case "integer":h.match(/[^0-9]/g)&&(f=!1,e+=l("invalid_characters_found"));break;case "email":if(!h)break;
EEWeb.app.getUtils().isValidEmailAddress(h)||(f=!1,e+=l("invalid_email"));break;case "postalcode":/^[^0-9a-z]|[^0-9a-z\s\-]/gi.test(h)&&(f=!1,e+=l("invalid_characters_found"))}});f?(a.removeClass("request_quote_error_input"),d.hide().html("")):(a.addClass("request_quote_error_input"),d.show().html(e),b=!1)}});return b};
eeRequestQuoteDialog.prototype.processForm=function(){var a="",b="",b=[],c=[],d=$("#request_quote_email").val();this.partList&&(b=this.formatUserInfo(),c=this.formatPartList(),a=b[0]+c[0],b=b[1]+c[1],this.sendQuoteRequest(d,a,b)?console.log("message sent"):console.log("failed sending"))};
eeRequestQuoteDialog.prototype.formatUserInfo=function(){var a=[],b="",c="",b=$("#request_quote_quantity").val(),c=$("#request_quote_custnumber").val(),d=$("#request_quote_email").val(),e=$("#request_quote_telnumber").val(),f=$("#request_quote_country option:selected").text(),g=$("#request_quote_fname").val(),h=$("#request_quote_lname").val(),k=$("#request_quote_company").val(),m=$("#request_quote_address1").val(),n=$("#request_quote_address2").val(),p=$("#request_quote_city").val(),q=$("#request_quote_state").val(),
u=$("#request_quote_postal").val(),x=$("#request_quote_project").val(),r=$("#request_quote_date").val(),w=$("#request_quote_completion_date").val(),s=$("#request_quote_notes").val();a.push("-- CUSTOMER INFO --\n");a.push("\nASSEMBLY COUNT: "+b);a.push("\nCustomer Number: "+c);a.push("\nEmail Address: "+d);a.push("\nTelephone Number: "+e);a.push("\nCountry: "+f);a.push("\nFirst Name: "+g);a.push("\nLast Name: "+h);a.push("\nCompany: "+k);a.push("\nAddress Line 1: "+m);a.push("\nAddress Line 2: "+n);
a.push("\nCity: "+p);a.push("\nState: "+q);a.push("\nPostal Code: "+u);a.push("\nProject: "+x);a.push("\nRequested Date: "+r);a.push("\nRequested Completion Date: "+w);a.push("\n\nNotes: "+s+"\n\n");b=a.join("");c="<p>"+b.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />\n$2")+"</p>";return[b,c]};
eeRequestQuoteDialog.prototype.formatPartList=function(){var a="-- PARTS LIST --\n\n",b;b='\n<p>-- PARTS LIST --</p>\n<p>\n<table border="1" cellspacing="0" cellpadding="3">\n<tr><th>DigiKey Part Number</th><th>Manufacturer Part Number</th><th>Description</th><th>Quantity</th></tr>';for(var c=$("#request_quote_quantity").val(),d=this.partList,e=d.length,f,g=0;g<e;g+=1)f=c*d[g].qty,a=a+d[g].dkpn+"\t"+d[g].manpn+"\t"+d[g].desc+"\t"+f+"\n",b=b+"\n<tr><td>"+d[g].dkpn+"</td><td>"+d[g].manpn+"</td><td>"+
d[g].desc+'</td><td align="right">'+f+"</td></tr>";return[a+"\n\nNOTE: USE Excel Paste Special->Text to paste formatted data to spreadsheet.\n\n",b+"\n</table></p>\n<p>NOTE: USE Excel Paste Special->Text to paste formatted data to spreadsheet.</p>"]};
eeRequestQuoteDialog.prototype.sendQuoteRequest=function(a,b,c){var d=!0;amplify.request({resourceId:"request_quote",data:{from:a,body:b,htmlBody:c},success:function(a){a.error?(console.log("Error"+a.error),EEWeb.eventLog.logEvent("request_quote","failed"),d=!1,$("<div>"+a.error+"</div>").dialog({title:l("error"),dialogClass:"graph-popup-dialog",buttons:[{text:l("error_ok"),click:function(){d=!1;$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})):
(console.log("Success"+a.response),EEWeb.eventLog.logEvent("request_quote","sent"),$("<div>"+a.response+"</div>").dialog({title:l("confirmation"),dialogClass:"graph-popup-dialog",buttons:[{text:l("confirmation_ok"),click:function(){d=!0;$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}}))},error:function(a,b,c){}});return d};function eeShortcutKeysDialog(){this.shortcuts=[];this.init()}
eeShortcutKeysDialog.prototype.init=function(){this.initShortcuts();var a=this.buildDialogContent(this.shortcuts);this.addDlgToHtmlBody(a);this.initDialog()};
eeShortcutKeysDialog.prototype.initShortcuts=function(){var a=mxClient.IS_MAC?"&#8984;":"CTRL - ";this.shortcuts=[{header:l("general_shortcuts"),items:[{label:l("cut"),key:a+"X"},{label:l("copy"),key:a+"C"},{label:l("paste"),key:a+"V"},{label:l("undo"),key:a+"Z"},{label:l("redo"),key:a+"Y"},{label:l("delete"),key:"Delete"},{label:l("zoom_in"),key:"+ / I"},{label:l("zoom_out"),key:"- / O"}]},{header:l("component_shortcuts"),items:[{label:l("flipvertically"),key:"V"},{label:l("fliphorizontally"),key:"H"},
{label:l("rotate"),key:"R"},{label:l("toolbar_group_group"),key:a+"G"},{label:l("toolbar_group_ungroup"),key:a+"U"},{label:l("select_all"),key:a+"A"}]},{header:l("project_shortcuts"),items:[{label:l("openproject"),key:a+"O"},{label:l("open_prev_proj"),key:"F7"},{label:l("open_next_proj"),key:"F9"},{label:l("saveproject"),key:a+"S"}]}]};eeShortcutKeysDialog.prototype.buildDialogContent=function(a){return _.template("<div id='keyboard_shortcuts_content'><% _.each( shortcuts, function( shortcut ) { %><div class='category'><div class='label'><%= shortcut.header %></div><% _.each( shortcut.items, function( shortcutInfo ) { %><div class='item'><span class='name'><%= shortcutInfo.label %></span><span class='command'><%= shortcutInfo.key %></span></div><% }); %></div><% }); %></div>")({shortcuts:a})};
eeShortcutKeysDialog.prototype.addDlgToHtmlBody=function(a){$("body").append(a)};eeShortcutKeysDialog.prototype.initDialog=function(){$("#keyboard_shortcuts_content").dialog({title:l("keyboard_shortcuts"),autoOpen:!1,resizable:!1,modal:!0,draggable:!1,dialogClass:"graph-popup-dialog keyboard_shortcuts_dialog",width:400,height:435,close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})};eeShortcutKeysDialog.prototype.show=function(){$("#keyboard_shortcuts_content").dialog("open")};
var eePrintPreviewSetupDialog=function(){if(EEWeb.dialog.printPreviewSetup)return EEWeb.dialog.printPreviewSetup;this.configure.apply(this,_.toArray(arguments))};eePrintPreviewSetupDialog.prototype.configure=function(){this.buildDialog();this.loadDialogContent();this.attachDialog();return this};
eePrintPreviewSetupDialog.prototype.loadDialogContent=function(){var a=this;$("<div></div>").load(TemplatePath+"ui-template/print-preview-dialog-template.html",function(b,c){"error"!==c?(a.hasDialogContent=!0,a.dialogContent=_.template(b)({title:l("title",{defaultValue:"Title"})}),a.elementDialog.append($(a.dialogContent))):(a.hasDialogContent=!1,EEWeb.log.warn("print preview dialog is not loading defaulting to previous procedures"),console.warn("print preview dialog is not loading defaulting to previous procedures"))});
return this};
eePrintPreviewSetupDialog.prototype.buildDialog=function(){var a=$("<div id='print-preview-setup-dialog-container'></div>"),b=this;$(a).dialog({title:l("print_preview_setup",{defaultValue:"Print Preview Setup"}),dialogClass:"graph-popup-dialog print-preview-setup-dialog",resizable:!1,draggable:!0,modal:!0,autoOpen:!1,buttons:[{id:"print-preview-cancel-button",text:l("cancel"),click:function(){$(this).dialog("close")}},{id:"print-preview-proceed-button",text:l("proceed"),click:function(){b.openPrintPreview();$(this).dialog("close")}}],
close:function(){b.clearAllUserInput();amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}});this.elementDialog=a;return this};eePrintPreviewSetupDialog.prototype.clearAllUserInput=function(){this.elementDialog.empty();this.elementDialog.append($(this.dialogContent));return this};eePrintPreviewSetupDialog.prototype.attachDialog=function(){$("body").ready(function(){$("body").append(this.elementDialog)});return this};
eePrintPreviewSetupDialog.prototype.openDialog=function(){this.hasDialogContent?this.elementDialog.dialog("open"):this.openPrintPreview();return this};eePrintPreviewSetupDialog.prototype.configurePrintPreview=function(a){a.title=$("#print-preview-title-input").val()||a.title||"";return this};eePrintPreviewSetupDialog.prototype.openPrintPreview=function(){var a=EEWeb.app.getGraph(),a=new mxPrintPreview(a,1/a.pageScale,a.pageFormat,10,5,5);this.configurePrintPreview(a);a.open();return this};
(function(){EEWeb.dialog=EEWeb.dialog||{};EEWeb.dialog.printPreviewSetup=new eePrintPreviewSetupDialog;amplify.subscribe(EEWeb.events.OPEN_PRINT_PREVIEW_SETUP,function(){EEWeb.dialog.printPreviewSetup.openDialog()})})();function eeNotesDialog(){if(EEWeb.dialog.notes)return EEWeb.dialog.notes;this.dlg=$("#notes_dialog");this.description=this.summary=null;this.initBuildTabs();this.initDialog()}
eeNotesDialog.prototype.initEditor=function(a,b){var c;"undefined"!==typeof b.maxHeight&&(c=b.maxHeight,b.maxHeight=null);$(a).redactor(b);c&&$(a).redactor("core.getEditor").css("max-height",c);$(a).redactor("core.getEditor").css("height","90%");return a};eeNotesDialog.prototype.initBuildTabs=function(){var a=this.dlg.find(".notes_dialog_tabs");a.tabs().addClass("ui-tabs-vertical ui-helper-clearfix");return a};
eeNotesDialog.prototype.initDialog=function(){var a=this,b={};this.dlg.dialog({autoOpen:!1,title:l("notes"),resizable:!0,modal:!0,draggable:!0,dialogClass:"project-notes-dialog",height:600,width:600,minHeight:600,maxHeight:$(document).height(),minWidth:600,maxWidth:$(window).width(),buttons:[{text:l("save"),click:function(){a.onSave();$(this).dialog("close")}},{text:l("cancel"),click:function(){a.projectHandler.summary=b.summary;a.projectHandler.description=b.description;$(this).dialog("close")}}],
create:function(){var b={modalOpenedCallback:function(a,b){if("link"==a){var c=$("input#redactor-link-blank");c.prop("checked",!0);c.parent(0).hide()}$(document).off("focusin.dialog")},autoresize:!1,minHeight:400,buttons:"formatting bold italic deleted underline unorderedlist orderedlist link alignment".split(" "),formatting:["h1","h2","h3","h4","p"]};a.summary=a.initEditor($(this).find("[name='summary']"),b);a.description=a.initEditor($(this).find("[name='description']"),b)},open:function(){$(this).css("overflow",
"hidden");b.summary=a.projectHandler.summary;b.description=a.projectHandler.description;var c=a.summary,d=a.description,e=c.redactor("tabifier.get",a.projectHandler.summary||""),f=d.redactor("tabifier.get",a.projectHandler.description||"");c.redactor("code.set",e);d.redactor("code.set",f);amplify.publish(EEWeb.events.INIT_DLG_CATEGORY_APPLICATION,$(this));amplify.publish(EEWeb.events.INIT_DLG_CATEGORY_TYPE,$(this));amplify.publish(EEWeb.events.INIT_DLG_TAGS,$(this))},close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,
new ALEvent({}));amplify.publish(EEWeb.events.REMOVE_DLG_CATEGORY_APPLICATION,$(this));amplify.publish(EEWeb.events.REMOVE_DLG_CATEGORY_TYPE,$(this));amplify.publish(EEWeb.events.REMOVE_DLG_TAGS,$(this))}});return this.dlg};eeNotesDialog.prototype.doSave=function(a,b){this.projectHandler.summary=a;this.projectHandler.description=b;amplify.publish(EEWeb.events.SAVE_CATEGORIES,this.projectHandler);amplify.publish(EEWeb.events.SAVE_TAGS,this.projectHandler);return!0};
eeNotesDialog.prototype.onSave=function(){this.doSave(this.summary.redactor("code.get"),this.description.redactor("code.get"))&&this.projectHandler.setModified(!0)};eeNotesDialog.prototype.setProjectHandler=function(a){this.projectHandler=a;this.projectHandler.summary=this.projectHandler.summary||"";this.projectHandler.description=this.projectHandler.description||""};eeNotesDialog.prototype.show=function(){this.dlg.dialog("open")};
(function(){EEWeb.dialog=EEWeb.dialog||{};!AspenLabs.ieVersion||8<AspenLabs.ieVersion?(EEWeb.dialog.notes=new eeNotesDialog,amplify.subscribe(EEWeb.events.OPEN_NOTES,function(a){EEWeb.dialog.notes.setProjectHandler(a.projectHandler);EEWeb.dialog.notes.show()})):$("#toolbar_notes").remove()})();function eeLinkUrlDialog(){if(EEWeb.dialog.linkUrlDialog)return EEWeb.dialog.linkUrlDialog;this.proceedButton=this.urlInput=this.url=this.cell=this.dialog=null}
eeLinkUrlDialog.prototype.init=function(){var a=this.getDialogContent();this.addDlgToHtmlBody(a);this.initDialog();this.initHandlers()};eeLinkUrlDialog.prototype.initHandlers=function(){var a=this;amplify.subscribe(EEWeb.events.OPEN_LINK_URL_DIALOG,function(b){a.cell=b.cell;a.url=b.url;a.show()})};eeLinkUrlDialog.prototype.getDialogContent=function(){return'<div id="link_url_dialog_content"><form><input id="link_url_dialog_input" type="text" /></form></div>'};
eeLinkUrlDialog.prototype.addDlgToHtmlBody=function(a){$("body").append(a)};
eeLinkUrlDialog.prototype.initDialog=function(){var a=this;this.dialog=$("#link_url_dialog_content").dialog({title:l("edit_link"),autoOpen:!1,resizable:!1,modal:!0,draggable:!1,dialogClass:"graph-popup-dialog link_url_dialog",width:400,height:180,buttons:[{id:"link_url_cancel_button",text:l("cancel"),click:function(){$(this).dialog("close")}},{id:"link_url_proceed_button",text:l("confirmation_ok"),click:function(){a.updateLinkUrl(a.getLinkUrlInput());$(this).dialog("close")}}],create:function(){a.urlInput=
$("#link_url_dialog_input");a.proceedButton=$("#link_url_proceed_button");a.urlInput.on("keyup",function(){""===a.getLinkUrlInput()?a.proceedButton.button("disable"):a.proceedButton.button("enable")});$(this).submit(function(b){b.preventDefault();a.proceedButton.is(":enabled")&&a.proceedButton.click()})},open:function(){a.setLinkUrlInput(a.url);a.proceedButton.button("enable")},close:function(){a.cell=null;a.url=null;amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})};
eeLinkUrlDialog.prototype.setLinkUrlInput=function(a){this.urlInput.val(a)};eeLinkUrlDialog.prototype.getLinkUrlInput=function(){return this.urlInput.val()};eeLinkUrlDialog.prototype.show=function(){this.dialog.dialog("open")};eeLinkUrlDialog.prototype.updateLinkUrl=function(a){EEWeb.app.getGraph().setLinkForCell(this.cell,a)};(function(){EEWeb.dialog=EEWeb.dialog||{};EEWeb.dialog.linkUrlDialog=new eeLinkUrlDialog;EEWeb.dialog.linkUrlDialog.init()})();
function eeImageUrlDialog(){if(EEWeb.dialog.imageUrlDialog)return EEWeb.dialog.imageUrlDialog;this.dialog=null;this.editMode=!1;this.proceedButton=this.messageContainer=this.urlInput=null}eeImageUrlDialog.prototype.init=function(){var a=this.getDialogContent();this.addDlgToHtmlBody(a);this.initDialog();this.initHandlers()};
eeImageUrlDialog.prototype.initHandlers=function(){var a=this;amplify.subscribe(EEWeb.events.OPEN_IMAGE_URL_DIALOG,function(){a.show()});amplify.subscribe(EEWeb.events.EDIT_COMP_IMAGE_URL,function(b){a.editCompImageUrl(b)})};eeImageUrlDialog.prototype.getDialogContent=function(){return['<div id="image_url_dialog_content">',l("enter_valid_image_url"),':<br/><form><input id="image_url_dialog_input" type="text" /></form><div id="image_url_dialog_message"></div></div>'].join("")};
eeImageUrlDialog.prototype.addDlgToHtmlBody=function(a){$("body").append(a)};
eeImageUrlDialog.prototype.initDialog=function(){var a=this,b=!1;this.dialog=$("#image_url_dialog_content").dialog({title:l("create")+" "+l("image")+" "+l("link"),autoOpen:!1,resizable:!1,modal:!0,draggable:!1,dialogClass:"graph-popup-dialog image_url_dialog",width:400,height:200,buttons:[{id:"image_url_cancel_button",text:l("cancel"),click:function(){$(this).dialog("close")}},{id:"image_url_proceed_button",text:l("link"),click:function(){a.setDialogMessage(l("Loading")+" "+l("image"));a.proceedButton.button("disable");
var c=a.getImageUrlInput();a.validateImageUrl(c).then(function(d,e){a.updateDialogMessage(d,c);a.proceedButton.button("enable");d&&(a.onAddImage(e,b),a.dialog.dialog("close"))})}}],create:function(){a.urlInput=$("#image_url_dialog_input");a.messageContainer=$("#image_url_dialog_message");a.proceedButton=$("#image_url_proceed_button");a.urlInput.on("keyup",function(){""===a.getImageUrlInput()&&a.updateDialogMessage(!1,"")});$(this).submit(function(b){b.preventDefault();a.proceedButton.is(":enabled")&&
a.proceedButton.click()})},open:function(){a.setImageUrlInput("");a.updateDialogMessage(!1,"");b=a.getEditMode()},close:function(){a.setEditMode(!1);amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})};eeImageUrlDialog.prototype.getEditMode=function(){return this.editMode};eeImageUrlDialog.prototype.setEditMode=function(a){this.editMode=a};eeImageUrlDialog.prototype.getImageUrlInput=function(){return this.urlInput.val()};eeImageUrlDialog.prototype.setImageUrlInput=function(a){this.urlInput.val(a)};
eeImageUrlDialog.prototype.validateImageUrl=function(a){var b=$.Deferred();this.isValidImage(a).then(function(a,d){b.resolve(a,d)});return b.promise()};eeImageUrlDialog.prototype.updateDialogMessage=function(a,b){var c=this.isValidImageUrl(b)?l("no_image_found"):l("invalid_image_url"),c=_.isEmpty(b)||a?"":c;this.setDialogMessage(c)};eeImageUrlDialog.prototype.setDialogMessage=function(a){this.messageContainer.html(a)};
eeImageUrlDialog.prototype.isValidImage=function(a){var b=$.Deferred();if(this.isValidImageUrl(a)){var c=new Image;c.onerror=function(){b.resolve(!1)};c.onload=function(){b.resolve(!0,this)};c.src=a}else b.resolve(!1);return b.promise()};eeImageUrlDialog.prototype.isValidImageUrl=function(a){return a&&null!==a.match(/\.(jpeg|jpg|png)$/i)};eeImageUrlDialog.prototype.onAddImage=function(a,b){b?this.updateImageComp(a.src):this.addImageComp(a.src,{width:a.width,height:a.height})};
eeImageUrlDialog.prototype.addImageComp=function(a,b){var c=EEWeb.app,d=c.getUtils(),c=c.getGraph(),d=d.newImageSymbolComponent(a,b);c.setSelectionCells([d])};eeImageUrlDialog.prototype.updateImageComp=function(a){EEWeb.app.getUtils().updateSelectedCellsImage(a)};eeImageUrlDialog.prototype.show=function(){this.dialog.dialog("open")};eeImageUrlDialog.prototype.editCompImageUrl=function(a){this.setEditMode(!0);this.show();this.setImageUrlInput(a)};
(function(){EEWeb.dialog=EEWeb.dialog||{};EEWeb.dialog.imageUrlDialog=new eeImageUrlDialog;EEWeb.dialog.imageUrlDialog.init()})();function eeLabelGeometry(a,b,c,d){this.pos=null!=a?a:"LT";this.line=null!=b?b:0;this.anchor=null!=c?c:this.anchorFromPos(this.pos);this.linedir=null!=d?d:this.lineDirFromPos(this.pos)}mxUtils.extend(eeLabelGeometry,mxGeometry);eeLabelGeometry.prototype.sides=["L","T","R","B"];eeLabelGeometry.prototype.edges=["T","R","B","L"];eeLabelGeometry.prototype.pos=null;
eeLabelGeometry.prototype.line=null;eeLabelGeometry.prototype.anchor=null;eeLabelGeometry.prototype.linedir=1;eeLabelGeometry.prototype.getPosition=function(a){var b=this.pos;if(a){a/=90;var c=_.indexOf(this.sides,b.charAt(0)),b=_.indexOf(this.edges,b.charAt(1)),b=this.sides[(c+a)%4]+this.edges[(b+a)%4]}return b};
eeLabelGeometry.prototype.anchorFromPos=function(a){var b="TR";switch(null!=a?a:this.getPosition()){case "LT":b="TR";break;case "LB":b="BR";break;case "RT":b="TL";break;case "RB":b="BL";break;case "TL":b="BL";break;case "TR":b="BR";break;case "BL":b="TL";break;case "BR":b="TR"}return b};eeLabelGeometry.prototype.lineDirFromPos=function(a){return"T"==(null!=a?a:this.getPosition()).charAt(0)?-1:1};
eeLabelGeometry.prototype.getLabelPosition=function(a){a=a?a:this.getPosition();var b=new mxPoint(0,0);switch(a){case "LT":b=new mxPoint(0,0);break;case "LB":b=new mxPoint(0,1);break;case "RT":b=new mxPoint(1,0);break;case "RB":b=new mxPoint(1,1);break;case "TL":b=new mxPoint(0,0);break;case "TR":b=new mxPoint(1,0);break;case "BL":b=new mxPoint(0,1);break;case "BR":b=new mxPoint(1,1)}return b};
eeLabelGeometry.prototype.applyAnchorOffset=function(a,b,c){var d=null;switch(null!=c?c:this.anchor){case "TR":case "RT":d=new mxPoint(a.x-b.width,a.y);break;case "BR":case "RB":d=new mxPoint(a.x-b.width,a.y-b.height);break;case "TL":case "LT":d=new mxPoint(a.x,a.y);break;case "BL":case "LB":d=new mxPoint(a.x,a.y-b.height)}return d};
eeLabelGeometry.prototype.getOffset=function(a,b,c){var d=b.getRotation(),e=this.getPosition(d),f=this.lineDirFromPos(e),d=this.anchorFromPos(e),e=this.getLabelPosition(e);b=new mxPoint(e.x*b.geometry.width,e.y*b.geometry.height+c*f*a.height);return this.applyAnchorOffset(b,a,d)};eeLabelGeometry.prototype.getAbsRect=function(a,b,c){c=this.getOffset(a,b,c);return new mxRectangle(b.geometry.x+c.x,b.geometry.y+c.y,a.width,a.height)};function eeGraphModel(a){mxGraphModel.call(this,a)}
mxUtils.extend(eeGraphModel,mxGraphModel);var embedGraphModel=eeGraphModel;eeGraphModel.prototype.add=function(a,b,c){b.style&&0<=b.style.indexOf("group")&&(c=0);return mxGraphModel.prototype.add.call(this,a,b,c)};eeGraphModel.prototype.setProperty=function(a,b,c,d,e){this.execute(new eePropChange(this,a,b,c,d,e));return c};
function eePropChange(a,b,c,d,e,f){this.model=a;this.cell=b;this.param=c;this.previous=this.value={value:d,show:e,updated_on:f};this.myid=eePropChange.prototype.id++;EEWeb.log.info("Created eePropChange id="+this.myid+" for "+c+" Val:"+d+" Show:"+e+" updated_on:"+f)}eePropChange.prototype.id=0;
eePropChange.prototype.execute=function(){this.value=this.previous;var a="eePropChange.execute:";this.value&&(a+=" val:"+this.value.value+", show:"+this.value.show+", updated_on:"+this.value.updated_on);EEWeb.log.info(a);this.previous=this.cell.setProperty(this.param,this.previous)};function eeCell(a,b,c){mxCell.call(this,a,b,c);this.allowHtmlLabels=this.isCustomPin=this.isSmartPin=!1}mxUtils.extend(eeCell,mxCell);
eeCell.prototype.isConnectableTo=function(a,b){var c=!1;if(this.isASmartPin())return!1;a?(this.isACustomPin()&&this.validNetConnection(a)&&(c=!0),this.isASmartPin()||a.isASmartPin()||(this.isACustomPin()&&a.isACustomPin()&&(c=!0),this.isACustomPin()||a.isACustomPin()||(c=this.validDiagramConnection(a))),b&&!c&&(c=this.validDgmCmpConnection(a))):(this.isConnectable()&&(c=!0),this.isACustomPin()&&(c=!0));return c};
eeCell.prototype.validNetConnection=function(a){return a&&((a instanceof eePin||a.isACustomPin())&&a.isConnectable()||a instanceof eeEdge)};eeCell.prototype.validDiagramConnection=function(a){return a?!(a instanceof eePin||a instanceof eeEdge||a.isACustomPin()):!1};eeCell.prototype.validDgmCmpConnection=function(a){return a&&!(a instanceof eeConnection)};eeCell.prototype.isACustomPin=function(){return"isCustomPin"in this&&this.isCustomPin};
eeCell.prototype.isASmartPin=function(){return"isSmartPin"in this&&this.isSmartPin};eeCell.prototype.isAPin=function(){return this.isACustomPin()||this.isASmartPin()};eeCell.prototype.hasStencil=function(){return!this.isAPin()};eeCell.prototype.useDiagramConnection=function(){return!this.isACustomPin()};eeCell.prototype.isCopiable=function(){return!this.isASmartPin()};eeCell.prototype.setAllowHtmlLabels=function(a){this.allowHtmlLabels=a?a:!1};eeCell.prototype.isAllowHtmlLabels=function(){return this.allowHtmlLabels};
eeCell.prototype.isFlippable=function(){return!(this.isAllowHtmlLabels()||this.isAPin())};eeCell.prototype.isRotatable=function(){return!this.isAPin()};eeCell.prototype.isMovable=function(){return!this.isAPin()};eeCell.prototype.useConnectImage=function(){return!(this.isAPin()||this instanceof eeEdge)||this.isImageComponent()};eeCell.prototype.hasTooltip=function(){return!1};eeCell.prototype.constrainInParent=function(){return!this.isAPin()};eeCell.prototype.isImageComp=function(){return this.imageComp};
eeCell.prototype.allowPinOrdering=function(){return!1};eeCell.prototype.toString=function(){var a="eeCell {\n";this.value&&(a=a+"  Value:"+this.value+"\n");this.refdes&&(a=a+"  Refdes:"+this.refdes+"\n");this.parent&&(a=a+"  Parent:"+this.parent.toString()+"\n");this.source&&(a=a+"  Source:"+this.source.toString()+"\n");this.target&&(a=a+"  Target:"+this.target.toString()+"\n");return a+"}\n"};
function eeComp(a,b,c,d,e,f){eeCell.call(this,b,c,d);this.params={};this.labelsByName={};this.labelQueue=[];void 0!==a&&(this.pid=a);void 0!==e&&""!==e&&(this.setParameter(null,"refprefix",e,!1),void 0!==f&&null!==f&&this.setParameter(null,"refdes",e+f,!0));this.labelOffsetByName={}}mxUtils.extend(eeComp,eeCell);"undefined"!==typeof eeCompPropertyMixins&&_.extend(eeComp.prototype,eeCompPropertyMixins);eeComp.prototype.mxTransient="id value parent source target children edges labelsByName paramDefs propsDialog".split(" ");
eeComp.prototype.pid=null;eeComp.prototype.params={};eeComp.prototype.searchParams=null;eeComp.prototype.searchKeys=null;eeComp.prototype.paramsets=null;eeComp.prototype.labelsByName={};eeComp.prototype.labelOffsetByName={};eeComp.prototype.propsDialog=null;eeComp.prototype.labelStartGeo=null;eeComp.prototype.tooltip=null;eeComp.prototype.setCreationDate=function(){this.created_on=Math.floor((new Date).getTime()/1E3)};
eeComp.prototype.getLabels=function(){var a=[];if(this.children)for(var b=0;b<this.children.length;b++){var c=this.children[b];c instanceof eeLabel&&a.push(c)}return a};eeComp.prototype.setSearchParams=function(a){this.searchParams=a&&_.size(a)?a:null};eeComp.prototype.setSearchKeys=function(a){this.searchKeys=a&&_.size(a)?a:null};eeComp.prototype.labelValueChanged=function(a,b){this.setParameter("label",a,b)};eeComp.prototype.isParameterVisible=function(a){return a in this.labelsByName};
eeComp.prototype.getLabelOffset=function(a){return a in this.labelOffsetByName?this.labelOffsetByName[a]:null};eeComp.prototype.setLabelOffset=function(a,b){this.labelOffsetByName[a]=b.clone()};eeComp.prototype.getValue=function(){return this.value};eeComp.prototype.setValue=function(a){this.value=a};
eeComp.prototype.setParameter=function(a,b,c,d){if("string"===typeof b&&""!==b){var e=void 0!==d?!d:!1,f={val:null,ro:!1};b in this.params&&(f=this.params[b],void 0===d&&(e=this.params[b].ro));this.params[b]={val:c,ro:e};this.updated_on=Math.floor((new Date).getTime()/1E3);amplify.publish(EEWeb.events.COMPONENT_UPDATED,new ALEvent({cell:this,id:this.id,name:b,value:c,readonly:e,bom_include:"bom_include"in this,bom_include_user_allowed:this.canBomIncludeUserAllowed(),source:a}));return f}};
eeComp.prototype.updateParameter=function(a,b){a in this.params&&(this.params[a].val=b)};eeComp.prototype.getParameter=function(a){return a in this.params?(_.isObject(this.params[a])||(this.params[a]={val:this.params[a],ro:!1},EEWeb.app.getProjectHandler().setModified(!0)),this.params[a].val):null};eeComp.prototype.hasParameter=function(a){return a in this.params};eeComp.prototype.hasParameterValue=function(a){if(this.hasParameter(a)&&this.params[a])return""!=this.params[a].val};
eeComp.prototype.removeParameter=function(a,b){b in this.params&&(this.setParameterVisibility(b,!1),delete this.params[b],amplify.publish(EEWeb.events.COMPONENT_UPDATED,new ALEvent({cell:this,id:this.id,name:b,value:null,readonly:!1,bom_include:"bom_include"in this,bom_include_user_allowed:this.canBomIncludeUserAllowed(),source:a})))};eeComp.prototype.canBomIncludeUserAllowed=function(){var a=!1;eeServerData.bomIncludeAllowAll&&(a=!0===this.bom_include_user_allowed);return a};
eeComp.prototype.isParamReadonly=function(a){return a in this.params&&this.params[a].ro};eeComp.prototype.getParamList=function(){return _.keys(this.params)};eeComp.prototype.getAllParameters=function(){var a={},b=this.getParamList();_.each(b,function(b){a[b]={value:this.getParameter(b),ro:this.isParamReadonly(b),show:b in this.labelsByName?!0:!1}},this);return a};
eeComp.prototype.updateParameters=function(a){for(var b in a){var c=a[b];if(c&&"object"===typeof c&&"value"in c){var d=$.trim(c.value);this.hasParameter(b)?(this.updateParameter(b,d),(this.labelsByName[b]?!0:!1)!==c.show&&this.setParameterVisibility(b,c.show)):""!==d&&(this.setParameter(null,b,d),c.show&&this.setParameterVisibility(b,c.show))}}this.getView().clear(this,!1,!0);this.getView().validate()};
eeComp.prototype.updateParametersFromData=function(a){var b=[];"ref_prefix"in a&&a.ref_prefix&&(b.push({name:eeConstants.LABEL_REFPREFIX,value:a.ref_prefix,show:0}),b.push({name:eeConstants.LABEL_REFDES,value:a.ref_prefix+"?",show:1}));"man_pn"in a&&b.push({name:eeConstants.LABEL_MANPN,value:a.man_pn,show:0});"dk_pn"in a&&b.push({name:eeConstants.LABEL_DKPN,value:a.dk_pn,show:0});b&&this.initParameters(b)};
eeComp.prototype.setParameterVisibility=function(a,b){if(b)a in this.labelsByName||this.addComponentLabel(a,this.getParameter(a),null);else if(a in this.labelsByName){var c=this.labelsByName[a];delete this.labelsByName[a];this.queueLabelForDeletion(c)}};eeComp.prototype.insert=function(a,b){mxCell.prototype.insert.apply(this,arguments);if(a instanceof eeLabel){var c=a.getLabelName();c in this.labelsByName||(this.labelsByName[c]=a)}return a};
eeComp.prototype.queueLabelForDeletion=function(a){"null"!==typeof a&&"undefined"!==typeof a&&a instanceof eeLabel&&this.labelQueue.push(a)};eeComp.prototype.processLabelQueue=function(){var a=this.labelQueue;a&&(EEWeb.app.getGraph().removeCells(a,!1),this.labelQueue=[])};eeComp.prototype.isAssignable=function(){var a=!0;this.style&&0<=this.style.search("dkpart;image")&&(a=!1);"bom_include"in this||(a=!1);eeServerData.bomIncludeAllowAll&&(a=!0);return a};
eeComp.prototype.canPartSearch=function(){return!_.isEmpty(this.searchParams||this.searchKeys)};eeComp.prototype.onPartSearch=function(){var a=[];_.each(this.searchKeys,function(b){a.push(b)},this);_.each(this.searchParams,function(b){(b=this.getParameter(b))&&a.push('" '+b+' "')},this);a=a.join(" ");amplify.publish("search-part",this,a)};eeComp.prototype.setLabelStart=function(a){this.labelStartGeo=new eeLabelGeometry(a.pos,a.line,a.anchor,a.dir)};
eeComp.prototype.getLabelStart=function(){null===this.labelStartGeo&&(this.labelStartGeo=new eeLabelGeometry);return this.labelStartGeo};
eeComp.prototype.getOrientation=function(){var a=EEWeb.app.getGraph().getCellStyle(this),b=a[mxConstants.STYLE_STENCIL_FLIPV_PATCH]?"1":"0",c=a[mxConstants.STYLE_STENCIL_FLIPH_PATCH]?"1":"0",d=0,d="angle"in this.geometry?this.geometry.angle:90*_.indexOf(["east","south","west","north"],a[mxConstants.STYLE_DIRECTION]||"east");"1"===b&&(d=(d+180)%360);"1"===c&&(d=(d+180)%360);return[d,b,c]};eeComp.prototype.getRotation=function(){return this.getOrientation()[0]};
eeComp.prototype.addComponentLabel=function(a,b,c){var d=null;a in this.labelsByName?d=this.labelsByName[a]:(d=new eeLabel(b,"complabel",a),d.setVertex(!0),d.setConnectable(!1),EEWeb.app.getGraph().addCell(d,this),this.addLabel(d));c&&d.setCompPosition(c);d.repositionComponentLabel();this.getView().removeState(d);this.getView().validate();return d};
eeComp.prototype.removeComponentLabel=function(a){if(a in this.labelsByName){var b=this.labelsByName[a];delete this.labelsByName[a];EEWeb.app.getGraph().removeCells([b],!1)}};eeComp.prototype.addLabel=function(a){var b=a.getLabelName();this.labelsByName[b]=a;this.setParameter("label",b,a.getValue());(a=a.getGeometry())&&a.relative&&a.offset&&this.setLabelOffset(b,a.offset)};eeComp.prototype.removeLabel=function(a){a=a.getLabelName();a in this.labelsByName&&delete this.labelsByName[a]};
eeComp.prototype.syncLabels=function(){this.labelsByName={};if(this.children)for(var a=0;a<this.children.length;a++){var b=this.children[a];if(b instanceof eeLabel){var c=b.getLabelName();this.labelsByName[c]=b}}};eeComp.prototype.hasLabel=function(a){return a in this.labelsByName};eeComp.prototype.getLabelByName=function(a){return this.hasLabel(a)?this.labelsByName[a]:null};eeComp.prototype.getPins=function(){return _.filter(this.children,function(a){return a instanceof eePin})};
eeComp.prototype.getComponentValue=function(){return this.getParameter("value")};eeComp.prototype.referenceDesignator=function(){return this.getParameter(eeConstants.LABEL_REFDES)};eeComp.prototype.getPropertiesDialog=function(){return this.propsDialog};eeComp.prototype.showProperties=function(a){this.getPropertiesDialog().show(this,a)};eeComp.prototype.initParamSets=function(a){this.paramsets=a};
eeComp.prototype.initParameters=function(a){$.isArray(a)&&_.each(a,function(a){this.setParameter(null,a.name,a.value,a.editable);"1"===a.show&&this.setParameterVisibility(a.name,!0)},this)};eeComp.prototype.isConnectableTo=function(a,b){return this.isConnectable()&&b};eeComp.prototype.isConnectable=function(){return this.isImageComponent()};eeComp.prototype.isImageComponent=function(){return this.getStyle().match(/^dkpart/)?!0:!1};
eeComp.prototype.allowPinOrdering=function(){var a=1===this.getPins().length;return!(this.isSource()||this.isImageComponent()||a)};eeComp.prototype.hasStencil=function(){return!0};eeComp.prototype.hasTooltip=function(){return!0};eeComp.prototype.getTooltip=function(){if(null===this.tooltip){var a=this.getTooltipData();this.tooltip=a?this.buildTooltip(a):""}return this.tooltip};
eeComp.prototype.getTooltipData=function(){var a=EEWeb.app.getVendor(),b=this.getParameter(eeConstants.LABEL_MANPN),c=this.getParameter(eeConstants.LABEL_DKPN)||this.getParameter(eeConstants.LABEL_VENDORPN),c=b&&c?a.getVendorPartNumberLink(c,b,c):c,a=[{label:l(eeConstants.LABEL_REFDES),value:this.getParameter(eeConstants.LABEL_REFDES)},{label:l(eeConstants.LABEL_NAME),value:this.getParameter(eeConstants.LABEL_NAME)},{label:l(eeConstants.LABEL_VALUE),value:this.getParameter(eeConstants.LABEL_VALUE)},
{label:l(eeConstants.LABEL_MANPN),value:b},{label:a.getVendorPartNumberTitle(),value:c}];return a=_.filter(a,function(a){return a.value})};eeComp.prototype.buildTooltip=function(a){return _.template("<table><% _.each( tips, function( tip ) { %><tr><td><%= tip.label %></td><td> : </td><td><%= tip.value %></td></tr><% } ); %></table>")({tips:a})};
eeComp.prototype.toString=function(){return"eeComp "+JSON.stringify({Value:this.value||void 0,Refdes:this.getParameter(eeConstants.LABEL_REFDES)||void 0,Parent:(this.parent||"").toString()||void 0,Source:(this.source||"").toString()||void 0,Target:(this.target||"").toString()||void 0},null,"\t")};function eeCusComp(a,b,c,d,e,f,g){eeComp.call(this,null,a,b,c,d,e,f,g);this.nextPinNumber=1}mxUtils.extend(eeCusComp,eeComp);eeCusComp.prototype.nextPinNumber=null;eeCusComp.prototype.getNextPinNumber=function(){return this.nextPinNumber++};
eeCusComp.prototype.getSmartPins=function(){return _.filter(this.children,function(a){return"isSmartPin"in a&&a.isASmartPin()})};
eeCusComp.prototype.setGeometry=function(a){var b=this.geometry;eeComp.prototype.setGeometry.call(this,a);var c=0,d=0;!b||b.width==a.width&&b.height==a.height||(c=a.x-b.x,d=a.y-b.y);_.each(this.getSmartPins(),function(b){"Right"===b.pinLoc?(b.geometry.offset.x=a.width,b.geometry.offset.y-=d):"Bottom"===b.pinLoc?(b.geometry.offset.y=a.height,b.geometry.offset.x-=c):"Top"===b.pinLoc?b.geometry.offset.x-=c:"Left"===b.pinLoc&&(b.geometry.offset.y-=d)})};eeCusComp.prototype.isConnectableTo=function(a){return!1};
eeCusComp.prototype.hasStencil=function(){return!1};eeCusComp.prototype.isFlippable=function(){return!1};eeCusComp.prototype.isRotatable=function(){return!1};eeCusComp.prototype.toString=function(){return"eeCusComp "+JSON.stringify({Value:this.value||void 0,Refdes:this.getParameter(eeConstants.LABEL_REFDES)||void 0,Parent:(this.parent||"").toString()||void 0,Source:(this.source||"").toString()||void 0,Target:(this.target||"").toString()||void 0},null,"\t")};
function eeLabel(a,b,c){a=void 0===a?"":a;if(null===eeLabel.prototype.lineHeight){var d=mxUtils.getSizeForString("TestMe");eeLabel.prototype.lineHeight=Math.round(1.1*d.height)}d=mxUtils.getSizeForString(a,12);d=new mxGeometry(0,0,d.width,d.height);d.relative=!0;this.labelName=c;eeCell.call(this,a,d,b);this.setVertex(!0);this.setConnectable(!1)}mxUtils.extend(eeLabel,eeCell);eeLabel.prototype.mxTransient=mxCell.prototype.mxTransient.slice(0);eeLabel.prototype.mxTransient.splice(-1,0,"attachedEdge");
eeLabel.prototype.vertex=!0;eeLabel.prototype.connectible=!1;eeLabel.prototype.labelName=null;eeLabel.prototype.lineHeight=null;eeLabel.prototype.lblgeometry=null;eeLabel.prototype.attachedEdge=null;eeLabel.prototype.attachedGeometry=null;eeLabel.prototype.setAttachedEdge=function(a){void 0===a||null===a?this.attachedEdge=this.attachedGeometry=null:(this.attachedEdge=a,this.setAttachedGeometry(new mxPoint(0.5,0)))};eeLabel.prototype.getAttachedEdge=function(){return this.attachedEdge};
eeLabel.prototype.setAttachedGeometry=function(a){null===this.attachedGeometry?(this.attachedGeometry=new mxGeometry(a.x,a.y,0,0),this.attachedGeometry.relative=!0):(this.attachedGeometry.x=a.x,this.attachedGeometry.y=a.y)};eeLabel.prototype.getAttachedGeometry=function(){null===this.attachedGeometry&&(this.attachedGeometry=new mxGeometry(0.5,0,0,0),this.attachedGeometry.relative=!0);return this.attachedGeometry};
eeLabel.prototype.deltaGeometry=function(a){var b=this.geometry,c="dx:"+(a.x-b.x),c=c+" dy:"+(a.y-b.y),c=c+" dw:"+(a.width-b.width),c=c+" dh:"+(a.height-b.height);b.offset&&a.offset&&(c=c+" dox:"+(a.offset.x-b.offset.x),c=c+" doy:"+(a.offset.y-b.offset.y));return c};
eeLabel.prototype.setGeometry=function(a){var b=new mxPoint(0,0),c=null,d=null,c=null;(this.geometry=a)&&!this.isRepositioning&&(c=this.getAttachedEdge(),null!==c&&(d=this.getView(),c=d.getState(c,!0),null!==c&&(b=null!==a.offset&&"undefined"!==typeof a.offset?d.getRelativePoint(c,a.offset.x,a.offset.y):d.getRelativePoint(c,0,0)),this.setAttachedGeometry(b)))};eeLabel.prototype.setCompPosition=function(a){this.lblgeometry=a};eeLabel.prototype.getCompPosition=function(){return this.lblgeometry};
eeLabel.prototype.repositionNetLabel=function(){if(!this.getGraph().isCellSelected(this)&&null!==this.parent){this.isRepositioning=!0;if(!(this.parent instanceof eeComp)&&this.parent instanceof eeNet){var a=this.getAttachedEdge();if(null===a)this.setVisible(!1);else{this.setVisible(!0);var a=this.getView().getState(a),a=this.getView().getPoint(a,this.getAttachedGeometry()),b=this.geometry.clone();b.offset=a;this.getModel().setGeometry(this,b)}}delete this.isRepositioning}};
eeLabel.prototype.repositionComponentLabel=function(a){if(null!==this.parent&&this.parent instanceof eeComp){var b=this.lblgeometry?this.lblgeometry:this.parent.getLabelStart(),c=this.getParent();c.getRotation();var d=mxUtils.getSizeForString(this.value);if("string"===typeof a&&""!==a)c=mxUtils.getSizeForString(a),d=d.width-c.width,"R"===b.anchor[1]&&(this.geometry.offset.x-=d);else{a=_.without(c.getLabels(),this);for(var e=b.line,f=b.getAbsRect(d,c,e),g=function(a){a=a.absRect();return mxUtils.intersects(f,
a)},h=_.find(a,g);h;)e+=1,f=b.getAbsRect(d,c,e),h=_.find(a,g);this.geometry.offset=b.getOffset(d,c,e)}}};
eeLabel.prototype.updateACSourceLabelPosition=function(a,b){var c=a.getLabelName();if(90==b||270==b)"DC"==c&&(a.geometry.offset.x=a.parent.geometry.width/2+5,a.geometry.offset.y=a.geometry.width/2),"AC"==c&&(a.geometry.offset.x=a.parent.geometry.width/2+5+a.geometry.height,a.geometry.offset.y=a.geometry.width/2),"TRAN"==c&&(a.geometry.offset.x=146<a.geometry.width?-a.geometry.height+10:a.geometry.height+15,a.geometry.offset.y=a.geometry.width/2)};
eeLabel.prototype.updateValueLabelPosition=function(a,b){var c=EEWeb.app.getGraph().getView().getState(a.parent);90==b||270==b?(a.geometry.offset.x=-(a.parent.geometry.width/2+5+a.geometry.height),a.geometry.offset.y=0,void 0!==c&&1==c.style[mxConstants.STYLE_FLIPV]&&(a.geometry.offset.y=-a.geometry.height)):(a.geometry.offset.x=-a.geometry.width,a.geometry.offset.y=a.parent.geometry.height/2,void 0!==c&&1==c.style[mxConstants.STYLE_FLIPV]&&(a.geometry.offset.y=-a.parent.geometry.height/2-a.geometry.height))};
eeLabel.prototype.updateRefDesLabelPosition=function(a,b){var c=EEWeb.app.getGraph().getView().getState(a.parent);90==b||270==b?(a.geometry.offset.x=-a.geometry.width,a.geometry.offset.y=0,void 0!==c&&1==c.style[mxConstants.STYLE_FLIPV]&&(a.geometry.offset.y=-a.geometry.width)):(a.geometry.offset.x=-a.geometry.width,a.geometry.offset.y=0,void 0!==c&&1==c.style[mxConstants.STYLE_FLIPV]&&(a.geometry.offset.y=-a.geometry.height))};
eeLabel.prototype.updateModelLabelPosition=function(a,b){var c=EEWeb.app.getGraph().getView().getState(a.parent);90==b||270==b?(a.geometry.offset.x=-(a.parent.geometry.height/2+a.geometry.height),a.geometry.offset.y=0,void 0!==c&&1==c.style[mxConstants.STYLE_FLIPV]&&(a.geometry.offset.y=-a.geometry.height)):(a.geometry.offset.y=a.parent.geometry.height/2,void 0!==c&&1==c.style[mxConstants.STYLE_FLIPV]&&(a.geometry.offset.y=-a.parent.geometry.height/2-a.geometry.height))};
eeLabel.prototype.absRect=function(){var a=this.geometry;return new mxRectangle(this.parent.geometry.x+a.x+a.offset.x,this.parent.geometry.y+a.y+a.offset.y,a.width,a.height)};eeLabel.prototype.getLabelName=function(){return this.labelName};eeLabel.prototype.setLabelName=function(a){this.labelName=a};eeLabel.prototype.validateValue=function(a){a&&this.isNetNameLabel()&&(a=this.sanitizeNetName(a));return a};
eeLabel.prototype.sanitizeNetName=function(a){a=a.replace(/[^a-z0-9_]/gi,"_");/^\d/.test(a)&&/[^\d]/.test(a)&&(a="N"+a);return a};eeLabel.prototype.setValue=function(a){a=this.validateValue(a);var b=this.updateLabelValue(a);null!==this.parent&&"labelValueChanged"in this.parent&&this.parent.labelValueChanged(this.labelName,a);return b};
eeLabel.prototype.updateLabelValue=function(a){var b=this.value;if(b===a)return a;this.value=a;a=mxUtils.getSizeForString(a);this.geometry.width=a.width;this.geometry.height=a.height;if(a=this.getView().getState(this,!0))a.invalid=!0;this.repositionComponentLabel(b);this.getView().clear(this,!1,!1);this.getView().validate();return b};
eeLabel.prototype.startEditing=function(a){null!==this.parent&&this.parent instanceof eeNet?this.parent.isFixedNet()||this.getGraph().startEditingAtCell(this):null!==this.parent&&this.parent instanceof eeComp?"undefined"!==typeof eeSrc&&this.parent instanceof eeSrc?"refdes"===this.labelName&&this.parent instanceof eeSupSrc?(a=this.getView().getState(this,!0),a.width+=40,this.getGraph().startEditingAtCell(this)):this.parent.showProperties(this.labelName):this.parent.showProperties(this.labelName):
(a=this.getView().getState(this,!0),a.width+=40,this.getGraph().startEditingAtCell(this))};eeLabel.prototype.isNetNameLabel=function(){return this.parent instanceof eeNet&&"netname"===this.labelName};eeLabel.prototype.isConnectableTo=function(a){return!1};eeLabel.prototype.hasStencil=function(){return!1};eeLabel.prototype.isCopiable=function(){return!1};eeLabel.prototype.isFlippable=function(){return!1};eeLabel.prototype.isRotatable=function(){return!1};
eeLabel.prototype.isMovable=function(){return"netlabel"===this.style||"dcpointlabel"===this.style};eeLabel.prototype.constrainInParent=function(){return!1};eeLabel.prototype.toString=function(){return"eeLabel "+JSON.stringify({Name:this.labelName||void 0,Value:this.value||void 0},null,"\t")};function eePin(a,b,c,d){eeCell.call(this,a,b,c);this.pinNumber=d}mxUtils.extend(eePin,eeCell);eePin.prototype.pinNumber=null;eePin.prototype.pinType=null;
eePin.prototype.setPinNumber=function(a){this.pinNumber=a};eePin.prototype.getPinNumber=function(){return this.pinNumber};eePin.prototype.setPinType=function(a){this.pinType=a;return this};eePin.prototype.getPinType=function(){return this.pinType};eePin.prototype.isConnectable=function(){return this.connectable&&(null==this.edges||0==this.edges.length)};eePin.prototype.isConnectableTo=function(a,b){var c=!0;a&&(c=this.validNetConnection(a),b&&!c&&(c=this.validDgmCmpConnection(a)));return c};
eePin.prototype.pinId=function(){var a=null,a=null!=this.parent.refdes?this.parent.refdes:null!=this.parent.value&&""!=this.parent.value?this.parent.value:this.parent.refprefix+"?("+this.parent.id+")";return a+"."+this.pinNumber};eePin.prototype.hasStencil=function(){return!1};eePin.prototype.useDiagramConnection=function(){return!1};eePin.prototype.isAPin=function(){return!0};eePin.prototype.isFlippable=function(){return!1};eePin.prototype.isRotatable=function(){return!1};
eePin.prototype.constrainInParent=function(){return!1};eePin.prototype.toString=function(a){a=null==a?"eePin":a+" {\n";this.value&&(a=a+"  Value:"+this.value+"\n");this.parent&&(a=a+"  Parent:"+this.parent.toString()+"\n");this.pinNumber&&(a=a+"  pinNumber:"+this.pinNumber+"\n");this.pinType&&(a=a+"  pinType:"+this.pinType+"\n");this.source&&(a=a+"  Source:"+this.source.toString()+"\n");this.target&&(a=a+"  Target:"+this.target.toString()+"\n");return a+"}\n"};
function eeEdge(a,b,c,d){eeCell.call(this,a,b,c);this.isWire=!0}mxUtils.extend(eeEdge,eeCell);eeEdge.prototype.mxTransient="id value parent source target children edges netObj".split(" ");eeEdge.prototype.netObj=null;eeEdge.prototype.getValue=function(){return null};eeEdge.prototype.setValue=function(a){this.value=a};eeEdge.prototype.setGeometry=function(a){this.geometry=a;this.isNetLabelEdge()&&(a=this.getView(),a.invalidate(this,!1,!1),a.validate(cell),this.getNet().getLabel().repositionNetLabel())};
eeEdge.prototype.getNetName=function(){return this.parent instanceof eeNet?this.parent.getNetName():null!=this.netObj?this.netObj.getNetName():null};eeEdge.prototype.getNet=function(){return this.parent instanceof eeNet?this.parent:null};eeEdge.prototype.getPortNet=function(){return this.getNet().getFixedNetName()};eeEdge.prototype.isConnectableTo=function(a,b){var c=!0;a&&(c=this.validNetConnection(a),b&&!c&&(c=this.validDgmCmpConnection(a)));return c};
eeEdge.prototype.isNetLabelEdge=function(){var a=this.getNet();return null!=a?a.isLabelEdge(this):!1};
eeEdge.prototype.startEditing=function(a){if(null!=this.parent&&this.parent instanceof eeNet){var b=this.getModel(),c=EEWeb.app.getGraph();b.beginUpdate();try{var d=this.parent.getLabel();d.setVisible(!0);if(d.getAttachedEdge()!=this){this.getGraph();var e=this.getView();d.setAttachedEdge(this);var f=mxUtils.getOffset(c.container),g=mxUtils.getScrollOrigin(c.container),h=mxEvent.getClientX(a)-f.x+g.x,k=mxEvent.getClientY(a)-f.y+g.y,m=e.getScale(),n=e.getTranslate(),p=new mxPoint(h/m-n.x,k/m-n.y),
q=d.geometry.clone();q.offset=p;b.setGeometry(d,q)}var u=d.getStyle(),u=mxUtils.setStyle(u,mxConstants.STYLE_NOLABEL);b.setStyle(d,u)}finally{b.endUpdate()}this.parent.isFixedNet()||(a=this.getGraph(),a.cellEditor.emptyLabelText="Net_Name",this.getGraph().startEditingAtCell(d),a.cellEditor.emptyLabelText=null)}};eeEdge.prototype.hasStencil=function(){return!1};eeEdge.prototype.useDiagramConnection=function(){return!1};eeEdge.prototype.isFlippable=function(){return!1};
eeEdge.prototype.isRotatable=function(){return!1};eeEdge.prototype.toString=function(){return"eeEdge "+JSON.stringify({Value:this.value||void 0,NetName:this.parent instanceof eeNet&&this.parent.getNetName()||void 0,EdgeCount:this.getEdgeCount()},null,"\t")};eeEdge.prototype.clone=function(){return mxCell.prototype.clone.apply(this,arguments)};function eeConnection(a,b,c){eeCell.call(this,a,b,c);this.isWire=!1}mxUtils.extend(eeConnection,eeCell);eeConnection.prototype.mxTransient="id value parent source target children edges".split(" ");
eeConnection.prototype.isConnectableTo=function(a){return!1};eeConnection.prototype.isFlippable=function(){return!1};eeConnection.prototype.isRotatable=function(){return!1};eeConnection.prototype.toString=function(){return"eeConnection "};eeConnection.prototype.clone=function(){return mxCell.prototype.clone.apply(this,arguments)};function eeNet(a,b,c){eeCell.call(this,null,b,c);this.netName="undefined"!==typeof a?a:null;this.labelOffsetByName={}}mxUtils.extend(eeNet,eeCell);
eeNet.prototype.nextNetID=1E3;eeNet.prototype.netName=null;eeNet.prototype.netLabel=null;eeNet.prototype.dcpointlabel=null;eeNet.prototype.labelOffsetByName={};eeNet.prototype.dcpoint=null;eeNet.prototype.style="net";eeNet.prototype.vertex=!0;eeNet.prototype.connectable=!1;eeNet.prototype.getDCPoint=function(){return this.dcpoint};eeNet.prototype.labelValueChanged=function(a,b){a==eeConstants.LABEL_NETNAME&&this.setValue(String(b))};
eeNet.prototype.setValue=function(a){"number"===typeof a&&(a=String(a));this.netName=a};eeNet.prototype.getNetName=function(){null===this.netName&&null!==this.value&&(this.netName=this.value);"number"===typeof this.netName&&(this.netName=String(this.netName));this.value=null;return this.netName};eeNet.prototype.setNetName=function(a){this.setValue(a);var b=this.findLabel();null!==b&&b.setValue(a)};eeNet.prototype.getEdges=function(){return _.filter(this.children,function(a){return a instanceof eeEdge})};
eeNet.prototype.isFixedNet=function(){return null!==this.getFixedNetName()};eeNet.prototype.getFixedNetName=function(){var a=[],b=_.filter(this.children,function(a){return a instanceof eeEdge});_.each(b,function(b){var d=b.getTerminal(!0);null!==d&&d instanceof eePin&&null!==d.getPortNet()&&a.push(d);b=b.getTerminal(!1);null!==b&&b instanceof eePin&&null!==b.getPortNet()&&a.push(b)});return 0<a.length?a[0].getPortNet():null};
eeNet.prototype.getNetEdgeCount=function(){var a=0;_.each(this.children,function(b){b instanceof eeEdge&&(a+=1)});return a};eeNet.prototype.findLabel=function(){if(null!==this.netLabel)return this.netLabel;_.each(this.children,function(a){a instanceof eeLabel&&a.getLabelName()===eeConstants.LABEL_NETNAME&&(this.netlabel=a)});return this.netLabel};
eeNet.prototype.findDCLabel=function(){if(null!==this.dcpointlabel)return this.dcpointlabel;_.each(this.children,function(a){a instanceof eeLabel&&a.getLabelName()===eeConstants.LABEL_NETDCPOINT&&(this.dcpointlabel=a)},this);return this.dcpointlabel};eeNet.prototype.removeDCLabel=function(){var a=this.findDCLabel();if(a){var b=a.getGeometry();b&&b.relative&&b.offset&&this.setLabelOffset(eeConstants.LABEL_NETDCPOINT,b.offset);this.getGraph().removeCells([a],!1)}this.dcpointlabel=null};
eeNet.prototype.getLabelOffset=function(a){return a in this.labelOffsetByName?this.labelOffsetByName[a]:null};eeNet.prototype.setLabelOffset=function(a,b){this.labelOffsetByName[a]=b.clone()};eeNet.prototype.getLabel=function(){var a=this.findLabel();null===a&&(a=this.addNetLabel());null!==a.parent&&a.parent===this||this.getGraph().addCells([a],this);return a};eeNet.prototype.isLabelEdge=function(a){var b=this.findLabel();return null!==b&&b.getAttachedEdge()===a?!0:!1};
eeNet.prototype.validateLabelEdge=function(){var a=this.findLabel();if(a){var b=a.getAttachedEdge();_.contains(this.children,b)&&(b=this.getEdges(),0<b.length&&(a.setAttachedEdge(b[0]),a.repositionNetLabel()))}};
eeNet.prototype.addNetLabel=function(a){var b=new eeLabel(this.getNetName(),"netlabel",eeConstants.LABEL_NETNAME);b.setVertex(!0);b.setConnectable(!1);null!==a?b.geometry.offset=a:(b.geometry.offset=mxPoint(0,0),a=b.getStyle(),"Object"==typeof a?a[mxConstants.STYLE_NOLABEL]="1":a=a+";"+mxConstants.STYLE_NOLABEL+"=1",b.setStyle(a));this.getGraph().addCell(b,this);return this.netLabel=b};
eeNet.prototype.addDCPointLabel=function(a){if(!this.findDCLabel()){var b=this.getDCPoint();if(null===b)return null;b=new eeLabel(b,"dcpointlabel",eeConstants.LABEL_NETDCPOINT);b.setVertex(!0);b.setConnectable(!1);var c=this.getLabelOffset(eeConstants.LABEL_NETDCPOINT);null!==c?b.geometry.offset=c:null!==a?b.geometry.offset=a:(b.geometry.offset=mxPoint(0,0),a=b.getStyle(),"Object"==typeof a?a[mxConstants.STYLE_NOLABEL]="1":a=a+";"+mxConstants.STYLE_NOLABEL+"=1",b.setStyle(a));this.getGraph().addCell(b,
this);return this.dcpointlabel=b}};eeNet.prototype.setDCPoint=function(a){_.isString(a)&&"V"!=a.substr(-1,1)?a+="V":_.isNumber(a)&&(a+="V");this.dcpoint=a;var b=this.findDCLabel();b&&b.setValue(a)};eeNet.prototype.toString=function(){return"eeNet "+JSON.stringify({NetName:this.netName||void 0},null,"\t")};function eeCompSymbol(a,b,c,d,e,f){eeComp.call(this,a,b,c,d,e,f)}mxUtils.extend(eeCompSymbol,eeComp);
eeCompSymbol.prototype.validConnection=function(a,b){var c=a instanceof eeCompSymbol?b:a;return c instanceof eePin||c instanceof eeCell&&c.isACustomPin()||c instanceof eeCell&&c.isASmartPin()||c instanceof eeCusComp||c instanceof eeComp&&!(c instanceof eeCompSymbol)||c instanceof eeLabel||c instanceof eeConnection||c instanceof eeEdge?!1:!0};eeCompSymbol.prototype.isConnectableTo=function(a,b){var c=!0;a&&(c=this.validDiagramConnection(a),b&&!c&&(c=this.validDgmCmpConnection(a)));return c};
eeCompSymbol.prototype.isConnectable=function(){return this.connectable};eeCompSymbol.prototype.useConnectImage=function(){return!0};function eePartSearch(a){return this instanceof eePartSearch?(this.currentPart=null,this.strategy=a,this):new eePartSearch(a)}eePartSearch.prototype.init=function(){this.setupDkSplitter();amplify.publish(EEWeb.events.DKBAR_HIDE,new ALEvent({}));this.initDigikeyHandlers();this.disableAssign();this.strategy.init();this.initListeners()};
eePartSearch.prototype.initListeners=function(){var a=this;amplify.subscribe("search-part",function(b,c){a.componentSearch(b,c)});amplify.subscribe("component-deleted",function(){a.disableAssign()});amplify.subscribe("component-selected",function(){a.enableAssign()});amplify.subscribe("component-deselected",function(){a.enableAssign()});amplify.subscribe("component-assign",function(b,c){a.onAssign(b,c)})};
eePartSearch.prototype.setupDkSplitter=function(){amplify.publish(EEWeb.events.RESIZE,new ALEvent({}));$("#digikey_splitter").splitter({type:"h",sizeTop:!0,accessKey:"P"})};
eePartSearch.prototype.initDigikeyHandlers=function(){var a=this;$("#catalog_list, #component_catalog_list").on("mouseover mouseout","li",function(a){"mouseover"==a.type?$(this).css("background-color","#f2f2f2"):$(this).css("background-color","#fff")});$("#catalog_list, #component_catalog_list").on("click.visual","li",function(){$(this).hasClass("cat_item_hot")||($("#catalog_list li, #component_catalog_list li").attr("class",""),$(this).addClass("cat_item_hot"))});$("#digikey_bar_close").click(function(){amplify.publish(EEWeb.events.DKBAR_HIDE,
new ALEvent({}));return!1});$("#component_digikey_bar_close").click(function(){amplify.publish(EEWeb.events.COMP_DKBAR_HIDE,new ALEvent({}));return!1});$("#digikey-search-parts input[type=text], #component-digikey-search-parts input[type=text]").focus(function(){$(this).val()===l("search_box_partsearch")&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val(l("search_box_partsearch"))}).bind("keyup.search",function(a){27===a.keyCode&&amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))});
EEWeb.app.addSelModelListener(mxEvent.CHANGE,mxUtils.bind(this,function(b,c){var d=EEWeb.app.getGraph().getSelectionCells();d&&1===d.length&&null!==a.getCurrentPart()?a.enableAssign():a.disableAssign()}));$("#component-digikey-search-parts").submit(function(){EEWeb.eventLog.logEvent("dkSearchParts from component dialog","Submit");var b=$("input[type=text]",this).val();a.disableAssign("component_");a.onKeywordSearch(b,"component_");return!1});$("#digikey-search-parts").submit(function(){EEWeb.eventLog.logEvent("dkSearchParts",
"Submit");var b=$("input[type=text]",this).val();a.disableAssign();a.onKeywordSearch(b);return!1});$("#catalog_list").on("click.search","li",null,function(){a.strategy.dkPartNumberSearch($(this).data("info"),a,eePartSearch.prototype.onPartSearchResults)});$("#component_catalog_list").on("click.search","li",null,function(){a.enableAssign("component_");a.strategy.dkPartNumberSearch($(this).data("info"),a,eePartSearch.prototype.onPartSearchResults,"component_")});$("#digikey_bar_assign").click(function(){if(!$("#digikey_bar_assign").button("option",
"disabled"))a.onAssign();return!1});$("#component_digikey_bar_assign").click(function(){a.onAssignFromComponentDlg();return!1});$(".digikey_bar_btn","#digikey_btnbar, #component_digikey_btnbar").button()};eePartSearch.prototype.setCurrentPart=function(a){self.currentPart=a};eePartSearch.prototype.getCurrentPart=function(){return self.currentPart};
eePartSearch.prototype.onKeywordSearch=function(a,b){var c=b?b:"",d=$("#"+c+"catalog_list");d.empty();d.parent().find("p").remove();$("#search_status").remove();$("#"+c+"search_digikey_link").remove();$("#"+c+"region_2").empty();d.before($("<p id='search_status'>"+l("searching_digikey")+"</p>"));this.disableAssign();this.setCurrentPart(null);this.dkSearchKeywords=a;c?amplify.publish(EEWeb.events.COMP_DKBAR_SHOW,new ALEvent({})):amplify.publish(EEWeb.events.DKBAR_SHOW,new ALEvent({}));this.strategy.dkKeywordSearch(a,
this,eePartSearch.prototype.onKeywordSearchResults,b)};
eePartSearch.prototype.onKeywordSearchResults=function(a,b){var c=b?b:"",d=$("#"+c+"catalog_list");$("#search_status").remove();if(null===a)d.before($("<p id='search_status'>"+l("no_matching_digikey")+"</p>"));else{var e=EEWeb.helper.getDomainName();d.after($("<p id='"+c+"search_digikey_link'><a href='http://"+e+"/product-search/"+eeServerData.sess_language+"?x=0&y=0&KeyWords="+encodeURIComponent(a.keywords)+"' target='_blank'>"+l("view_more_digikey")+"</a></p>"));c=a.products;20<a.count&&(c=c.slice(0,
20));_.each(c,function(a){var b=$('<li><span name="'+a.getDkPartNumber()+'">'+a.getManuPartNumber()+"</span><br />"+a.getDescription()+"</li>");b.data("info",a);d.append(b)});EEWeb.eventLog.sendPartSearchEvent(this.dkSearchKeywords,a.count)}};
eePartSearch.prototype.onPartSearchResults=function(a,b){var c=b?b:"",d=$('<div id="'+c+'catalog_item_title"></div>');null===a?(this.disableAssign(),d.text("")):(this.setCurrentPart(a),this.enableAssign(),d.text(a.getDescription()),$r2=$("#"+c+"region_2"),$r2.empty(),$r2.append(d),d="http://"+EEWeb.helper.getDomainName()+"/product-search/"+eeServerData.sess_language+"?x=0&y=0&KeyWords="+encodeURIComponent(a.getDkPartNumber()),d=this.addDkDiv($r2,l("digikey_partnum"),d,a.getDkPartNumber()),this.addDragAssignDiv(d),
this.addDkDiv($r2,l("manufacturer_partnum"),null,a.getManuPartNumber()),_.each(a.getMediaFiles(),function(a){switch(a.type){case "datasheet":this.addDkDiv($r2,l("digikey_product_datasheet"),a.url,l("digikey_product_viewdatasheet"));break;case "photo":this.addDkImg($r2,l("digikey_product_photos"),a.url,180);break;case "drawing":this.addDkImg($r2,l("digikey_catalog_drawings"),a.url,180)}},this),c||(this.initDraggableHintHandlers(),c=$("#region_2 .catalog_item_wrap").not(".catalog_item_assign_draggable"),
c.find("img").data("component",{type:"dk",obj:a}),this.initCatalogItemHandlers(c),c=$("#region_2 .catalog_item_drag_to_assign"),c.find("img").data("component",{type:"assign_draggable",obj:a}),this.initCatalogItemHandlers(c)))};eePartSearch.prototype.componentSearch=function(a,b){$("input[type=text]","#digikey-search-parts").val(b);this.searchComponent=a;this.onKeywordSearch(b)};
eePartSearch.prototype.addDkDiv=function(a,b,c,d){$("<h3></h3>").html(b).appendTo(a);b=$("<div></div>").addClass("catalog_item_wrap");c?$("<a></a>").attr("href",c).attr("target","_blank").text(d).appendTo(b):b.text(d);b.appendTo(a);return b};
eePartSearch.prototype.addDragAssignDiv=function(a){if(this.isDragAssignEnabled()){var b=$("<div></div>");a.addClass("catalog_item_assign_draggable");b.addClass("catalog_item_drag_to_assign");b.text(l("drag_to_symbol_to_assign"));$('<img class="drag_assign" />').attr("src",EEBasepath+"img/pointupleft.png").appendTo(b);b.appendTo(a)}};
eePartSearch.prototype.addDkImg=function(a,b,c,d){$("<h3></h3>").html(b).appendTo(a);b=$("<div></div>").addClass("catalog_item_wrap");$("<img/>").attr("src",c).attr("width",d).appendTo(b);$('<div class="click_to_drag">click to drag</div>').appendTo(b);b.appendTo(a);$("img",b).removeAttr("height")};eePartSearch.prototype.initDraggableHintHandlers=function(){$(".catalog_item_wrap").on("mouseenter",function(){$(this).find(".click_to_drag").show()}).on("mouseleave",function(){$(this).find(".click_to_drag").hide()})};
eePartSearch.prototype.initCatalogItemHandlers=function(a){var b=EEWeb.helper;a.draggable({zIndex:3E3,appendTo:"#schematic",scroll:!1,cancel:"button",cursorAt:{top:-2,left:-7},opacity:0.75,addClasses:!1,helper:function(){return b.onDragStart($(this).find("img"))}});AspenLabs.ieVersion&&8>=AspenLabs.ieVersion||a.draggable("option","distance",25);a.bind("drag",function(a,d){return b.onDrag($(this).find("img"),a.clientX,a.clientY)});a.bind("dragstop",function(a,d){b.onDragStop($(this).find("img"),a.clientX,
a.clientY)});a.bind("click",function(a,d){b.onClick($(this).find("img"))})};eePartSearch.prototype.addComponent=function(a,b){var c=this.getCurrentData(b);EEWeb.app.getUtils().newComponentFromDKSearch(a,c)};eePartSearch.prototype.enableAssign=function(a){var b=a?a:"",c=EEWeb.app.getGraph().getSelectionCells();c&&1==c.length&&c[0]instanceof eeComp&&c[0].isAssignable()?$("#"+b+"digikey_bar_assign").button("enable"):this.disableAssign(a)};
eePartSearch.prototype.disableAssign=function(a){$("#"+(a?a:"")+"digikey_bar_assign").button("disable")};
eePartSearch.prototype.onAssign=function(a,b){a=a?a:!1;if((b=b?b:EEWeb.app.getGraph().getSelectionCells())&&1===b.length){var c=this.getCurrentPart(),c={manu:{value:c.getManuName(),show:null},manpn:{value:c.getManuPartNumber(),show:null},dkpn:{value:c.getDkPartNumber(),show:null},desc:{value:c.getDescription(),show:null}};if(!a){var d=b[0],e=jQuery.extend(!0,{},d);d.setProperties(c);EEWeb.eventLog.trackCompEvent(e,d)}}return c};
eePartSearch.prototype.onAssignFromComponentDlg=function(){var a=eePartSearch.prototype.onAssign.call(this,!0),b=EEWeb.app.getComponentDialog();a&&b.updateForm(a)};eePartSearch.prototype.isDragAssignEnabled=function(){return eeServerData.enableDragAssign?!0:!1};
function dkSearchPart(a){return this instanceof dkSearchPart?(this.name=this.desc="",this.manu=this.manpn=this.dkpn=null,this.qtyonhand=0,this.sourcePhoto=this.productPhoto=this.category=this.vendorID=null,this.media=[],this.bom_include=!0,a&&this.initFromSource(a),this):new dkSearchPart(a)}dkSearchPart.prototype.initFromSource=function(a){"undefined"!==typeof a.productDescription?this.initFromDigikeySource(a):"undefined"!==typeof a.DigiKeyPartNumber&&this.initFromZendSource(a)};
dkSearchPart.prototype.initFromDigikeySource=function(a){this.desc=a.productDescription;this.manu=a.manufacturerName?a.manufacturerName:"";this.manpn=a.manufacturerPartNumber?a.manufacturerPartNumber:"";this.dkpn=a.digiKeyPartNumber?a.digiKeyPartNumber:"";this.category=a.category?a.category:null;this.qtyonhand="undefined"!==typeof a.quantityOnHand?a.quantityOnHand:null;this.vendorID="undefined"!==typeof a.vendorID?a.vendorID:null;this.productPhoto=null;this.name="undefined"!==typeof a.productName?
a.productName:"";this.media=[];"undefined"!==typeof a.mediaFiles&&_.each(a.mediaFiles.mediaFile,function(a){var c={};switch(a.typeId){case 1:c.type="datasheet";c.url=a.url;c.title=a.title;break;case 2:c.type="photo";c.url=a.url;c.title=a.title;this.productPhoto=a.url;break;case 19:c.type="drawing",c.url=a.url,c.title=a.title}this.addMediaFile(c)},this)};
dkSearchPart.prototype.initFromZendSource=function(a){this.desc=a.ProductDescription;this.manu=a.ManufacturerName?a.ManufacturerName:"";this.manpn=a.ManufacturerPartNumber?a.ManufacturerPartNumber:"";this.dkpn=a.DigiKeyPartNumber?a.DigiKeyPartNumber:"";this.category=a.Category?a.Category:null;this.qtyonhand="undefined"!==typeof a.QuantityOnHand?a.QuantityOnHand:null;this.vendorID="undefined"!==typeof a.vendorID?a.vendorID:null;this.productPhoto=null;this.media=[];"undefined"!==typeof a.MediaFiles&&
_.each(a.MediaFiles.MediaFile,function(a){var c={};switch(a.Type){case "Datasheets":c.type="datasheet";c.url=a.Url;c.title=a.Title;break;case "Product Photos":c.type="photo";c.url=a.Url;c.title=a.Title;this.productPhoto=a.Url;break;case "Catalog Drawings":c.type="drawing",c.url=a.Url,c.title=a.Title}this.addMediaFile(c)},this)};dkSearchPart.prototype.setManuName=function(a){this.manu=a};dkSearchPart.prototype.getManuName=function(){return this.manu};
dkSearchPart.prototype.setManuPartNumber=function(a){this.manpn=a};dkSearchPart.prototype.getManuPartNumber=function(){return this.manpn};dkSearchPart.prototype.setDkPartNumber=function(a){this.dkpn=a};dkSearchPart.prototype.getDkPartNumber=function(){return this.dkpn};dkSearchPart.prototype.setDescription=function(a){this.desc=a};dkSearchPart.prototype.getDescription=function(){return this.desc};dkSearchPart.prototype.addMediaFile=function(a){this.media.push(a)};
dkSearchPart.prototype.getMediaFiles=function(a){return this.media};dkSearchPart.prototype.getProductPhoto=function(){return this.productPhoto};dkSearchPart.prototype.setElementSource=function(a){this.sourcePhoto=a};dkSearchPart.prototype.getElementSource=function(){return this.sourcePhoto};dkSearchPart.prototype.getBOMInclude=function(){return this.bom_include};
dkSearchPart.prototype.getParams=function(){var a={refdes:{value:"",show:!0},name:{value:"",show:!1},value:{value:"",show:!1},manu:{value:"",show:!1},manpn:{value:"",show:!1},dkpn:{value:"",show:!1},desc:{value:"",show:!1}};for(nm in a)nm in this&&(a[nm].value=this[nm]);return a};function dkSearchStrategy(){return this instanceof dkSearchStrategy?(this.dkSearchKeywords="",this):new dkSearchStrategy}dkSearchStrategy.prototype.init=function(){};
dkSearchStrategy.prototype.dkKeywordSearch=function(a,b,c,d){this.dkSearchKeywords=a;var e=this;amplify.request({resourceId:"search_keyword",data:{keywords:a,lang:l_name},success:function(a){e.onKeywordSearchResults(a,b,c,d)},error:function(){c.call(b,null)}})};
dkSearchStrategy.prototype.onKeywordSearchResults=function(a,b,c,d){var e=[];$.isArray(a.result)&&(e=a.result);a=0;e&&(a=e.length);if(0===a)c.call(b,null,d);else{var f={};f.count=a;f.keywords=this.dkSearchKeywords;f.products=[];_.each(e,function(a){f.products.push(new dkSearchPart(a))});c.call(b,f,d)}};
dkSearchStrategy.prototype.dkPartNumberSearch=function(a,b,c,d){a=a.getDkPartNumber();var e=this;amplify.request({resourceId:"search_product",data:{part:a,lang:l_name},success:function(a){e.onPartSearchResults(a,b,c,d)},error:function(){c.call(b,null,d)}})};dkSearchStrategy.prototype.onPartSearchResults=function(a,b,c,d){a=new dkSearchPart(a.productInfo);c.call(b,a,d)};
function eeGui(){return EEWeb.gui&&"undefined"!==typeof EEWeb.gui?EEWeb.gui:this instanceof eeGui?(this.bIsLoggedIn=!1,this.bIsGridVisible=!0,this.unsavedwarning=l("unsaved_small_caps"),EEWeb.gui=this,this):new eeGui}eeGui.prototype.timeout=null;eeGui.prototype.viewMinScale=0.5;eeGui.prototype.setLoggedIn=function(a){this.bIsLoggedIn=!0===a;this.setUnsavedWarning(this.bIsLoggedIn)};eeGui.prototype.isLoggedIn=function(){return this.bIsLoggedIn};
eeGui.prototype.init=function(){this.addEditorActions();this.addLoginActions();this.addHelpActions();this.addHelpOptionsActions();this.addToolbarActions();this.addLiveChatAction();this.addContactUsActions();this.addKeyboardShortcutAction();this.addGuiActions();this.addPageActions();this.addListeners();this.addKeyHandlers();this.initJpicker();this.initListItems();this.initSchematicItem();this.initHandlers();this.hideDigikeyBar();this.initZoomScaleValues();this.initScrollbarWidthValue()};
eeGui.prototype.helpOptions=function(a,b){b=_.extend({timeout:2E3},b);return function(a){function d(){"undefined"!==typeof g&&(window.clearTimeout(g),g=void 0)}function e(){d();a.slideDown()}function f(){d();a.slideUp()}var g;return{clear:d,reset:function(){g=window.setTimeout(f,b.timeout)},show:e,hide:f,toggle:function(){"none"==a.css("display")?e():f()}}}(a)};
eeGui.prototype.initHelpOptionsHandlers=function(a,b){var c=this.helpOptions(b);a.on("click",function(a){a.preventDefault();c.toggle()});b.add(a).on("mouseleave",function(){c.reset()});b.add(a).on("mouseenter",function(){c.clear()})};
eeGui.prototype.initHandlers=function(){var a=this;amplify.subscribe(EEWeb.events.UPDATE_PAGE_COUNT,function(b){a.setPageCount(b.numPages,b.pages)});amplify.subscribe(EEWeb.events.PAGE_CHANGED,function(b){a.setCurrentPage(b.curr)});amplify.subscribe(EEWeb.events.LOAD_PROJECT,function(b){a.onProjectLoad(b)});amplify.subscribe(EEWeb.events.LOAD_PROJECT_COMPLETE,function(b){a.onProjectLoadComplete(b)});amplify.subscribe(EEWeb.events.DIALOG_CLOSED,function(){a.onDialogClose()});amplify.subscribe(EEWeb.events.USER_UPDATED,
function(b){a.onUserUpdated(b)});amplify.subscribe(EEWeb.events.PROJECT_NAME_CHANGED,function(b){a.onProjectNameChange(b)});amplify.subscribe(EEWeb.events.PROJECT_MODIFIED,function(b){a.onProjectModified(b)});amplify.subscribe(EEWeb.events.NEW_PROJECT,function(){a.onProjectNew()});amplify.subscribe(EEWeb.events.DKBAR_HIDE,function(b){a.onDigikeyBarHide(b)});amplify.subscribe(EEWeb.events.DKBAR_SHOW,function(b){a.onDigikeyBarShow(b)});amplify.subscribe(EEWeb.events.TAB_CLICK,function(b){a.onTabClick($(b.tab))});
amplify.subscribe(EEWeb.events.REPOS_DIALOGS,function(b){a.repositionDialogs()});amplify.subscribe(EEWeb.events.PROJECT_PARSER_ERROR,function(b){a.notifyProjectParserError()});amplify.subscribe(EEWeb.events.ZOOM_IN,function(b){a.zoomIn(b)});amplify.subscribe(EEWeb.events.ZOOM_OUT,function(b){a.zoomOut(b)});amplify.subscribe(EEWeb.events.ZOOM_TO,function(b){a.zoomTo(b.scale)});amplify.subscribe(EEWeb.events.ZOOM_POS_TO,function(b){a.zoomPanTo(b.scale,b.pos)});amplify.subscribe(EEWeb.events.ZOOM_FIT,
function(){a.zoomToFit()});amplify.subscribe("make-draggable",function(b){a.makeDraggable(b)});$("#schematic").bind("mousewheel MozMousePixelScroll wheel",function(b){if(b.ctrlKey&&!b.shiftKey)a.onMouseWheel(b);b.shiftKey&&a.scrollLeft(0)});$("#schematic-wrapper").bind("wheel",function(b){a.scrollLeft(0)})};eeGui.prototype.addLiveChatAction=function(){$(document).on("click",".live_chat",function(){amplify.publish(EEWeb.events.USER_LIVE_CHAT,new ALEvent({}));return!1})};
eeGui.prototype.addGuiActions=function(){var a=this,b=$("#sidebar_components");b.on("click","ul li.list_1",function(){$(this).hasClass("hover_1_static")?($(".level_1 li").removeClass("hover_1_static"),$(".level_2",this).slideUp("fast")):($(".level_1 li").removeClass("hover_1_static"),$(this).addClass("hover_1_static"),$(".level_2").slideUp("fast"),$(".level_2",this).slideDown("fast"))});b.on("click","ul .level_2 li.list_2",function(a){a.stopImmediatePropagation();$(this).hasClass("hover_2_static")?
($(".level_3",this).slideUp("fast"),$(".level_2 li").removeClass("hover_2_static"),(2==$(".level_3 > li.list_3",this).length||$(this).find(".list_4").length)&&$(".level_4",this).slideUp("fast")):($(".level_3").slideUp("fast"),$(".list_2 .level_4").slideUp("fast"),$(".level_2 li").removeClass("hover_2_static"),$(".level_3",this).slideDown("fast"),$(this).addClass("hover_2_static"),2<=$(".hover_3_static li",this).length&&$(".hover_3_static > .level_4",this).slideDown("fast"),1<$("> .level_4 li",this).length&&
$("> .level_4",this).slideDown("fast"))});b.on("click","ul .level_3 li.list_3",function(a){a.stopImmediatePropagation();$(this).hasClass("hover_3_static")?($(".level_4",this).slideUp("fast"),$(".level_3 li").removeClass("hover_3_static")):($(".level_4").slideUp("fast"),$(".level_3 li").removeClass("hover_3_static"),$(".level_4",this).slideDown("fast"),$(this).addClass("hover_3_static"))});b.on("click","ul.level_4",function(a){a.stopImmediatePropagation()});b.on("mouseenter",".level_1 li",function(){$(this).hasClass("loader")||
$(this).addClass("hover_1")}).on("mouseleave",".level_1 li",function(){$(this).removeClass("hover_1")});b.on("mouseenter",".level_2 li",function(){$(this).hasClass("loader")||$(this).addClass("hover_2")}).on("mouseleave",".level_2 li",function(){$(this).removeClass("hover_2")});b.on("mouseenter",".level_3 li",function(){$(this).hasClass("loader")||$(this).addClass("hover_3")}).on("mouseleave",".level_3 li",function(){$(this).removeClass("hover_3")});b.on("mouseenter",".level_4 li",function(){$(this).hasClass("loader")||
$(this).addClass("hover_4")}).on("mouseleave",".level_4 li",function(){$(this).removeClass("hover_4")});$(".menu_sub_group li").mouseenter(function(){$(this).addClass("toolbar_hover")}).mouseleave(function(){$(this).removeClass("toolbar_hover")});$("#tabs li").mouseenter(function(){$(this).hasClass("tab_hot")||$(this).addClass("tab_hover")}).mouseleave(function(){$(this).removeClass("tab_hover")});$("#z_in").mouseenter(function(){$(this).attr("class","z_in_hover")}).mouseleave(function(){$(this).attr("class",
"z_in_cold")});$("#z_out").mouseenter(function(){$(this).attr("class","z_out_hover")}).mouseleave(function(){$(this).attr("class","z_out_cold")});$("#z_reset").mouseenter(function(){$(this).attr("class","z_reset_hover")}).mouseleave(function(){$(this).attr("class","z_reset_cold")});$("#z_fit").mouseenter(function(){$(this).attr("class","z_fit_hover")}).mouseleave(function(){$(this).attr("class","z_fit_cold")});$("#z_in").mousedown(function(){$(this).attr("class","z_in_click")});$("#z_in").mouseup(function(){$(this).attr("class",
"z_in_cold")});$("#z_in").mouseleave(function(){$(this).attr("class","z_in_cold")});$("#z_out").mousedown(function(){$(this).attr("class","z_out_click")});$("#z_out").mouseup(function(){$(this).attr("class","z_out_cold")});$("#z_out").mouseleave(function(){$(this).attr("class","z_out_cold")});$("#z_reset").mousedown(function(){$(this).attr("class","z_reset_click")});$("#z_reset").mouseup(function(){$(this).attr("class","z_reset_cold")});$("#z_reset").mouseleave(function(){$(this).attr("class","z_reset_cold")});
$("#z_fit").mousedown(function(){$(this).attr("class","z_fit_click")});$("#z_fit").mouseup(function(){$(this).attr("class","z_fit_cold")});$("#z_fit").mouseleave(function(){$(this).attr("class","z_fit_cold")});$("#tabs li").click(function(){a.onTabClick($(this))});$("#tabs").on("click","li .ui-icon-close",function(){a.onTabCloseClick($(this))});$(".level_2").slideUp(0);$(".level_2").first().show().parent().addClass("hover_1_static");$("#select_1").addClass("select_1_hot");$("#select_2").addClass("select_2_cold");
$("#z_in").addClass("z_in_cold");$("#z_out").addClass("z_out_cold");$("#z_reset").addClass("z_reset_cold");$("#z_fit").addClass("z_fit_cold");$("#pages").on("mouseenter","li",function(){$(this).hasClass("page_hot")||$(this).addClass("page_hover")}).on("mouseleave","li",function(){$(this).removeClass("page_hover")});$("#pagetab_div").on("click","li.page_tab",function(){$(this).index();var a=$(this).prop("page");amplify.publish(EEWeb.events.PAGE_CLICK,new ALEvent({index:a}))});$("#pagetab_div").on("click",
"li.page_insert",function(){$(this).hasClass("iseditingpage")||amplify.publish(EEWeb.events.PAGE_ADD,new ALEvent)});$("#catalog_list").on("dblclick","li",function(){var a=EEWeb.helper.getDomainName(),b=$(this),e=encodeURIComponent($("span",b).text()),b=encodeURIComponent($("span",b).attr("name"));window.open("http://"+a+"/product-detail/"+eeServerData.sess_language+"/"+e+"/"+b,"_blank")});$("#schematic").mousemove(function(b){a.mousePosition={pageX:b.pageX?b.pageX:b.originalEvent.pageX,pageY:b.pageY?
b.pageY:b.originalEvent.pageY}})};
eeGui.prototype.initJpicker=function(){var a=this,b=EEWeb.app.getGraph();$("#jPicker").jPicker({images:{clientPath:EEBasepath+"/images/jpicker/"}},function(c,d){var e=c.val("all");c=e&&"#"+e.hex||"none";b.cellEditor.isContentEditing()?document.execCommand("forecolor",!1,c!=mxConstants.NONE?c:"transparent"):a.editColorStyle&&EEWeb.app.getGraph().setCellStyles(a.editColorStyle,c);$(this).dialog("close")},function(){},function(){$(this).dialog("close")});$("#jPicker").dialog({autoOpen:!1,height:349,
width:545,title:l("chooseacolor"),resizable:!1,close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})};
eeGui.prototype.addEditorActions=function(){var a=this,b=EEWeb.app.getEditor(),c=EEWeb.app.getGraph();b.addAction("preview",function(){amplify.publish(EEWeb.events.OPEN_PRINT_PREVIEW_SETUP)});b.addAction("cut",function(){c.componentInSelection()&&mxClipboard.cut(c)});b.addAction("copy",function(){c.componentInSelection()&&mxClipboard.copy(c)});b.addAction("paste",function(){mxClipboard.paste(c)});b.addAction("delete",function(){c.removeCells();amplify.publish("component-deleted")});b.addAction("edit",
function(b,c,f){a.onEdit(b,c,f)});b.addAction("fliph",function(){a.onFlipHorizontal()});b.addAction("flipv",function(){a.onFlipVertical()});b.addAction("rotate",function(b,c){a.onRotate(c)});b.addAction("zoom_in",function(){a.zoomIn()});b.addAction("zoom_out",function(){a.zoomOut()});b.addAction("zoom_fit",function(){a.zoomToFit()});b.addAction("toggle_grid",function(){a.toggleGrid()})};
eeGui.prototype.addListeners=function(){var a=this;EEWeb.app.getGraph().model.addListener(mxEvent.CHANGE,function(b,c){a.onChange(b,c)})};
eeGui.prototype.addLoginActions=function(){$(document).on("click","#login",function(){EEWeb.project.saveSession();amplify.publish(EEWeb.events.USER_LOGIN,new ALEvent({}));return!1});$(document).on("click","#logout",function(){amplify.publish(EEWeb.events.USER_LOGOUT,new ALEvent({}));return!1});$(document).on("click","#sign_up",function(a){a.preventDefault();amplify.publish(EEWeb.events.USER_SIGNUP,new ALEvent({}));return!1})};
eeGui.prototype.addContactUsActions=function(){$(document).on("click","#contact_us",function(){amplify.publish(EEWeb.events.USER_CONTACT_US,new ALEvent({}));return!1})};eeGui.prototype.addHelpActions=function(){var a=this;$("#help_button").click(function(b){b.preventDefault();a.onHelp()});$("#help_nav a").click(function(b){b.preventDefault();a.onHelpItem($(this))})};
eeGui.prototype.addHelpOptionsActions=function(){var a=$("#contact_us_options"),b=$("#contact_us_div");"undefined"!=typeof a.offset()&&b.css("left",a.offset().left);this.initHelpOptionsHandlers(a,b)};eeGui.prototype.addKeyboardShortcutAction=function(){var a=EEWeb.app.getShortcutKeysDialog();$("#keyboard_shortcuts_button").click(function(b){b.preventDefault();a.show()})};
eeGui.prototype.addToolbarActions=function(){var a=this,b=EEWeb.app.getProjectHandler();$("#toolbar_save").click(function(a){b.onSave(a.altKey)});$("#toolbar_saveas").click(function(){b.onSaveAs()});$("#toolbar_new").click(function(){b.onNew()});$("#toolbar_open").click(function(a){b.onOpen(a.altKey)});$("#toolbar_export").click(function(){b.doExport()});$("#toolbar_bom_export").click(function(){amplify.publish(EEWeb.events.BOM_EXPORT,new ALEvent)});$("#toolbar_bom_order").click(function(){amplify.publish(EEWeb.events.BOM_ORDER,
new ALEvent)});$("#toolbar_share").click(function(){b.onShare()});$("#toolbar_print").click(function(){EEWeb.app.getEditor().execute("preview")});$("#toolbar_cut").click(function(){EEWeb.eventLog.logEvent("#toolbar_cut","click");EEWeb.app.getEditor().execute("cut")});$("#toolbar_copy").click(function(){EEWeb.eventLog.logEvent("#toolbar_copy","click");EEWeb.app.getEditor().execute("copy")});$("#toolbar_paste").click(function(){EEWeb.eventLog.logEvent("#toolbar_paste","click");EEWeb.app.getEditor().execute("paste")});
$("#toolbar_delete").click(function(){EEWeb.app.getEditor().execute("delete")});$("#toolbar_undo").click(function(){EEWeb.eventLog.logEvent("#toolbar_undo","click");EEWeb.app.getEditor().execute("undo")});$("#toolbar_redo").click(function(){EEWeb.eventLog.logEvent("#toolbar_redo","click");EEWeb.app.getEditor().execute("redo")});$("#toolbar_textbox").click(function(){amplify.publish(EEWeb.events.INSERT_TEXT_BOX)});$("#z_in").click(function(){amplify.publish(EEWeb.events.ZOOM_IN,new ALEvent)});$("#z_out").click(function(){amplify.publish(EEWeb.events.ZOOM_OUT,
new ALEvent)});$("#z_reset").click(function(){amplify.publish(EEWeb.events.ZOOM_RESET,new ALEvent)});$("#z_fit").click(function(){amplify.publish(EEWeb.events.ZOOM_FIT)});$("#toolbar_group").click(function(){EEWeb.eventLog.logEvent("#toolbar_group","click");a.onGroup()});$("#toolbar_ungroup").click(function(){EEWeb.eventLog.logEvent("#toolbar_ungroup","click");a.onUnGroup()});$("#toolbar_raise").click(function(){EEWeb.app.getGraph().orderCells(!1)});$("#toolbar_lower").click(function(){EEWeb.app.getGraph().orderCells(!0)});
$("#toolbar_flip_v").click(function(){EEWeb.eventLog.logEvent("#toolbar_flipv","click");EEWeb.app.getEditor().execute("flipv")});$("#toolbar_flip_h").click(function(){EEWeb.eventLog.logEvent("#toolbar_fliph","click");EEWeb.app.getEditor().execute("fliph")});$("#toolbar_rotate").click(function(){EEWeb.eventLog.logEvent("#toolbar_rotate","click");EEWeb.app.getEditor().execute("rotate")});$("#toolbar_align_left").click(function(){a.onAlignCells(mxConstants.ALIGN_LEFT)});$("#toolbar_align_center").click(function(){a.onAlignCells(mxConstants.ALIGN_CENTER)});
$("#toolbar_align_right").click(function(){a.onAlignCells(mxConstants.ALIGN_RIGHT)});$("#toolbar_align_top").click(function(){a.onAlignCells(mxConstants.ALIGN_TOP)});$("#toolbar_align_middle").click(function(){a.onAlignCells(mxConstants.ALIGN_MIDDLE)});$("#toolbar_align_bottom").click(function(){a.onAlignCells(mxConstants.ALIGN_BOTTOM)});$("#toolbar_fill").click(function(){a.onFill()});$("#toolbar_gradient").click(function(){a.onGradient()});$("#toolbar_stroke").click(function(){a.onStroke()});$("#toolbar_bold").click(function(){a.onBold()});
$("#toolbar_italic").click(function(){a.onItalic()});$("#toolbar_underline").click(function(){a.onUnderline()});$("#toolbar_bigger").click(function(){a.onBigger()});$("#toolbar_smaller").click(function(){a.onSmaller()});$("#toolbar_color").click(function(){a.onColor()});$("#toolbar_text_left").click(function(){a.onTextLeft()});$("#toolbar_text_center").click(function(){a.onTextCenter()});$("#toolbar_text_right").click(function(){a.onTextRight()});$("#toolbar_text_top").click(function(){a.onTextTop()});
$("#toolbar_text_middle").click(function(){a.onTextMiddle()});$("#toolbar_text_bottom").click(function(){a.onTextBottom()})};eeGui.prototype.addLineStyleActions=function(){};
eeGui.prototype.addKeyHandlers=function(){var a=EEWeb.app.getGraph(),b=new mxKeyHandler(a);b.getFunction=function(a){return null!=a?mxEvent.isControlDown(a)||mxClient.IS_MAC&&a.metaKey?this.controlKeys[a.keyCode]:this.normalKeys[a.keyCode]:null};var c=EEWeb.app.getProjectHandler(),d=this,e=a.gridSize;b.bindKey(8,function(){a.removeCells()});b.bindKey(33,function(){a.exitGroup()});b.bindKey(34,function(){a.enterGroup()});b.bindKey(36,function(){a.home()});b.bindKey(35,function(){a.refresh()});b.bindKey(37,
function(b){d.onArrowKey(a,-e,0,b.shiftKey)});b.bindKey(38,function(b){d.onArrowKey(a,0,-e,b.shiftKey)});b.bindKey(39,function(b){d.onArrowKey(a,e,0,b.shiftKey)});b.bindKey(40,function(b){d.onArrowKey(a,0,e,b.shiftKey)});b.bindKey(46,function(){a.removeCells();amplify.publish("component-deleted")});b.bindKey(72,function(){EEWeb.eventLog.logEvent("key fliph","");EEWeb.app.getEditor().execute("fliph")});b.bindKey(82,function(){EEWeb.eventLog.logEvent("key rotate","");EEWeb.helper.validDragElement()||
EEWeb.app.getEditor().execute("rotate");amplify.publish(EEWeb.events.ROTATE_SYMBOL)});EEWeb.app.getUtils().isWindowsFirefox()||b.bindControlKey(82,function(){window.location.reload()});b.bindKey(86,function(){EEWeb.eventLog.logEvent("key flipv","");EEWeb.app.getEditor().execute("flipv")});b.bindKey(107,function(){amplify.publish(EEWeb.events.ZOOM_IN,new ALEvent(d.mousePosition))});b.bindKey(109,function(){amplify.publish(EEWeb.events.ZOOM_OUT,new ALEvent(d.mousePosition))});b.bindKey(73,function(){amplify.publish(EEWeb.events.ZOOM_IN,
new ALEvent(d.mousePosition))});b.bindKey(79,function(){amplify.publish(EEWeb.events.ZOOM_OUT,new ALEvent(d.mousePosition))});b.bindKey(70,function(){amplify.publish(EEWeb.events.ZOOM_FIT)});b.bindKey(113,function(){d.onF2Key()});b.bindControlKey(65,function(){EEWeb.eventLog.logEvent("key selectall","");a.selectAllLimited()});b.bindControlKey(89,function(){EEWeb.eventLog.logEvent("key redo","");EEWeb.app.getEditor().redo()});b.bindControlKey(90,function(){EEWeb.eventLog.logEvent("key undo","");EEWeb.app.getEditor().undo()});
b.bindControlKey(88,function(){EEWeb.eventLog.logEvent("key cut","");EEWeb.app.getEditor().execute("cut")});b.bindControlKey(67,function(){EEWeb.eventLog.logEvent("key copy","");EEWeb.app.getEditor().execute("copy")});b.bindControlKey(86,function(){EEWeb.eventLog.logEvent("key paste","");EEWeb.app.getEditor().execute("paste")});b.bindControlKey(71,function(){d.onGroup()});b.bindControlKey(79,function(a){c.onOpen(a.altKey)});b.bindKey(120,function(a){c.doOpen(!0,1)});b.bindKey(118,function(a){c.doOpen(!0,
-1)});b.bindControlKey(83,function(a){c.onSave(a.altKey)});b.bindControlKey(85,function(){d.onUnGroup()});return b};eeGui.prototype.onF2Key=function(){var a=EEWeb.app.getGraph(),b=a.getSelectionCell(),c=!0;null!==b.parent&&b.parent instanceof eeComp&&("undefined"!==typeof eeSrc&&b.parent instanceof eeSrc?"refdes"===b.labelName&&b.parent instanceof eeSupSrc||(b.parent.showProperties(b.labelName),c=!1):(b.parent.showProperties(b.labelName),c=!1));c&&a.startEditingAtCell()};
eeGui.prototype.onArrowKey=function(a,b,c,d){var e=_.filter(a.getSelectionCells(),function(a){return a.isMovable()}),f=EEWeb.app.getUtils().isCellsInGraphBounds(a,e,{x:b,y:c});!_.isEmpty(e)&&f&&(d&&(b*=10,c*=10),a.moveCells(e,b,c))};
eeGui.prototype.makeDraggable=function(a){var b=EEWeb.helper;a.draggable({zIndex:3E3,appendTo:"#schematic",scroll:!1,distance:25,cursorAt:{top:0,left:0},opacity:0.75,addClasses:!1,helper:function(){return b.onDragStart(this)}});a.bind("drag",function(a,d){return b.onDrag(this,a.clientX,a.clientY)});a.bind("dragstop",function(a,d){return b.onDragStop(this,a.clientX,a.clientY)});a.bind("click",function(a,d){return b.onClick(this)});$("#schematic").click()};
eeGui.prototype.initListItems=function(){var a=$(".list_3 li"),b=EEWeb.helper;a.draggable({zIndex:3E3,appendTo:"#schematic",scroll:!1,distance:25,cursorAt:{top:0,left:0},opacity:0.75,addClasses:!1,helper:function(){return b.onDragStart(this)}});a.bind("drag",function(a,d){return b.onDrag(this,a.clientX,a.clientY)});a.bind("dragstop",function(a,d){return b.onDragStop(this,a.clientX,a.clientY)});a.bind("click",function(a,d){return b.onClick(this)})};eeGui.prototype.initSchematicItem=function(){};
eeGui.prototype.initZoomScaleValues=function(){this.zoomScaleValues=this.getZoomScaleValues()};eeGui.prototype.initScrollbarWidthValue=function(){this.scrollbarWidth=this.getScrollbarWidthValue()};eeGui.prototype.zoomIn=function(a){var b=EEWeb.app.getGraph().view.scale;4>b&&(b=Math.round(100*(1<=b?b+0.2:b+0.1))/100,this.zoom(a,b))};
eeGui.prototype.zoomOut=function(a){var b=EEWeb.app.getGraph().view.scale,c=Math.max(this.minZoomScale(),0.25);b>c&&(b=Math.round(100*(1<b?b-0.2:b-0.1))/100,this.zoom(a,b))};
eeGui.prototype.zoom=function(a,b){EEWeb.app.getGraph();var c,d,e,f,g=$("#schematic-wrapper"),h=$("#schematic");e=g.width();f=g.height();c=h.width();d=h.height();var k=g.offset().left,m=g.offset().top,n=g.scrollTop(),p=g.scrollLeft();this.zoomTo(b);var q=h.width(),h=h.height();void 0===a||_.isEmpty(a)?(e=e/2+k,f=f/2+m):(e=a.pageX?a.pageX:a.originalEvent.pageX,f=a.pageY?a.pageY:a.originalEvent.pageY);c=q*(e-k+p)/c;d=h*(f-m+n)/d;g.scrollLeft(c-e+k);g.scrollTop(d-f+m)};
eeGui.prototype.gridInfo=function(){return"scale: "+EEWeb.app.graph.view.scale+" | scrollLeft: "+$("#schematic-wrapper").scrollLeft()+" | scrollTop: "+$("#schematic-wrapper").scrollTop()+" | offsetLeft: "+$("#schematic-wrapper").offset().left+" | offsetTop: "+$("#schematic-wrapper").offset().top+" | schematicWidth: "+$("#schematic-wrapper").width()+" | schematicHeight: "+$("#schematic-wrapper").height()+" | gridWidth: "+$("#schematic-wrapper div.zoom-grid:visible").width()+" | gridHeight: "+$("#schematic-wrapper div.zoom-grid:visible").height()+
" | gridOffsetLeft: "+$("#schematic-wrapper div.zoom-grid:visible").offset().left+" | gridOffsetTop: "+$("#schematic-wrapper div.zoom-grid:visible").offset().top};eeGui.prototype.zoomTo=function(a){EEWeb.app.getGraph().zoomTo(a,!1);this.zoomScale()};eeGui.prototype.zoomPanTo=function(a,b){EEWeb.app.getGraph().setPosScale({scale:a,pos:b});this.zoomScale()};eeGui.prototype.resetZoom=function(){EEWeb.app.getGraph().zoomActual();this.zoomScale()};
eeGui.prototype.zoomScale=function(){var a=EEWeb.app.getGraph(),b=a.getView().scale,c=Math.round(100*b),d=$(".zoom-grid"),c=$(".grid-"+c);d.hide();c.show();d=$("#schematic");d.attr("zoomScale",b);var e=a.pageFormat.width*b,f=a.pageFormat.height*b;c.css({width:e,height:f});d.css({width:e,height:f});a.maximumGraphBounds=new mxRectangle(0,0,e/b,f/b);0.5<a.view.scale&&$("#outlinecontainer").show();a.selectionCellsHandler.refresh()};eeGui.prototype.onProjectLoad=function(a){this.setGuiState("init")};
eeGui.prototype.onProjectLoadComplete=function(a){this.resetZoom()};eeGui.prototype.onProjectNameChange=function(a){if("true"===eeServerData.adminUser&&"undefined"!==typeof a.lastindex){var b=a.totalprojects,c=a.lastindex;$("#file_header .title").text("Index "+c+" of "+b+":"+a.name)}else $("#file_header .title").text(a.name)};eeGui.prototype.onProjectModified=function(a){a.modified?$("#file_header .unsaved").show():$("#file_header .unsaved").hide()};eeGui.prototype.onProjectNew=function(a){};
eeGui.prototype.scalePages=function(){};eeGui.prototype.onChange=function(a,b){for(var c=b.getProperty("edit").changes,d=0,e=c.length;d<e;d++){var f=c[d];if(f instanceof mxChildChange)if("group"==f.child.style)this.onGroupChange(f.child,f.parent,f.previous);else if(f.child instanceof eeLabel)this.onLabelChange(f.child,f.parent,f.previous);else if(f.child instanceof eeComp){var g=b.getProperty("edit");this.onComponentChange(f.child,f.parent,f.previous,g&&!0===g.redone)}}};
eeGui.prototype.onLabelChange=function(a,b,c){null==b?null!=c&&c instanceof eeComp&&c.removeLabel(a):null==c?b instanceof eeComp&&b.addLabel(a):b.id!=c.id&&(c instanceof eeComp&&c.removeLabel(a),b instanceof eeComp&&b.addLabel(a))};eeGui.prototype.onComponentChange=function(a,b,c,d){null===b?null!==c&&amplify.publish(EEWeb.events.COMPONENT_DELETED,new ALEvent({comp:a,redo:!0===d,newcomp:!1})):null===c&&amplify.publish(EEWeb.events.COMPONENT_ADDED,new ALEvent({comp:a,redo:!0===d,newcomp:!1}))};
eeGui.prototype.onGroupChange=function(a,b,c){if(a.children)for(var d=0,e=a.children.length;d<e;d++){var f=a.children[d];if(f instanceof eeComp)this.onComponentChange(f,b,c,!1);else if("group"==f.style)this.onGroupChange(f,b,c)}};eeGui.prototype.clearTimeout=function(a){};
eeGui.prototype.repositionDialogs=function(){AspenLabs.ieVersion&&8>AspenLabs.ieVersion?$(".ui-dialog-content:visible").dialog("close").dialog("open"):$(".ui-dialog-content").filter(function(a){return!$(this).hasClass("sidebar")}).dialog("option","position","center")};eeGui.prototype.onUserUpdated=function(a){this.setLoggedIn(a.bLoggedIn)};eeGui.prototype.onDialogClose=function(){$(EEWeb.app.getGraph().container).attr("tabindex",-1).click()};
eeGui.prototype.onGroup=function(){var a=EEWeb.app.getGraph(),b=a.getSelectionCells(),b=_.filter(b,function(a){return a.isCopiable()});a.setSelectionCell(a.groupCells(null,10,b))};eeGui.prototype.onUnGroup=function(){var a=EEWeb.app.getGraph(),b=a.getSelectionCells(),c=!0;_.each(b,function(a){a.style&&0>a.style.indexOf("group")&&(c=!1)});if(c){a.model.beginUpdate();try{a.removeEmptyGroupOnUngroup(b),a.setSelectionCells(a.ungroupCells())}finally{a.model.endUpdate()}}else EEWeb.app.getUtils().show_alert(l("alertungroupselect_grouponly"))};
eeGui.prototype.onAlignCells=function(a){var b=EEWeb.app.getGraph();b.getModel().beginUpdate();try{var c=b.getSelectionCells(),d={};_.each(c,function(a){d[a.id]={x:-a.geometry.x,y:-a.geometry.y}});b.alignCells(a);_.each(c,function(a){d[a.id].x+=a.geometry.x;d[a.id].y+=a.geometry.y})}finally{b.getModel().endUpdate()}};eeGui.prototype.onFill=function(){EEWeb.app.getGraph().getSelectionCells();this.editColorStyle=mxConstants.STYLE_FILLCOLOR;$("#jPicker").dialog("open")};
eeGui.prototype.onGradient=function(){this.editColorStyle=mxConstants.STYLE_GRADIENTCOLOR;$("#jPicker").dialog("open")};eeGui.prototype.onStroke=function(){this.editColorStyle=mxConstants.STYLE_STROKECOLOR;$("#jPicker").dialog("open")};eeGui.prototype.onLineStyle=function(){};eeGui.prototype.onBold=function(){var a=EEWeb.app.getGraph();a.cellEditor.isContentEditing()?document.execCommand("bold"):a.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)};
eeGui.prototype.onItalic=function(){var a=EEWeb.app.getGraph();a.cellEditor.isContentEditing()?document.execCommand("italic"):a.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)};eeGui.prototype.onUnderline=function(){var a=EEWeb.app.getGraph();a.cellEditor.isContentEditing()?document.execCommand("underline"):a.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE)};
eeGui.prototype.onBigger=function(){var a=EEWeb.app.getGraph();if(a.cellEditor.isContentEditing())this.increaseFontSize();else{a.getModel().beginUpdate();try{var b=a.getSelectionCells();_.each(b,function(b){var d=12,e=a.getView().getState(b);null!=e&&(d=parseInt(e.style[mxConstants.STYLE_FONTSIZE])||d);d+=2;null!=d&&mxUtils.setCellStyles(a.getModel(),[b],mxConstants.STYLE_FONTSIZE,d)});a.refresh()}finally{a.getModel().endUpdate()}}};
eeGui.prototype.onSmaller=function(){var a=EEWeb.app.getGraph();if(a.cellEditor.isContentEditing())this.decreaseFontSize();else{a.getModel().beginUpdate();try{var b=a.getSelectionCells();_.each(b,function(b){var d=12,e=a.getView().getState(b);null!=e&&(d=parseInt(e.style[mxConstants.STYLE_FONTSIZE])||d);8<=d&&(d-=2);null!=d&&mxUtils.setCellStyles(a.getModel(),[b],mxConstants.STYLE_FONTSIZE,d)});a.refresh()}finally{a.getModel().endUpdate()}}};
eeGui.prototype.increaseFontSize=function(){var a=(100*this.getFontSizeInEm()+10)/100;this.updateFontSize(a)};eeGui.prototype.decreaseFontSize=function(){var a=(100*this.getFontSizeInEm()-10)/100;this.updateFontSize(a)};
eeGui.prototype.getFontSizeInEm=function(){var a=EEWeb.app.getGraph(),b=window.getSelection?window.getSelection():document.selection.createRange(),b=AspenLabs.ieVersion&&8>=AspenLabs.ieVersion?b.parentElement():b.focusNode.parentElement,b=$(b).css("font-size").replace("px",""),a=$(a.cellEditor.text2).css("font-size").replace("px","");return Math.round(100*b/a)/100};
eeGui.prototype.updateFontSize=function(a){var b=EEWeb.app.getGraph();document.execCommand("fontSize",!1,"3");for(var b=b.cellEditor.text2.getElementsByTagName("font"),c=0;c<b.length;c++)if("3"==b[c].getAttribute("size")){b[c].removeAttribute("size");b[c].style.fontSize=a+"em";break}};eeGui.prototype.onColor=function(){EEWeb.app.getGraph().cellEditor.isContentEditing()||(this.editColorStyle=mxConstants.STYLE_FONTCOLOR);$("#jPicker").dialog("open")};
eeGui.prototype.onTextLeft=function(){var a=EEWeb.app.getGraph();if(a.cellEditor.isContentEditing())document.execCommand("justifyLeft");else{var b=a.getSelectionCells();a.model.beginUpdate();_.each(b,function(b){b.allowHtmlLabels?a.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT):(a.setCellStyles(mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_LEFT,[b]),a.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT,[b]))});a.model.endUpdate()}};
eeGui.prototype.onTextCenter=function(){var a=EEWeb.app.getGraph();a.cellEditor.isContentEditing()?document.execCommand("justifyCenter"):(a.model.beginUpdate(),a.setCellStyles(mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),a.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),a.model.endUpdate())};
eeGui.prototype.onTextRight=function(){var a=EEWeb.app.getGraph();if(a.cellEditor.isContentEditing())document.execCommand("justifyRight");else{var b=a.getSelectionCells();a.model.beginUpdate();_.each(b,function(b){b.allowHtmlLabels?a.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT):(a.setCellStyles(mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_RIGHT,[b]),a.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT,[b]))});a.model.endUpdate()}};
eeGui.prototype.onTextTop=function(){var a=EEWeb.app.getGraph();if(!a.cellEditor.isContentEditing()){var b=a.getSelectionCells();_.each(b,function(b){a.model.beginUpdate();b.allowHtmlLabels?a.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP):(a.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_TOP),a.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM));a.model.endUpdate()})}};
eeGui.prototype.onTextMiddle=function(){var a=EEWeb.app.getGraph();a.cellEditor.isContentEditing()||(a.model.beginUpdate(),a.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),a.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),a.model.endUpdate())};
eeGui.prototype.onTextBottom=function(){var a=EEWeb.app.getGraph();if(!a.cellEditor.isContentEditing()){var b=a.getSelectionCells();_.each(b,function(b){a.model.beginUpdate();b.allowHtmlLabels?a.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM):(a.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_BOTTOM),a.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP));a.model.endUpdate()})}};
eeGui.prototype.onEdit=function(a,b,c){var d=EEWeb.app.getGraph();d.isEnabled()&&d.isCellEditable(b)&&(b instanceof eeEdge||b instanceof eeLabel?b.startEditing(c.getProperty("event")):"showProperties"in b?(b.showProperties(a),d.tooltipHandler.hide()):(c=c.getProperties().event,a=c.clientX,c=c.clientY-50,d.tooltipHandler.show(l("shift_enter_newline"),a,c),d.startEditingAtCell(b)))};eeGui.prototype.filterFlippableCells=function(a,b){return _.filter(b,function(b){return b&&a.isCellVisible(b)&&b.isFlippable()})};
eeGui.prototype.flipCells=function(a,b,c){var d=EEWeb.app.getGraph();b=d.getSelectionCells();var e=d.getModel();b=this.filterFlippableCells(d,b);_.each(b,function(b){var g=d.getView().getState(b,!0).style[a]?"0":"1",h=e.getStyle(b);h&&h.match(/^group/)?EEWeb.app.getUtils().show_alert(l("alertgroupscantflip")):(h=mxUtils.setStyle(h,a,g),e.setStyle(b,h),_.each(b.children,c))});d.refresh()};
eeGui.prototype.onFlipHorizontal=function(){var a=EEWeb.app.getGraph();EEWeb.eventLog.logEvent("eeGui.onFlipH","");a.getModel().beginUpdate();try{var b=a.getModel(),c=a.getSelectionCells(),d=this.filterFlippableCells(a,c);this.flipCells(mxConstants.STYLE_STENCIL_FLIPH_PATCH,d,function(a){var c=a.getGeometry().clone();c.offset.x=-1*c.offset.x-c.width;c.x=1-c.x;b.setGeometry(a,c)});a.refresh()}finally{a.getModel().endUpdate()}};
eeGui.prototype.onFlipVertical=function(){var a=EEWeb.app.getGraph();EEWeb.eventLog.logEvent("eeGui.onFlipV","");a.getModel().beginUpdate();try{var b=a.getModel(),c=a.getSelectionCells(),d=this.filterFlippableCells(c);this.flipCells(mxConstants.STYLE_STENCIL_FLIPV_PATCH,d,function(a){var c=a.getGeometry().clone();c.offset.y=-1*c.offset.y-c.height;c.y=1-c.y;b.setGeometry(a,c)});a.refresh()}finally{a.getModel().endUpdate()}};
eeGui.prototype.onRotate=function(a){var b=EEWeb.app.getGraph();EEWeb.eventLog.logEvent("eeGui.onRotate","");b.getModel().beginUpdate();try{var c=a?[a]:b.getSelectionCells(),d=_.filter(c,function(a){return a&&b.isCellVisible(a)&&!(a instanceof eeCusComp||a.parent instanceof eeCusComp||a instanceof eeLabel)});_.each(d,function(a){this.onRotateCell(a)},this);b.refresh()}finally{b.getModel().endUpdate()}};
eeGui.prototype.onRotateCell=function(a){var b=EEWeb.helper.getPreview()||EEWeb.app.getGraph(),c=b.getModel(),d=b.getModel().getStyle(a);if(d&&d.match(/^group/))EEWeb.app.getUtils().show_alert(l("alertgroupnot_rotate"));else{var d=b.view.getState(a,!0),e=b.getCellGeometry(a),e=e.clone(),f=e.width;e.width=e.height;e.height=f;e.angle="angle"in e?(e.angle+90)%360:90;c.setGeometry(a,e);e=d.style[mxConstants.STYLE_DIRECTION]||"east";f=["east","south","west","north"];e=f[(_.indexOf(f,e)+1)%4];mxUtils.setCellStyles(c,
[a],mxConstants.STYLE_DIRECTION,e);e=d.style[mxConstants.STYLE_STENCIL_FLIPH_PATCH]||"0";mxUtils.setCellStyles(c,[a],mxConstants.STYLE_STENCIL_FLIPH_PATCH,d.style[mxConstants.STYLE_STENCIL_FLIPV_PATCH]||"0");mxUtils.setCellStyles(c,[a],mxConstants.STYLE_STENCIL_FLIPV_PATCH,e);c=_.filter(a.children,function(a){return a instanceof eePin||a.style&&a.style.match(/^pin-label/)?!0:!1});_.each(c,function(a){var c=a.getGeometry().clone(),d=a.style||"";d&&d.match(/^pin-label-top/)?a.style=d.replace("pin-label-top",
"pin-label-left"):d&&d.match(/^pin-label-left/)&&(a.style=d.replace("pin-label-left","pin-label-top"));var d=c.offset.x+4,e=c.offset.y+4;c.offset.x=-1*e-4;c.offset.y=d-4;d=1-c.y;e=c.x;c.x=d;c.y=e;b.getModel().setGeometry(a,c)});a=_.filter(a.children,function(a){return a instanceof eeLabel});_.each(a,function(a){a.repositionComponentLabel()})}};eeGui.prototype.onTabClick=function(a){EEWeb.app.getUtils().show_alert("onTabClick must be overridden!!")};
eeGui.prototype.onHelp=function(){$("#help").dialog({title:l("schemeit_help"),resizable:!1,modal:!0,draggable:!1,dialogClass:"graph-popup-dialog help-dialog",width:760,height:435,close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}});var a=this,b=$("#help_nav a.hot"),c=$("#help_nav li:first-child a");0!=b.length&&(c=b);$("#help_content").load(c.attr("href"),function(){a.loadHelpImages()})};
eeGui.prototype.onHelpItem=function(a){var b=this;$("#help_content").load(a.attr("href"),function(){b.loadHelpImages()});$("#help_nav a").toggleClass("hot",!1);a.toggleClass("hot",!0)};eeGui.prototype.loadHelpImages=function(){};eeGui.prototype.onTabCloseClick=function(a){EEWeb.app.getUtils().show_alert("onTabClick must be overridden!!")};eeGui.prototype.onDigikeyBarHide=function(a){this.hideDigikeyBar()};eeGui.prototype.onDigikeyBarShow=function(a){this.showDigikeyBar()};
eeGui.prototype.getPinDirection=function(a,b){var c=EEWeb.app.getGraph();null==b&&(b=c.getCellStyle(a));var d=b.portConstraint,e=b.pinDirection?b.pinDirection:a.direction?a.direction:null,c=c.getCellStyle(a.parent);null==e&&(e=d&&"vertical"==d?"north":"east");var d=c[mxConstants.STYLE_STENCIL_FLIPV_PATCH]?"1":"0",f=c[mxConstants.STYLE_STENCIL_FLIPH_PATCH]?"1":"0",c=c[mxConstants.STYLE_DIRECTION]||"east",g=e;switch(e){case "east":"1"==f&&(g="west");break;case "south":"1"==d&&(g="north");break;case "west":"1"==
f&&(g="east");break;case "north":"1"==d&&(g="south")}e=["east","south","west","north"];d=_.indexOf(e,g);switch(c){case "east":rot=0;break;case "south":rot=1;break;case "west":rot=2;break;case "north":rot=3}d=(d+rot)%4;return g=e[d]};
eeGui.prototype.getInitialOrientation=function(a,b){var c=EEWeb.app.getGraph(),d=!0;if(null!=b&&a.view.graph.model.isEdge(b.cell))d="horizontal"==a.style.sourceConstraint;else if(null!=b){var d="vertical"!=b.style.portConstraint,e=b.style[mxConstants.STYLE_DIRECTION]?b.style[mxConstants.STYLE_DIRECTION]:b.cell.direction?b.cell.direction:null;c.view.getState(b.cell.parent);if("east"==e||"west"==e)d=!d}return d};
eeGui.prototype.getPointForEvent=function(a){var b=EEWeb.app.getGraph();a=mxUtils.convertPoint(b.container,a.clientX,a.clientY);var c=b.view.scale,d=b.view.translate;a.x=b.snap(a.x/c-d.x);a.y=b.snap(a.y/c-d.y);return a};
eeGui.prototype.getSchematicPoint=function(a){var b=$("#schematic-wrapper"),c=b.offset(),d=b.width(),b=b.height(),c=new mxRectangle(c.left,c.top,d,b);if(!mxUtils.contains(c,a.clientX,a.clientY))return null;a=this.getPointForEvent(a);c=EEWeb.app.getGraph();return a.x>c.pageFormat.width||a.y>c.pageFormat.height?null:a};
eeGui.prototype.setPageCount=function(a,b){var c=this;$("#pages li").remove();_.each(b,function(b,c){var d=$('<li><span class="editable">'+b+"</span></li>");if(1<=a){var h=$("<button type='button' class='pagemnu'></button>");d.append(h);h.button({icons:{primary:"ui-icon-triangle-1-s"},text:!1});h.show()}d.prop("page",c);d.addClass("page_tab");d.appendTo("#pages")});var d=$("#pages li");d.eq(0).addClass("page_hot");d.eq(0).addClass("first_page");d.eq(a-1).addClass("last_page");a<eeConstants.MAX_PAGE_CNT&&
$("<li>+</li>").appendTo("#pages").addClass("page_insert");$("#pages li span.editable").dblclick(function(){$("#pages li.page_insert").addClass("iseditingpage")});$("#pages li span.editable").editable(function(a,b){var d=$(this).parent().index();amplify.publish(EEWeb.events.PAGE_NAME_CHANGE,new ALEvent({index:d,name:a}));$("#pages li.page_hot button").show();$("#pages li.page_insert").removeClass("iseditingpage");setTimeout(function(){c.resizePageDiv()},0);return a},{event:"dblclick",select:!0,width:"100px",
maxlength:15,tooltip:l("dblclick_page_name"),onblur:"submit",onreset:function(a,b){$("#pages li.page_hot button").show();$("#pages li.page_insert").removeClass("iseditingpage")}});$("#pages").unbind(".pageedit");$("#pages").on("focus.pageedit","input",function(a){$("#pages li.page_hot button").hide();c.resizePageDiv()});this.resizePageDiv()};eeGui.prototype.resizePageDiv=function(){};
eeGui.prototype.addPageActions=function(){var a=null,b=this,c=new mxPopupMenu(function(c,e,f){b.createPagePopupMenu(c,e,f,a)});c.showMenu=function(){9<=document.documentMode&&(this.div.style.filter="none");document.body.appendChild(this.div);mxUtils.fit(this.div);var a=parseInt(this.div.offsetHeight,10),b=parseInt(this.div.style.top,10);this.div.style.top=b-(a+10)+"px"};$("#pages").on("click.pages","button",function(b){if(c.isMenuShowing())c.hideMenu(),$(document).unbind(".pages");else{var e=$(this);
a=$(this).parent().index();var f=e.offset();e.parent().offset();c.popup(f.left,f.top);b.stopPropagation();$(document).bind("click.pages",function(a){EEWeb.log.info("Click on document, closing popup. Target:"+$(a.target).attr("id"));c.hideMenu();$(document).unbind(".pages")})}})};
eeGui.prototype.createPagePopupMenu=function(a,b,c,d){b=EEBasepath+"img/web20px/";a.addItem(l("edit_page_name"),b+"edit.png",function(){$("#pages li").eq(d).find("span").trigger("dblclick");$(document).unbind(".pages")});2<$("#pages li").length&&(a.addItem(l("delete_page"),b+"delete.png",function(){amplify.publish(EEWeb.events.PAGE_DELETE,new ALEvent({index:d}))}),$(document).unbind(".pages"))};
eeGui.prototype.setCurrentPage=function(a){var b=$("#pages li");$("#pages li.page_hot button").show();b.removeClass("page_hot");b.eq(a).addClass("page_hot");b.eq(a).is(":visible")||$("#pages .page_more").addClass("page_hot")};eeGui.prototype.setUnsavedWarning=function(a){this.unsavedwarning=a?l("unsaved_small_caps"):l("work_will_not_be_saved")};eeGui.prototype.notifyProjectParserError=function(){EEWeb.app.getUtils().show_alert(l("parser_error_message"))};
eeGui.prototype.scrollLeft=function(a){setTimeout(function(){$(document).scrollLeft(a)},10)};eeGui.prototype.isGridVisible=function(){return this.bIsGridVisible};eeGui.prototype.toggleGrid=function(){this.bIsGridVisible=!this.bIsGridVisible;this.setGridVisibility(this.bIsGridVisible)};eeGui.prototype.setGridVisibility=function(a){a?$("#schematic-wrapper div").removeClass("hide-grid"):$("#schematic-wrapper div").addClass("hide-grid")};
eeGui.prototype.zoomToFit=function(){var a=EEWeb.app.graph,b=a.getView(),c=b.getGraphBounds(),d=$("#schematic-wrapper"),e=d.width(),d=d.height(),f=this.scrollbarWidth,g=b.getScale(),b=this.getZoomScaleToFitInView({width:e-40,height:d-40},{width:c.width/g,height:c.height/g}),g=b/g,c=new mxPoint(Math.floor(c.x*g-(e-f-c.width*g)/2),Math.floor(c.y*g-(d-f-c.height*g)/2));a.setPosScale({scale:b,pos:c});this.zoomScale();a.selectionCellsHandler.refresh()};
eeGui.prototype.getZoomScaleToFitInView=function(a,b){return this.getNearestValue(this.zoomScaleValues,Math.min(a.width/b.width,a.height/b.height),!0)};eeGui.prototype.getZoomScaleValues=function(){for(var a=[],b=null,b=0.2;1>b;b=Math.round(10*(b+0.1))/10)a.push(b);for(b=1;4>=b;b=Math.round(10*(b+0.2))/10)a.push(b);return a};
eeGui.prototype.getNearestValue=function(a,b,c){var d=(c="undefined"!==typeof c?c:!1)?_.min(a):_.max(a);c?_.each(a,function(a){d=a<=b&&d<a?a:d}):_.each(a,function(a){d=a>=b&&d>a?a:d});return d};
eeGui.prototype.getScrollbarWidthValue=function(){var a=$('<div style="width:100%;height:200px;">test</div>'),b=$('<div style="width:200px;height:150px;position:absolute;top:0;left:0;visibility:hidden;overflow:hidden;"></div>').append(a);$("body").append(b[0]);a=a[0].offsetWidth;b.css("overflow","scroll");var c=b[0].clientWidth;b.remove();return a-c};function eeEditor(a){mxEditor.apply(this,arguments)}mxUtils.extend(eeEditor,mxEditor);
eeEditor.prototype.createGraph=function(){var a=new eeGraphModel,a=new eeGraph(null,a,this.graphRenderHint);return this.initNewGraph(a)};
eeEditor.prototype.initNewGraph=function(a){a.setTooltips(!0);a.setPanning(!1);this.installDblClickHandler(a);this.installUndoHandler(a);this.installDrillHandler(a);this.installChangeHandler(a);this.installInsertHandler(a);a.connectionHandler&&(a.connectionHandler.factoryMethod=mxUtils.bind(this,function(a,c){return this.createEdge(a,c)}));this.createSwimlaneManager(a);this.createLayoutManager(a);return a};
eeEditor.prototype.createEdge=function(a,b){var c=null;if(null!=this.defaultEdge)c=this.graph.getModel().cloneCell(this.defaultEdge);else{c=this.graph.isDiagramConnection(a,b)?new eeConnection(""):new eeEdge("");c.setEdge(!0);var d=new mxGeometry;d.relative=!0;c.setGeometry(d)}d=this.getEdgeStyle();null!=d&&c.setStyle(d);return c};eeEditor.prototype.installDblClickHandler=function(a){var b=this;a.addListener(mxEvent.DOUBLE_CLICK,function(a,d){b.onDoubleClick(a,d)})};
eeEditor.prototype.onDoubleClick=function(a,b){var c=b.getProperty("cell");null!=c&&EEWeb.app.getGraph().isEnabled()&&null!=this.dblClickAction&&(this.execute(this.dblClickAction,c,b),b.consume())};eeEditor.prototype.resetView=function(){var a=this.graph;a.view.destroy();a.view=a.createGraphView();a.view.init();this.rubberband&&(this.rubberband.destroy(),this.rubberband=new mxRubberband(a));a.view.revalidate()};
function eeGraph(a,b,c,d){mxGraph.apply(this,arguments);var e=new mxMultiplicity(!0,null,null,null,0,1,null,"Source can only have 0 or 1 connections.",null);e.checkType=function(a,b,c,d,e){return!0};e.checkX=function(a,b,c,d,e,f){return"This is bad!"};var f=new mxMultiplicity(!1,null,null,null,0,1,null,"Target can only have 0 or 1 connections.",null);f.checkX=e.check;f.checkType=e.checkType}mxUtils.extend(eeGraph,mxGraph);eeGraph.prototype.resetEdgesOnConnect=!1;eeGraph.prototype.eeLabelHandler=null;
eeGraph.prototype.eePinHandler=null;eeGraph.prototype.componentsSelectedCount=0;eeGraph.prototype.edgesSelectedCount=0;
eeGraph.prototype.addStyles=function(){var a=mxUtils.load(EEBasepath+"resources/default-style.xml").getDocumentElement();(new mxCodec(a.ownerDocument)).decode(a,this.getStylesheet());a={};a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_FONTSIZE]="12";a[mxConstants.STYLE_FONTSTYLE]=mxConstants.FONT_BOLD;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_LEFT;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=
mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="0";this.getStylesheet().putCellStyle("component",a);a={};a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;a[mxConstants.STYLE_OPACITY]=0;a[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_FONTSIZE]="12";a[mxConstants.STYLE_FILLCOLOR]="#dae2f2";a[mxConstants.STYLE_FONTSTYLE]=mxConstants.FONT_BOLD;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;
a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="0";a[mxConstants.STYLE_AUTOSIZE]="1";this.getStylesheet().putCellStyle("complabel",a);a={};a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;a[mxConstants.STYLE_OPACITY]=0;a[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;a[mxConstants.STYLE_FONTCOLOR]=
"#000000";a[mxConstants.STYLE_FONTSIZE]="12";a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_LEFT;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="0";a[mxConstants.STYLE_AUTOSIZE]="1";this.getStylesheet().putCellStyle("edgelabel",a);a={};a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_FONTSIZE]=
"12";a[mxConstants.STYLE_FONTSTYLE]=mxConstants.FONT_BOLD;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_LEFT;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="0";a[mxConstants.STYLE_NOLABEL]="1";this.getStylesheet().putCellStyle("net",a);a={};a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;
a[mxConstants.STYLE_OPACITY]=0;a[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_FONTSIZE]="12";a[mxConstants.STYLE_FILLCOLOR]="#dae2f2";a[mxConstants.STYLE_FONTSTYLE]=mxConstants.FONT_BOLD;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;
a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="0";a[mxConstants.STYLE_AUTOSIZE]="1";this.getStylesheet().putCellStyle("netlabel",a);a={};a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_LEFT;a[mxConstants.STYLE_FILLCOLOR]="none";a[mxConstants.STYLE_GRADIENTCOLOR]="none";a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_STROKECOLOR]="none";a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="0";a.selectable="0";this.getStylesheet().putCellStyle("component-label",
a);a={};a[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_IMAGE;a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_FONTSIZE]="12";a[mxConstants.STYLE_FONTSTYLE]=mxConstants.FONT_BOLD;a[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_LEFT;a[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_CENTER;a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=mxConstants.ALIGN_MIDDLE;a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_RESIZABLE]="1";
this.getStylesheet().putCellStyle("dkpart",a);a={};a[mxConstants.STYLE_FILLCOLOR]="none";a[mxConstants.STYLE_GRADIENTCOLOR]="none";a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_STROKECOLOR]="none";a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_VERTICAL_LABEL_POSITION]=mxConstants.ALIGN_TOP;this.getStylesheet().putCellStyle("pin-label-top",a);a={};a[mxConstants.STYLE_FILLCOLOR]="none";a[mxConstants.STYLE_GRADIENTCOLOR]="none";a[mxConstants.STYLE_FONTCOLOR]="#000000";a[mxConstants.STYLE_STROKECOLOR]=
"none";a[mxConstants.STYLE_STROKEWIDTH]="0";a[mxConstants.STYLE_LABEL_POSITION]=mxConstants.ALIGN_LEFT;this.getStylesheet().putCellStyle("pin-label-left",a);a=this.getStylesheet().getDefaultEdgeStyle();a[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR]="#FFFFFF";a[mxConstants.STYLE_STROKEWIDTH]="2";a[mxConstants.STYLE_STROKECOLOR]="#000000";a[mxConstants.STYLE_ROUNDED]=!1;a[mxConstants.STYLE_EDGE]="wireEdgeStyle";a[mxConstants.STYLE_STARTSIZE]=4;a[mxConstants.STYLE_ENDSIZE]=4;delete a.endArrow;this.getStylesheet().putDefaultEdgeStyle(a)};
eeGraph.prototype.createHandlers=function(){this.tooltipHandler=this.createTooltipHandler();this.tooltipHandler.setEnabled(!1);this.panningHandler=this.createPanningHandler();this.panningHandler.panningEnabled=!0;this.panningHandler.useLeftButtonForPanning=!1;this.useScrollbarsForPanning=!0;this.selectionCellsHandler=this.createSelectionCellsHandler();this.connectionHandler=this.createConnectionHandler();this.connectionHandler.setEnabled(!1);this.beforeCreateGraphHandler();this.graphHandler=this.createGraphHandler();
this.graphHandler.scrollOnMove=!1;this.afterCreateGraphHandler();this.popupMenuHandler=this.createPopupMenuHandler()};eeGraph.prototype.beforeCreateGraphHandler=function(){this.eeLabelHandler=new eeLabelHandler(this)};eeGraph.prototype.afterCreateGraphHandler=function(){this.eeLabelHandler.setmxHandler(this.graphHandler)};eeGraph.prototype.createConnectionHandler=function(){return new eeConnectionHandler(this)};eeGraph.prototype.createGraphHandler=function(){return new eeGraphHandler(this)};
eeGraph.prototype.createPanningHandler=function(){return new eePanningHandler(this,!1)};eeGraph.prototype.createPopupMenuHandler=function(){return new mxPopupMenuHandler(this,mxUtils.bind(this,function(a,b,c){if(mxEvent.isRightMouseButton(c))return this.createPopupMenu(this,a,b,c)}))};eeGraph.prototype.createCellEditor=function(){return new eeCellEditor(this)};
eeGraph.prototype.getAllConnectionConstraints=function(a){var b=null!=a?this.getCellGeometry(a.cell):null;if(null!=b&&!b.relative&&this.getModel().isVertex(a.cell)&&0==this.getModel().getChildCount(a.cell)&&(a=a.cell,"ports"in a)){for(var b=[],c=0;c<a.ports.length;c++){var d=a.ports[c],d=new mxConnectionConstraint(new mxPoint((d.offset.x+4)/a.geometry.width,(d.offset.y+4)/a.geometry.height),!0);b.push(d)}return b}return null};
eeGraph.prototype.isCellSelectable=function(a){var b=this.view.getState(a),b=null!=b?b.style:this.getCellStyle(a);(b=this.isCellsSelectable()&&!this.isCellLocked(a)&&0!=b.selectable)&&this.trackSelection(a,!0);return b};eeGraph.prototype.trackSelection=function(a,b){a&&a.isEdge()&&this.edgeInSelection(b);a&&!a.isEdge()&&!a.isASmartPin()&&a.isCopiable()&&this.componentInSelection(b)};
eeGraph.prototype.edgeInSelection=function(a){"undefined"!==typeof a&&"null"!==typeof a&&(this.edgesSelectedCount=a?this.edgesSelectedCount+1:this.edgesSelectedCount-1);return 0<this.edgesSelectedCount};eeGraph.prototype.componentInSelection=function(a){"undefined"!==typeof a&&"null"!==typeof a&&(this.componentsSelectedCount=a?this.componentsSelectedCount+1:this.componentsSelectedCount-1);return 0<this.componentsSelectedCount};
eeGraph.prototype.clearSelection=function(){this.resetSelectionCounter();return mxGraph.prototype.clearSelection.apply(this,arguments)};eeGraph.prototype.setSelectionCell=function(a){this.resetSelectionCounter();return mxGraph.prototype.setSelectionCell.apply(this,arguments)};eeGraph.prototype.setSelectionCells=function(a){this.resetSelectionCounter();return mxGraph.prototype.setSelectionCells.apply(this,arguments)};
eeGraph.prototype.removeSelectionCell=function(a){this.trackSelection(a,!1);return mxGraph.prototype.removeSelectionCell.apply(this,arguments)};eeGraph.prototype.cellsRemoved=function(a){this.resetSelectionCounter();return mxGraph.prototype.cellsRemoved.apply(this,arguments)};eeGraph.prototype.resetSelectionCounter=function(){this.componentsSelectedCount=this.edgesSelectedCount=0};
eeGraph.prototype.getSelectionStats=function(){var a={};a.edges=this.edgesSelectedCount;a.components=this.componentsSelectedCount;return a};eeGraph.prototype.createGroupCell=function(){var a=mxGraph.prototype.createGroupCell.apply(this,arguments);a.setStyle("group");return a};eeGraph.prototype.removeEmptyGroupOnUngroup=function(a){if(null!=a){var b=this;a=_.filter(a,function(a){return a.style&&-1<a.style.indexOf("group")&&0==b.model.getChildCount(a)});this.removeCells(a)}};
eeGraph.prototype.stopEditing=function(a){null!=this.cellEditor?this.cellEditor.stopEditing(a):(EEWeb.eventLog.logError("Javascript error: stopEditing is null","eeGraph.prototype.stopEditing","533"),EEWeb.log.info("stopEditing called when null."))};eeGraph.prototype.getTooltipForCell=function(a){var b="";this.model.isEdge(a)&&(b="click tip to move");return b};
eeGraph.prototype.getPosScale=function(){var a={scale:this.view.scale,pos:new mxPoint(0,0)},b=$("#schematic-wrapper");a.pos.x=b.scrollLeft();a.pos.y=b.scrollTop();return a};eeGraph.prototype.setPosScale=function(a){this.zoomTo(a.scale,!1);var b=$("#schematic-wrapper");b.scrollLeft(a.pos.x);b.scrollTop(a.pos.y)};eeGraph.prototype.createCellRenderer=function(){return new eeCellRenderer};
eeGraph.prototype.getSelectionCellsForChanges=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(d.constructor!=mxRootChange){var e=null;d.constructor==mxChildChange&&null==d.previous?e=d.child:null!=d.cell&&d.cell instanceof mxCell&&(e=d.cell);null!=e&&0>mxUtils.indexOf(b,e)&&b.push(e)}}return this.getModel().getTopmostCells(b)};
eeGraph.prototype.hasAssignableSelectedObject=function(){var a=this.getSelectionCells();EEWeb.eventLog.logEvent("eeGraph.hasAssignableSelectedObject",a?a.length:null);return a&&1==a.length&&"isAssignable"in a[0]&&a[0].isAssignable()};eeGraph.prototype.createVertex=function(a,b,c,d,e,f,g,h){EEWeb.eventLog.logEvent("eeGraph.createVertex","");a=new mxGeometry(d,e,f,g);c=new eeCell(c,a,h,null);c.setId(b);c.setVertex(!0);c.setConnectable(!0);return c};
eeGraph.prototype.createEdge=function(a,b,c,d,e,f){EEWeb.eventLog.logEvent("eeGraph.createEdge","");a=new eeEdge(c,new mxGeometry,f,"");a.setId(b);a.setEdge(!0);a.geometry.relative=!0;return a};eeGraph.prototype.isHtmlLabel=function(a){var b=mxGraph.prototype.isHtmlLabel.apply(this,arguments);return a.isAllowHtmlLabels()||b};eeGraph.prototype.isValidConnection=function(a,b){return!0};eeGraph.prototype.isDiagramConnection=function(a,b){return!1};
eeGraph.prototype.isCellLocked=function(a){return a&&(a instanceof eeLabel||a.isASmartPin())?!1:mxGraph.prototype.isCellLocked.apply(this,arguments)};eeGraph.prototype.validateEdge=function(a,b,c){1<EEWeb.debug.LogEdgeValidation&&EEWeb.log.info("eeGraph.validateEdge: edge=="+(null==a?"null":a.toString())+" from "+(null==b?"null":b.toString())+" to "+(null==c?"null":c.toString()));return null};
eeGraph.prototype.createPopupMenu=function(a,b,c,d){EEWeb.eventLog.logEvent("createPopupMenu","");a=EEBasepath+"img/web20px/";this.addToggleGridMenu(a,b,c,d);this.addComponentMenu(a,b,c,d);this.addComponentLinkMenu(a,b,c,d);this.addCutCopyPasteDeleteMenu(a,b,c,d);this.addUndoRedoMenu(a,b,c,d);this.addZoomMenu(a,b,c,d);this.addFlipRotateMenu(a,b,c,d);this.addImageLinkMenu(a,b,c,d)};
eeGraph.prototype.addToggleGridMenu=function(a,b,c,d){EEWeb.app.getGui().isGridVisible()?b.addItem(l("hide_grid"),a+"grid_hide.png",function(){EEWeb.app.getEditor().execute("toggle_grid")}):b.addItem(l("show_grid"),a+"grid_show.png",function(){EEWeb.app.getEditor().execute("toggle_grid")})};
eeGraph.prototype.addComponentMenu=function(a,b,c,d){var e=EEWeb.app.getVendor();c instanceof eeComp&&(b.addItem(l("editproperties"),a+"properties.png",function(){"showProperties"in c?c.showProperties(EEWeb.app.getEditor()):EEWeb.app.getEditor().showProperties(c)}),"canPartSearch"in c&&c.canPartSearch()&&(e=e.getSearchTitle(),b.addItem(e,a+"search.png",function(){c.onPartSearch()})));c instanceof eeEdge&&c.parent instanceof eeNet&&b.addItem(l("setnetname"),a+"cut.png",function(){c.startEditing(d)})};
eeGraph.prototype.addComponentLinkMenu=function(a,b,c,d){c instanceof eeComp&&c.links&&(c=_.filter(c.links,function(a){return a.display_in_context}),_.each(c,function(c){b.addItem(c.title,a+"comp_link.png",function(){window.open(c.url,"_blank")})}))};
eeGraph.prototype.addCutCopyPasteDeleteMenu=function(a,b,c,d){null!==c&&!c.isACustomPin()&&this.componentInSelection()&&(b.addSeparator(),b.addItem(l("cut"),a+"cut.png",function(){EEWeb.app.getEditor().execute("cut")}),b.addItem(l("copy"),a+"copy.png",function(){EEWeb.app.getEditor().execute("copy")}));mxClipboard.isEmpty()||b.addItem(l("paste"),a+"paste.png",function(){EEWeb.app.getEditor().execute("paste")});null!==c&&b.addItem(l("delete"),a+"delete.png",function(){EEWeb.app.getEditor().execute("delete")})};
eeGraph.prototype.addUndoRedoMenu=function(a,b,c,d){var e=EEWeb.app.getEditor();e.undoManager.isEmpty()||(b.addSeparator(),e.undoManager.canUndo()&&b.addItem(l("undo"),a+"undo.png",function(){e.execute("undo")}),e.undoManager.canRedo()&&b.addItem(l("redo"),a+"redo.png",function(){e.execute("redo")}))};
eeGraph.prototype.addZoomMenu=function(a,b,c,d){b.addSeparator();b.addItem(l("zoom_in"),a+"zoom_in.png",function(){EEWeb.app.getEditor().execute("zoom_in")});b.addItem(l("zoom_out"),a+"zoom_out.png",function(){EEWeb.app.getEditor().execute("zoom_out")});b.addItem(l("zoom_fit"),a+"zoom_to_fit.png",function(){EEWeb.app.getEditor().execute("zoom_fit")})};
eeGraph.prototype.addFlipRotateMenu=function(a,b,c,d){null==c||0<=mxUtils.indexOfStylename(c.style,"group")||!c.isFlippable()&&!c.isRotatable()||(b.addSeparator(),c.isFlippable()&&(b.addItem(l("flipvertically"),a+"flip_v.png",function(){EEWeb.app.getEditor().execute("flipv")}),b.addItem(l("fliphorizontally"),a+"flip_h.png",function(){EEWeb.app.getEditor().execute("fliph")})),c.isRotatable()&&b.addItem(l("rotate"),a+"rotate.png",function(){EEWeb.app.getEditor().execute("rotate")}))};
eeGraph.prototype.addImageLinkMenu=function(a,b,c,d){if(null!=c&&c.isImageComp()){var e=this;b.addSeparator();b.addItem(l("edit_link"),a+"edit.png",function(){var a=e.getView().getState(c);amplify.publish(EEWeb.events.EDIT_COMP_IMAGE_URL,a.style[mxConstants.SHAPE_IMAGE])})}};eeGraph.prototype.cloneCells=function(a,b){for(var c=mxGraph.prototype.cloneCells.apply(this,arguments),d=0,e=c.length;d<e;d++){var f=c[d];f instanceof eeComp&&f.syncLabels()}return c};eeGraph.prototype.createGraphView=function(){return new eeGraphView(this)};
eeGraph.prototype.getCellStyle=function(a,b){var c=mxGraph.prototype.getCellStyle.apply(this,arguments);!b&&null!=c&&this.model.isEdge(a)&&(c=mxUtils.clone(c),c=this.setStyleEnds(c,a));return c};eeGraph.prototype.isCellMovable=function(a){if(!a.isMovable()){var b=this.graphHandler;if(b.cell&&b.cell!==a)return!1}return mxGraph.prototype.isCellMovable.call(this,a)};
eeGraph.prototype.setStyleEnds=function(a,b){this.model.isEdge(this.model.getTerminal(b,!0))?a.startArrow="oval":a.startArrow="none";this.model.isEdge(this.model.getTerminal(b,!1))?a.endArrow="oval":a.endArrow="none";return a};
eeGraph.prototype.createHandler=function(a){EEWeb.eventLog.logEvent("eeGraph.createHandler","");if(null!=a){if(this.model.isEdge(a.cell)&&this.view.getEdgeStyle(a)==mxEdgeStyle.WireConnector){EEWeb.eventLog.logEvent("eeGraph.createHandler","mxEdgeSegmentHandler");var b=new mxEdgeSegmentHandler(a);b.mouseDown=function(a,d){EEWeb.eventLog.logEvent("mxEdgeSegmentHandler.mouseDown","");mxEdgeSegmentHandler.prototype.mouseDown.apply(b,arguments)};b.mouseUp=function(a,d){EEWeb.eventLog.logEvent("mxEdgeSegmentHandler.mouseUp",
"");mxEdgeSegmentHandler.prototype.mouseUp.apply(b,arguments)};b.connect=function(a,d,e,f,g){EEWeb.eventLog.logEvent("mxEdgeSegmentHandler.connect","");mxEdgeSegmentHandler.prototype.connect.apply(b,arguments)};return b}if(a.cell instanceof eeCusComp)return EEWeb.eventLog.logEvent("eeGraph.createHandler","eeVertexHandler"),new eeVertexHandler(a);if(a.cell instanceof eeCell&&this.getLinkForCell(a.cell))return new eeVertexHandler(a)}return mxGraph.prototype.createHandler.apply(this,arguments)};
eeGraph.prototype.selectAllLimited=function(){var a=this.getCells(0,0,this.pageFormat.width,this.pageFormat.height);0<a.length&&this.setSelectionCells(a)};eeGraph.prototype.canExportCell=function(a){return mxGraph.prototype.canExportCell.call(this,a)&&a.isCopiable()};
eeGraph.prototype.getCells=function(a,b,c,d,e,f){f=null!=f?f:[];if(0<c||0<d){var g=this.getModel(),h=a+c,k=b+d;null==e&&(e=this.getCurrentRoot(),null==e&&(e=g.getRoot()));if(null!=e)for(var m=g.getChildCount(e),n=0;n<m;n++){var p=g.getChildAt(e,n),q=this.view.getState(p);if(null!=q&&this.isCellVisible(p)){var u=mxUtils.getValue(q.style,mxConstants.STYLE_ROTATION)||0;0!=u&&(q=mxUtils.getBoundingBox(q,u));(g.isEdge(p)||g.isVertex(p))&&q.x>=a&&q.y+q.height<=k&&q.y>=b&&q.x+q.width<=h&&"net"!=p.style?
f.push(p):this.getCells(a,b,c,d,p,f)}}}return f};eeGraph.prototype.getBoundingBoxFromGeometry=function(a,b){a=_.filter(a,function(a){return a.constrainInParent()});return mxGraph.prototype.getBoundingBoxFromGeometry.call(this,a,b)};
eeGraph.prototype.getAllEdges=function(a){var b=[];if(null!=a){var c=this.model;_.each(a,function(a){var e=c.getEdgeCount(a);b=b.concat(_.map(_.range(e),function(b){return c.getEdgeAt(a,b)}));e=c.getChildren(a);a&&!_.isEmpty(a.edges)&&(e=_.union(e,a.edges));b=b.concat(this.getAllEdges(e))},this)}return b};eeGraph.prototype.isValidDropTarget=function(a,b,c){var d=a.style&&(-1<a.style.indexOf("group")||-1<a.style.indexOf("swimlane"));return mxGraph.prototype.isValidDropTarget.call(this,a,b,c)&&d};
eeGraph.prototype.setAttributeForCell=function(a,b,c){var d=null;null!=a.value&&"object"==typeof a.value?d=a.value.cloneNode(!0):(d=mxUtils.createXmlDocument().createElement("UserObject"),d.setAttribute("label",a.value||""));null!=c&&0<c.length?d.setAttribute(b,c):d.removeAttribute(b);this.model.setValue(a,d)};eeGraph.prototype.setLinkForCell=function(a,b){this.setAttributeForCell(a,"link",b)};
eeGraph.prototype.getLinkForCell=function(a){return null!=a.value&&"object"==typeof a.value?a.value.getAttribute("link"):null};eeGraph.prototype.cellLabelChanged=function(a,b,c){b=this.zapGremlins(b);if(null!=a.value&&"object"==typeof a.value){var d=a.value.cloneNode(!0);d.setAttribute("label",b);b=d}mxGraph.prototype.cellLabelChanged.apply(this,arguments)};eeGraph.prototype.zapGremlins=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);(32<=d||9==d||10==d||13==d)&&b.push(a.charAt(c))}return b.join("")};
eeGraph.prototype.convertValueToString=function(a){return null!=a.value&&"object"==typeof a.value?a.value.getAttribute("label"):mxGraph.prototype.convertValueToString.apply(this,arguments)};
function eeProject(){return EEWeb.project&&"undefined"!==typeof EEWeb.project?EEWeb.project:this instanceof eeProject?(this.name=this.id=null,this.shareEmail="",this.intIsPublic=!1,this.owner=null,this.newFlag=!1,this.view=this.model=this.description=this.summary="",this.modified=!1,this.shareEmail="",this.bIsLoggedIn=!1,this.shareDialog=this.currentUserId=null,this.currentProjectList=[],this.currentProjectNames={},EEWeb.project=this,this):new eeProject}
eeProject.prototype.getSessionDataName=function(){throw Error("eeProject.getSessionDataName must be overridden.");};eeProject.prototype.getName=function(){return this.name};eeProject.prototype.setName=function(a){var b=this.name;this.name=a;amplify.publish(EEWeb.events.PROJECT_NAME_CHANGED,new ALEvent({previous:b,name:a,ownerid:this.getOwnerId(),modified:this.modified,lastindex:this.lastIndex,totalprojects:this.lastProjects?this.lastProjects.length:null}))};
eeProject.prototype.setModified=function(a){this.modified=a;amplify.publish(EEWeb.events.PROJECT_MODIFIED,new ALEvent({name:this.getName(),modified:a}))};eeProject.prototype.isModified=function(){return this.modified};eeProject.prototype.isLoggedIn=function(){return!0===this.bIsLoggedIn};eeProject.prototype.isPublic=function(){return this.intIsPublic};eeProject.prototype.setPublic=function(a){this.intIsPublic=!0===a?!0:!1};
eeProject.prototype.updatePublic=function(a){var b=this,c=$.Deferred(),d=this.getId();null===d||"undefined"===typeof d?c.resolve():amplify.request({resourceId:"permissions",data:this.getPublicData(a),success:function(){b.setPublic(a);c.resolve()},error:function(){c.reject()}});return c.promise()};eeProject.prototype.getPublicData=function(a){return{name:this.name,id:this.getId(),setPublic:a}};eeProject.prototype.setLoggedIn=function(a){this.bIsLoggedIn=!0===a};
eeProject.prototype.setId=function(a){this.id=a};eeProject.prototype.updateProjectList=function(a){this.currentProjectList=_.sortBy(a,"name");this.currentProjectNames={};_.each(a,function(a){this.currentProjectNames[a.name]=a},this)};eeProject.prototype.getCurrentProjectList=function(){return this.currentProjectList};eeProject.prototype.getProjectIdFromName=function(a){return a in this.currentProjectNames?this.currentProjectNames[a].id:null};
eeProject.prototype.isUniqueName=function(a){a=a.replace(/^\s+|\s+$/g,"");return!(a in this.currentProjectNames)};eeProject.prototype.makeNameUnique=function(a){if(this.isUniqueName(a))return a;a.match(/-\d+$/)&&(a=a.replace(/-\d+$/,""));for(var b=1,c=a+"-"+b;!this.isUniqueName(c);)b++,c=a+"-"+b;return c};eeProject.prototype.setNew=function(a){this.newFlag=!0===a?!0:!1};eeProject.prototype.isNew=function(){return this.newFlag};eeProject.prototype.getId=function(){return this.id?this.id:null};
eeProject.prototype.getOwnerId=function(){return this.owner};eeProject.prototype.setOwnerId=function(a){EEWeb.log.info("Owner id set to "+a);this.owner=a};eeProject.prototype.getCurrentUserId=function(){return this.currentUserId};eeProject.prototype.setCurrentUserId=function(a){EEWeb.log.info("UserID set to "+a);this.currentUserId=a};
eeProject.prototype.getExportName=function(){if(this.name)var a=this.name.replace(/[^-_.a-z0-9 ]/ig,""),a=a.replace(/[-_ ]+/g,"-")+".png";else a=l("export_filename")+l("export_pngext");return a};eeProject.prototype.init=function(){this.initializeProject();this.initHandlers()};
eeProject.prototype.initHandlers=function(){var a=this;EEWeb.app.addModelListener(mxEvent.CHANGE,function(b,c){a.setModified(!0)});amplify.subscribe(EEWeb.events.AUTO_LOAD,function(b){a.openFile(b.name,b.id)});amplify.subscribe(EEWeb.events.COMPONENT_UPDATED,function(){a.setModified(!0)});amplify.subscribe(EEWeb.events.USER_UPDATED,function(b){a.onUserUpdated(b)});amplify.subscribe(EEWeb.events.PAGE_NAME_CHANGE,function(b){a.setModified(!0)});amplify.subscribe(EEWeb.events.PAGE_DELETED,function(b){a.setModified(!0)});
amplify.subscribe(EEWeb.events.PAGE_ADDED,function(b){a.setModified(!0)});amplify.subscribe(EEWeb.events.PROJECT_SAVE_SESSION,function(b){a.saveSession()});amplify.subscribe(EEWeb.events.PROJECT_RESTORE_SESSION,function(){a.restoreSession()});amplify.subscribe(EEWeb.events.SAVE_AS_PROJECT,function(b,c){a.saveAsNewName(b,c)});amplify.subscribe(EEWeb.events.SHOW_ALERT,function(a,c,d){EEWeb.app.getUtils().show_alert(a,c,d)})};
eeProject.prototype.initializeProject=function(){this.setId(null);this.name=null;this.setPublic(!1);this.setNew(!0);this.view=this.model=this.description=this.summary="";this.modified=!1;this.version="2.0"};eeProject.prototype.clearProject=function(){var a=EEWeb.app;a.getModel().clear();a.getEditor().resetView();amplify.publish(EEWeb.events.CLEAR_PROJECT,new ALEvent({}))};eeProject.prototype.getURL=function(a){alert(l("alertoverride"));return""};
eeProject.prototype.getProjectData=function(){var a={id:this.getId(),name:this.name,isPublic:this.isPublic(),summary:this.summary,description:this.description,modified:this.modified,model:"",view:"",width:0,height:0,version:"2.0"},b=EEWeb.app.getUtils().exportSvgFromGraph(!0);a.view=b.svg;a.width=Math.ceil(b.bounds.width);a.height=Math.ceil(b.bounds.height);a.model=this.writeGraphModel();a.BOM="";return a};
eeProject.prototype.writeGraphModel=function(){EEWeb.eventLog.logEvent("eeProject.writeGraphModel","start");var a=EEWeb.app.getEditor().writeGraphModel();if(mxClient.IS_IE)return a;a=(new DOMParser).parseFromString(a,"text/xml").documentElement;if(/parsererror/.test(a.nodeName))throw this.notifyUserOfParseError(),Error("DOMParser parser error");if(!/(sim|mx|ee)GraphModel/.test(a.nodeName)){var b=mxUtils.createXmlDocument(),c=b.createElement(this.getDefaultGraphModel());c.appendChild(a);b.appendChild(c);
a=b.documentElement}a.setAttribute("version","2.0");a=mxUtils.getXml(a);EEWeb.eventLog.logEvent("eeProject.writeGraphModel","end");return a};eeProject.prototype.restoreGraphModel=function(a){a=mxUtils.parseXml(a).documentElement;if(!/(sim|mx|ee)GraphModel/.test(a.nodeName)){var b=mxUtils.createXmlDocument(),c=b.createElement(this.getDefaultGraphModel());c.setAttribute("version","2.0");c.appendChild(a);b.appendChild(c);a=b.documentElement}EEWeb.app.getEditor().readGraphModel(a)};
eeProject.prototype.getDefaultGraphModel=function(){return"eeGraphModel"};eeProject.prototype.notifyUserOfParseError=function(){amplify.publish(EEWeb.events.PROJECT_PARSER_ERROR,new ALEvent({name:this.getName(),id:this.getId(),message:"DOMParser error"}))};eeProject.prototype.restoreProject=function(a){alert(l("alertoverride_must"))};
eeProject.prototype.notifyProjectLoaded=function(){amplify.publish(EEWeb.events.LOAD_PROJECT,new ALEvent({name:this.getName(),id:this.getId()}));amplify.publish(EEWeb.events.LOAD_PROJECT_COMPLETE,new ALEvent({name:this.getName(),id:this.getId()}))};eeProject.prototype.getSessionData=function(){var a=null,b=this.getSessionDataName(),c=null;Modernizr&&Modernizr.localstorage&&(c=localStorage.getItem(b))?a=JSON.parse(c):eeServerData&&(c=eeServerData[b])&&(a=c);return a};
eeProject.prototype.restoreSession=function(a){if(a=a?a:this.getSessionData())this.initializeProject(),$.cookie("resumeSession",null),this.restoreGraphModel(a.model),this.setId(a.project_id),this.setPublic(0==a.isPublic?!1:!0),this.summary=a.summary,this.description=a.description,this.model=a.model,this.setName(a.name),this.setNew(a.isNew?!0:!1),this.notifyProjectLoaded(),this.setModified(a.modified)};
eeProject.prototype.getProjectDataForSession=function(){return{id:this.getId(),model:EEWeb.app.getEditor().writeGraphModel(),modified:this.isModified()?1:0,isNew:this.isNew(),isPublic:this.isPublic(),isSaving:this.isSaving?1:0,isSaveAs:this.isSaveAs,summary:this.summary,description:this.description}};
eeProject.prototype.saveSession=function(){EEWeb.eventLog.logEvent("eeProject.saveSession","");var a=this.getProjectDataForSession(),a=JSON.stringify(a);Modernizr&&Modernizr.localstorage?localStorage.setItem(this.getSessionDataName(),a):amplify.request({resourceId:"save_session",data:{data:a},success:function(a,c){a.error&&EEWeb.app.getUtils().show_alert(a.error)},error:function(a,c,d){EEWeb.log.info("Error:"+c+" "+d)}})};
eeProject.prototype.showRestoreProjectSessionDialog=function(){var a=this;$("<p>"+l("restore_project_session_msg")+"</p>").dialog({draggable:!1,dialogClass:"graph-popup-dialog",modal:!0,resizable:!1,title:l("restore_project_session"),buttons:[{text:l("default_ok"),click:function(){a.doRestoreProjectSession();$(this).dialog("close")}},{text:l("cancel"),click:function(){$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};
eeProject.prototype.onRestoreProjectSession=function(){var a=this.getSessionData(),b=this.getId(),c=a.isSaving;a&&a.id===b&&(c?this.doRestoreProjectSession():this.showRestoreProjectSessionDialog())};eeProject.prototype.doRestoreProjectSession=function(){this.clearProject();var a=this.getProjectData(),b=this.getSessionData();b.project_id=b.id;a=_.extend(a,b);this.stencilxml=null;this.restoreSession(a)};
eeProject.prototype.doSaveOnSessionRestore=function(){this.isSaving&&this.isLoggedIn()&&(this.isSaveAs?this.doSaveAs():this.doSave(),this.isSaveAs=this.isSaving=!1)};eeProject.prototype.idToHash=function(a){a="string"===typeof a?parseInt(a,10):a;return(a+1E4).toString(36)};eeProject.prototype.hashToId=function(a){return parseInt(a,36)-1E4};eeProject.prototype.getHashedProject=function(){return this.idToHash(this.getId())};
eeProject.prototype.onUserUpdated=function(a){this.setLoggedIn(a.bLoggedIn);this.setCurrentUserId(a.uid);EEWeb.log.info("User id updated to "+this.getCurrentUserId());this.setModified(this.isModified())};
eeProject.prototype.onSaveModified=function(a){$("<p>"+l("onsavemod_dialog")+"</p>").dialog({title:l("onsavemod_title"),resizable:!1,modal:!0,draggable:!0,dialogClass:"graph-popup-dialog",width:430,height:200,buttons:[{text:l("onsavemod_cancel"),click:function(){$(this).dialog("close");a.cancel&&a.cancel.call()}},{text:l("onsavemod_dont_save"),click:function(){$(this).dialog("close");a.dontsave&&a.dontsave.call()}},{text:l("onsavemod_save"),click:function(){$(this).dialog("close");a.save&&a.save.call()}}],
close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};eeProject.prototype.onNew=function(){EEWeb.eventLog.logEvent("eeProject.onNew","");var a=this;if(this.modified)this.onSaveModified({self:this,cancel:null,dontsave:function(){a.doNew()},save:function(){if(a.getId())a.onSave(),a.doNew();else a.onSaveAs(!0)}});else this.doNew()};
eeProject.prototype.onOpen=function(a){EEWeb.eventLog.logEvent("eeProject.onOpen","");var b=this;if(this.isLoggedIn())if(this.modified)this.onSaveModified({self:this,cancel:null,dontsave:function(){b.doOpen()},save:function(){b.doSave()}});else b.doOpen(a);else this.saveSession(),amplify.publish(EEWeb.events.USER_LOGIN,new ALEvent({}))};
eeProject.prototype.onSave=function(a){EEWeb.eventLog.logEvent("eeProject.onSave","");this.isLoggedIn()?this.doSave():(this.isSaving=!0,this.isSaveAs=!1,this.saveSession(),amplify.publish(EEWeb.events.USER_LOGIN,new ALEvent({})))};eeProject.prototype.onSaveAs=function(a){EEWeb.eventLog.logEvent("eeProject.onSaveAs","");this.isLoggedIn()?this.doSaveAs(this.name,a):(this.isSaveAs=this.isSaving=!0,this.saveSession(),amplify.publish(EEWeb.events.USER_LOGIN,new ALEvent({})))};
eeProject.prototype.onShare=function(){EEWeb.eventLog.logEvent("eeProject.onShare","");if(this.isLoggedIn()){var a=this;this.name&&this.id?a.doShare():$("<p>"+l("saveshareproj_save")+"</p>").dialog({title:l("sharesaveproj"),resizable:!1,modal:!0,draggable:!0,dialogClass:"graph-popup-dialog",width:400,height:200,buttons:[{text:l("saveshareproj_dlg_dont_save"),click:function(){$(this).dialog("close")}},{text:l("saveshareproj_dlg_save"),click:function(){$(this).dialog("close");a.doSave()}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,
new ALEvent({}));$(this).remove()}})}else this.saveSession(),amplify.publish(EEWeb.events.USER_LOGIN,new ALEvent({}))};
eeProject.prototype.doSave=function(){EEWeb.eventLog.logEvent("eeProject.doSave","");if(this.isNew()||this.getOwnerId()!==this.getCurrentUserId())return EEWeb.log.info("Is New:"+this.isNew()),EEWeb.log.info("OwnerID:"+this.getOwnerId()),EEWeb.log.info("Current User Id:"+this.getCurrentUserId()),this.doSaveAs(this.getName());if(!this.modified)return!1;var a=this;if(this.name)try{var b=this.getProjectData();amplify.request({resourceId:"save_project",data:b,success:function(b,c){b.error?EEWeb.app.getUtils().show_alert(b.error):
(a.setId(b.project_id),a.setModified(!1))}})}catch(c){EEWeb.eventLog.captureException(c)}else return this.doSaveAs()};eeProject.prototype.doSaveAs=function(a,b){EEWeb.eventLog.logEvent("eeProject.doSaveAs","");var c=this;c.getProjectList(function(d){c.doSaveAsPhase2(a,b)})};
eeProject.prototype.doSaveAsPhase2=function(a,b){EEWeb.eventLog.logEvent("eeProject.doSaveAs","");var c=this;b=b?b:!1;var d=a?a:"NewProject",d=this.makeNameUnique(d),e,f=this.buildSaveAsDialog(d);$(f).dialog({title:l("saveproject"),resizable:!1,buttons:[{text:l("cancel"),click:function(){$(this).dialog("close")}},{id:"proj_save_btn",text:l("save"),click:function(){c.validateInput()&&(d=$("#save_proj_name").val(),$("#proj_save_btn").button("disable"),$(this).dialog("close"),c.saveAsNewName(d,b))},
className:"dialog_default_button",disabled:!1}],draggable:!1,modal:!0,dialogClass:"graph-popup-dialog",open:function(){c.validateInput();$("#save_proj_name").on("input keyup",function(){clearTimeout(e);e=setTimeout(function(){c.validateInput()},300)});$(this).submit(function(a){c.validateInput()&&$("#proj_save_btn").click();a.preventDefault()})},close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};
eeProject.prototype.buildSaveAsDialog=function(a){var b=[];b.push("<form action='php/save_check_name.php' method='post' class='modal_form'>");b.push("<h4>"+l("projname")+"</h4>");a?b.push("<input id='save_proj_name' type='text' name='name' value='"+a+"'/>"):b.push("<input id='save_proj_name' type='text' name='name' />");b.push("<div id='duplicate_proj_result'></div>");b.push("</form>");return b.join("")};
eeProject.prototype.validateInput=function(){var a=!0,a=$("#duplicate_proj_result"),b=$("#proj_save_btn"),c=$("#save_proj_name").val();""==c?(a.html(l("alertgiveprojname")),b.button("disable"),a=!1):this.isProjectNameWithinLimit(c)?(c=this.isUniqueName(c),a.html(c?"":l("duplicate_project_name")),b.button(c?"enable":"disable"),a=c):(a.html(l("project_name_too_long")),b.button("disable"),a=!1);return a};
eeProject.prototype.isProjectNameWithinLimit=function(a){var b=this.getProjectNameLimit();a=a.length;return b?b>=a:!0};eeProject.prototype.getProjectNameLimit=function(){return 0};
eeProject.prototype.saveAsNewName=function(a,b){EEWeb.eventLog.logEvent("eeProject.doSaveAs","New Name.");var c=this;try{var d=this.getProjectData();d.name=a;delete d.id;amplify.request({resourceId:"save_as_project",data:d,success:function(d,e){d.error?amplify.publish(EEWeb.events.SHOW_ALERT,d.error):(c.setName(a),c.onSaveAsResult(d,b))}})}catch(e){EEWeb.eventLog.captureException(e)}};eeProject.prototype.updateProjectDataBeforeSaveAs=function(a){this.setName(a)};
eeProject.prototype.onSaveAsResult=function(a,b){this.setId(a.project_id);this.setOwnerId(this.getCurrentUserId());this.setModified(!1);this.setNew(!1);b&&this.doNew()};
eeProject.prototype.getProjectList=function(a){var b=this;amplify.request({resourceId:"open_list",success:function(c,d){var e=c.hasLoginId?!0:!1,f=[];"success"==d?f=c.projects:EEWeb.log.info("Error:"+c.error);b.updateProjectList(f);a(b.getCurrentProjectList(),e)},error:function(c,d,e){EEWeb.log.info("Error:"+d+" "+e);b.updateProjectList(projects);a(b.getCurrentProjectList(),!1)}})};
eeProject.prototype.doOpen=function(a,b){EEWeb.eventLog.logEvent("eeProject.doOpen","");if(a&&this.lastProjects){var c=1;null!=b&&(c=b);1==c?c=++this.lastIndex:(c=--this.lastIndex,0>c&&(this.lastIndex=c=0));c<this.lastProjects.length?c=this.lastProjects[c]:(this.lastIndex=0,c=this.lastProjects[0]);this.openFile(c.name,c.project_id)}else{var d=this;this.getProjectList(function(a,b){d.displayProjectList(a,b)})}};
eeProject.prototype.displayProjectList=function(a,b){var c=this,d=0;if(a.length){EEWeb.eventLog.logEvent("eeProject.displayProjectList","list projects");c.lastProjects=a;c.lastIndex=0;var e={},f=[];f.push("<form action='open' method='post' class='modal_form'>");f.push("<h4>"+l("header_project")+"</h4>");f.push("<select name='name' size='10' style='width: 100%'>");for(var g in a){var h=a[g].project_id;null==h&&(h=d++);var k=a[g].name,m=a[g].slug;if(b){var n=a[g].login_id;e[h]={name:k,index:g,lid:n,
slug:m};f.push("<option value='");f.push(h);f.push("'>");f.push(k+" ("+n+")")}else e[h]={name:k,index:g,slug:m},f.push("<option value='"),f.push(h),f.push("'>"),f.push(k);f.push("</option>")}f.push("</select>");f.push("</form>");var d=0.6*$("body").width(),p=$(f.join("")).dialog({title:l("openproj"),resizable:!1,width:500,buttons:[{text:l("openproj_delete"),click:function(){var a=$("select[name=name]",this).val();if(!a)return EEWeb.app.getUtils().show_alert(l("selectproj_delete")),!1;var b=e[a];c.lastIndex=
b.index;b=b.name.replace(/'/g,"&apos;");if(b==c.name)return EEWeb.app.getUtils().show_alert(l("cantdelete_proj")),!1;var d=this;"DELETE"==prompt(l("typedelete_proj"),"")&&amplify.request({resourceId:"delete",data:{name:b,id:a},success:function(a,b){a.error?EEWeb.app.getUtils().show_alert(a.error):$("option:selected",d).remove()}})}},{text:l("openproj_cancel"),click:function(){p.dialog("close")}},{text:l("openproj_open"),id:"open_project_button",click:function(){var a=$("select[name=name]",this).val();
if(!a)return EEWeb.app.getUtils().show_alert(l("selectproj_open")),!1;var b=e[a];c.lastIndex=b.index;var d=b.name.replace(/'/g,"&apos;"),b=b.slug;p.dialog("close");c.openProject(d,a,b)}}],draggable:!1,modal:!0,dialogClass:"graph-popup-dialog",open:function(){$(this).keypress(function(a){13==a.keyCode&&$("#open_project_button").click()})},close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));p.remove()}});p.parent().resizable({minWidth:500,maxWidth:d,handles:"e, w"})}else EEWeb.app.getUtils().show_alert(l("noproj_open"))};
eeProject.prototype.openProject=function(a,b,c){this.openFile(a,b)};eeProject.prototype.openFile=function(a,b){var c=this;amplify.request({resourceId:"open_project",data:{name:a,id:b,version:"2.0"},success:function(a,b){a.error?EEWeb.app.getUtils().show_alert(a.error):c.restoreProject(a)}})};
eeProject.prototype.doNew=function(){EEWeb.eventLog.logEvent("eeProject.doNew","");var a=EEWeb.app;this.clearProject();this.restoreGraphModel('<mxGraphModel><root><mxCell id="0"/><mxCell id="1" parent="0"/></root></mxGraphModel>');this.initializeProject();this.setNew(!0);a.getEditor().resetHistory();$("#file_header .title").text(l("newproject"));window.location.hash="";amplify.publish(EEWeb.events.NEW_PROJECT,new ALEvent({name:""}));this.setName(l("newproject"));this.setModified(!1)};
eeProject.prototype.createShareDialog=function(){return new eeShareDialog("#share_dialog",this,l("shareproject"))};eeProject.prototype.doShare=function(){EEWeb.eventLog.logEvent("eeProject.doShare","");null===this.shareDialog?(this.shareDialog=this.createShareDialog(),this.shareDialog.init()):this.shareDialog.show()};
eeProject.prototype.onShareViaEmail=function(a,b){EEWeb.eventLog.logEvent("eeProject.onShareViaEmail","");var c=$("#share_email").val();if(!EEWeb.app.getUtils().isValidEmailAddress(c))return EEWeb.app.getUtils().show_alert(l("alertvalid_email")),!1;$(a).dialog("close");this.setPublic(!0);amplify.request({resourceId:"share",data:{project_id:this.idToHash(this.getId()),email:c},success:function(a,b){a.error?EEWeb.app.getUtils().show_alert(a.error,l("alertmessage_fail")):EEWeb.app.getUtils().show_alert(a.response,
l("alertmessage_sent"))}})};eeProject.prototype.doExport=function(){};eeProject.prototype.getAllComponents=function(){return EEWeb.app.getModel().filterDescendants(function(a){return a instanceof eeComp})};eeProject.prototype.getCellsWithStencil=function(){return EEWeb.app.getModel().filterDescendants(function(a){return a.hasStencil()})};
eeProject.prototype.getStencilList=function(a){var b=/component_([^;]*)/;a=null==a?this.getCellsWithStencil():a;return _.chain(a).map(function(a){return(a=b.exec(a.style))?a[1]:null}).filter(function(a){return a}).uniq().value()};eeProject.prototype.getStencilShapes=function(a){return _.map(a,function(a){return(a=mxStencilRegistry.getStencil("component_"+a))?a.desc:null})};
eeProject.prototype.getStencilXml=function(a){var b="",c=mxUtils.createXmlDocument().createElement("shapes"),d=!1;_.find(a,function(a){try{c.appendChild(a)}catch(b){"DEVEL"==eeServerData.buildType&&console.log("Error appending stencil shape to xml root element"),d=!0}return d});return b=d?"":EEWeb.utils.isFirefoxVersion(20)?(new XMLSerializer).serializeToString(c):mxUtils.getXml(c)};
eeProject.prototype.loadProjectStencils=function(a){var b=this,c=$.Deferred(),d=!1;this.stencilxml&&(d=b.loadStencilFromProj())&&c.resolve();d||(a=this.getCompStyles(a),a={stencils:this.getStencilList(a)},this.getStencilFromDB(a).then(function(a,d){b.loadStencilFromDB(a);c.resolve()}));return c.promise()};
eeProject.prototype.getStencilFromDB=function(a){var b=$.Deferred();amplify.request({resourceId:"get_stencils",data:{stencils:JSON.stringify(a)},success:function(a,d){b.resolve(a,d)},error:function(a,d,e){b.reject(a,d,e)}});return b.promise()};
eeProject.prototype.loadStencilFromDB=function(a){a=a.firstChild;for(a="undefined"!=typeof a.firstElementChild?a.firstElementChild:a.firstChild;null!=a;)a.nodeType==mxConstants.NODETYPE_ELEMENT&&void 0===mxStencilRegistry.getStencil("component_"+a.getAttribute("name"))&&mxStencilRegistry.addStencil("component_"+a.getAttribute("name"),new mxStencil(a)),a="undefined"!=typeof a.nextElementSibling?a.nextElementSibling:a.nextSibling};
eeProject.prototype.loadStencilFromProj=function(){var a=mxUtils.parseXml(this.stencilxml).documentElement,b=a.firstChild,a=a.childElementCount,c=!0;if(0==a||this.stencillist.length!=a)this.stencilxml=null,c=!1;for(;null!=b&&c;)b.nodeType==mxConstants.NODETYPE_ELEMENT&&void 0===mxStencilRegistry.getStencil("component_"+b.getAttribute("name"))&&mxStencilRegistry.addStencil("component_"+b.getAttribute("name"),new mxStencil(b)),b=b.nextSibling;return c};
function eeUser(){return EEWeb.user&&"undefined"!==typeof EEWeb.user?EEWeb.user:this instanceof eeUser?(this.bProjectModified=this.bLoggedIn=!1,this.email=this.name=null,EEWeb.user=this,this.initialized=!1,this):new eeUser}eeUser.prototype.setUserData=function(a){a?(this.name=a.name,this.email=a.email,this.setLoggedIn(a.loggedIn)):(this.email=this.name=null,this.setLoggedIn(!1));this.fireUserUpdate()};
eeUser.prototype.fireUserUpdate=function(){amplify.publish(EEWeb.events.USER_UPDATED,new ALEvent({name:this.name,email:this.email,bLoggedIn:this.isLoggedIn()}))};
eeUser.prototype.init=function(){this.setUserData(null);if(!this.initialized){this.setProjectModified(!0);var a=this;amplify.subscribe(EEWeb.events.USER_LOGIN,function(b){a.doLogin()});amplify.subscribe(EEWeb.events.USER_LOGOUT,function(b){a.doLogout()});amplify.subscribe(EEWeb.events.USER_LIVE_CHAT,function(b){a.openChat()});amplify.subscribe(EEWeb.events.USER_CONTACT_US,function(b){a.doContactUs()});amplify.subscribe(EEWeb.events.USER_SIGNUP,function(b){a.doSignup()});amplify.subscribe(EEWeb.events.PROJECT_MODIFIED,
function(b){a.onProjectModified(b)})}this.initialized=!0};eeUser.prototype.setLoggedIn=function(a){this.bLoggedIn=!0===a};eeUser.prototype.isLoggedIn=function(){return this.bLoggedIn};eeUser.prototype.setProjectModified=function(a){this.bProjectModified=!0===a};eeUser.prototype.isProjectModified=function(){return this.bProjectModified};eeUser.prototype.loginQueryUrl=function(){return null};eeUser.prototype.loginUrl=function(){return null};eeUser.prototype.logoutUrl=function(){return null};
eeUser.prototype.getLoginMessage=function(){return""};eeUser.prototype.loginLocation=function(){};eeUser.prototype.queryLoggedIn=function(){};eeUser.prototype.onProjectModified=function(a){this.setProjectModified(a.modified)};eeUser.prototype.doLogin=function(a){};eeUser.prototype.doLogout=function(){};eeUser.prototype.doSignup=function(){};eeUser.prototype.onLogin=function(){};eeUser.prototype.openChat=function(){};function eeVendor(){return this instanceof eeVendor?this:new eeVendor}
eeVendor.prototype.name=null;eeVendor.prototype.partNumberLabel=null;eeVendor.prototype.partNumberKey=null;eeVendor.prototype.init=function(){};eeVendor.prototype.getName=function(){return this.name?this.name:l("vendor")};eeVendor.prototype.setPartSearch=function(a){this.partSearch=a};eeVendor.prototype.getSearchTitle=function(){return l("vendor_search",{vendor:this.getName()})};eeVendor.prototype.getVendorPartNumberTitle=function(){return l("vendor_partnumber",{vendor:this.getName()})};
eeVendor.prototype.getVendorPartNumberLink=function(a,b,c){var d=c;a&&b&&(d='<a href="'+this.getVendorPartNumberLinkUrl(a,b)+'" target="_blank">'+c+"</a>");return d};eeVendor.prototype.getVendorPartNumberLinkUrl=function(a,b){};eeVendor.prototype.getVendorPartNumberLabel=function(){return this.partNumberLabel};eeVendor.prototype.getVendorPartNumberKey=function(){return this.partNumberKey};function dkVendor(){return this instanceof dkVendor?this:new dkVendor}mxUtils.extend(dkVendor,eeVendor);
dkVendor.prototype.name="Digi-Key";dkVendor.prototype.partNumberLabel="digikey_part_number";dkVendor.prototype.partNumberKey="dkpn";dkVendor.prototype.init=function(){this.partSearch&&this.partSearch.init()};dkVendor.prototype.getVendorPartNumberLink=function(a,b,c){var d=c;a&&b&&(a=this.getVendorPartNumberLinkUrl(a,b),d="<a onClick=\"EEWeb.app.getUtils().trackBomLink('"+a+"', '"+b+'\')" href="'+a+'" target="_blank">'+c+"</a>");return d};
dkVendor.prototype.getVendorPartNumberLinkUrl=function(a,b){return"http://"+EEWeb.helper.getDomainName()+"/product-detail/"+eeServerData.sess_language+"/"+b+"/"+a};
function eeApp(){return"undefined"!==typeof EEWeb.app?EEWeb.app:this instanceof eeApp?(this.projectHandler=null,this.resetPages(),this.linestyleMgr=this.labelmanager=this.validator=this.compdialog=this.partSearch=this.graph=this.editor=this.guiObject=this.utilsObject=this.userObject=this.bomObject=this.componentMgr=this.currentPage=null,EEWeb.app=this,this):new eeApp}eeApp.prototype.getProjectHandler=function(){return this.projectHandler};eeApp.prototype.getComponentMgr=function(){return this.componentMgr};
eeApp.prototype.getBom=function(){return this.bomObject};eeApp.prototype.getUser=function(){return this.userObject};eeApp.prototype.getLabelManager=function(){return this.labelmanager};eeApp.prototype.getUtils=function(){return this.utilsObject};eeApp.prototype.getValidator=function(){return this.validator};eeApp.prototype.getComponentDialog=function(){return this.compdialog};eeApp.prototype.getShortcutKeysDialog=function(){return this.shortcutkeysdialog};eeApp.prototype.getGraph=function(){return this.graph};
eeApp.prototype.getModel=function(){return this.graph.model};eeApp.prototype.getView=function(){return this.graph.view};eeApp.prototype.getEditor=function(){return this.editor};eeApp.prototype.getGui=function(){return this.guiObject};eeApp.prototype.getLinestyle=function(){return this.linestyleMgr};eeApp.prototype.getVendor=function(){return this.vendor};eeApp.prototype.resetPages=function(){this.schematicPages=[];this.currentPage=null};eeApp.prototype.pageCount=function(){return this.schematicPages.length};
eeApp.prototype.getDefaultPageName=function(){for(var a=l("default_page_name")+(this.pageCount()+1),b=a,c=1,d=this.getPageNames();_.contains(d,b);)b=a+"."+c,c+=1;return b};eeApp.prototype.addPage=function(a,b){b=_.defaults(b||{},{layer:a,name:"",scale:1,pos:new mxPoint(0,0)});""===b.name&&(b.name=this.getDefaultPageName());a.pageName=b.name;this.schematicPages.push(b)};
eeApp.prototype.deletePage=function(a){var b=this.schematicPages[a];this.schematicPages[a]=null;this.schematicPages=_.filter(this.schematicPages,function(a){return null!==a});return b};eeApp.prototype.getCurrentPage=function(){var a=this.schematicPages[this.currentPage];return a?a.layer:null};eeApp.prototype.getPageNames=function(){return _.pluck(this.schematicPages,"name")};eeApp.prototype.setPageName=function(a,b){this.schematicPages[a].name=b};
eeApp.prototype.setPagePosScale=function(a,b){var c=this.schematicPages[a];c.scale=b.scale;c.pos=b.pos};eeApp.prototype.getPagePosScale=function(a){a=this.schematicPages[a];return{scale:a.scale,pos:a.pos}};eeApp.prototype.onProjectNew=function(){this.syncComponentLabels();this.syncPagesToNewModel()};eeApp.prototype.onProjectLoad=function(a){this.syncComponentLabels();this.syncPagesToNewModel();this.getEditor().resetHistory()};
eeApp.prototype.onProjectLoadComplete=function(a){EEWeb.log.info("eeApp.onProjectLoadComplete");a=this.getModel().filterDescendants(function(a){return a instanceof eeComp});for(var b=EEWeb.app.getComponentMgr(),c=0,d=a.length;c<d;c++){var e=a[c];e.pid?(EEWeb.log.info("Component "+e.id+" pid = "+e.pid),b.getComponentByPid(e.pid)&&EEWeb.log.info("Found matching component")):EEWeb.log.info("Component "+e.id+" pid = NONE")}};eeApp.prototype.setSplashStatus=function(a){$("#splash p.status").text(l("initializingapp"))};
eeApp.prototype.init=function(){this.windowHash=window.location.hash;this.setSplashStatus("Initializing application...");mxLog.show=function(){};mxLog.debug=function(){for(var a="",b=0;b<arguments.length;b++)a+=arguments[b],b<arguments.length-1&&(a+=" ");EEWeb.eventLog.logError(a,"mxGraph Library","0")};this.addUnderscoreMixins();this.addJqueryExtensions();this.createCommonObjects();this.createObjects();$(window).resize(function(a,b){amplify.publish(EEWeb.events.RESIZE,new ALEvent({}))});this.preloadData();
this.createGraph();this.createGui();this.initGraph();this.initListeners();this.initGui();this.initObjects();this.initPages();this.initProject();this.initFinal()};eeApp.prototype.initProject=function(){this.getProjectHandler().setModified(!1)};eeApp.prototype.initFinal=function(){amplify.publish(EEWeb.events.APP_LOADED,new ALEvent({}))};eeApp.prototype.preloadData=function(){this.setSplashStatus("Loading component data...");var a=this.utilsObject;a.loadStencils();this.loadComponentData(a);a.loadVendorData()};
eeApp.prototype.loadComponentData=function(a){a.loadComponents();a.loadSymbols();a.loadCustomSymbols();amplify.publish(EEWeb.events.COMPONENTS_LOADED)};eeApp.prototype.createCommonObjects=function(){this.setSplashStatus("Creating objects...");EEWeb.helper=new eeHelper;this.componentMgr=new eeCompMgr;this.validator=new eeValidationRules;this.compdialog=new eeComponentDlg("#properties",l("componentproperties"));this.shortcutkeysdialog=new eeShortcutKeysDialog;this.labelmanager=new eeLabelManager};
eeApp.prototype.createObjects=function(){throw"eeApp.createObjects must be overridden.";};eeApp.prototype.initObjects=function(){EEWeb.helper.init();this.getProjectHandler().init();this.getVendor().init();this.getBom().init();this.getUser().init();this.getLabelManager().init()};
eeApp.prototype.initListeners=function(){var a=this;amplify.subscribe(EEWeb.events.RESIZE,function(){a.onResize()});amplify.subscribe(EEWeb.events.LOAD_PROJECT,function(b){a.onProjectLoad(b)});amplify.subscribe(EEWeb.events.LOAD_PROJECT_COMPLETE,function(b){a.onProjectLoadComplete(b)});amplify.subscribe(EEWeb.events.NEW_PROJECT,function(b){a.onProjectNew(b)});amplify.subscribe(EEWeb.events.PAGE_CLICK,function(b){a.setSchematicPage(b.index);a.focusOnSchematic()});amplify.subscribe(EEWeb.events.PAGE_ADD,
function(b){a.addSchematicPage();a.focusOnSchematic()});amplify.subscribe(EEWeb.events.PAGE_EDIT,function(b){a.editSchematicPageName(b.index)});amplify.subscribe(EEWeb.events.PAGE_NAME_CHANGE,function(b){a.onPageNameChange(b.index,b.name)});amplify.subscribe(EEWeb.events.PAGE_DELETE,function(b){a.onPageDelete(b.index)})};
eeApp.prototype.getSchematicPoint=function(a,b){var c=this.view.scale,d=$("#schematic-wrapper"),e=d.offset(),f=d.scrollLeft()/c+(b-e.left)/c,c=d.scrollTop()/c+(a-e.top)/c;return new mxPoint(f,c)};eeApp.prototype.getSchematicPointNoScale=function(a,b){var c=$("#schematic-wrapper"),d=c.offset(),e=c.scrollLeft()+(b-d.left),c=c.scrollTop()+(a-d.top);return new mxPoint(e,c)};
eeApp.prototype.onResize=function(){EEWeb.eventLog.logEvent("eeApp.onResize","");this.adjustBomTable();this.getGraph().sizeDidChange();amplify.publish(EEWeb.events.RESIZE_DONE,new ALEvent({}))};
eeApp.prototype.adjustBomTable=function(){var a=parseFloat($("#bom_page").height()),b=$(".dataTables_scrollHead","#bom_table_wrapper").height();$(".dataTables_scrollBody").css("top",b+"px");var c=$(".dataTables_scroll","#bom_table_wrapper").css("top"),a=a-(parseFloat(c)+parseFloat(b));$(".dataTables_scrollBody").height(a+"px")};eeApp.prototype.clearTimeout=function(a){};
eeApp.prototype.createPin=function(a,b,c,d,e,f,g,h,k){a=new mxGeometry(d,e,f,g);c=new eePin(c,a,h,k);c.setId(b);c.setVertex(!0);c.setConnectable(!0);return c};
eeApp.prototype.insertComponent=function(a,b,c,d,e,f,g,h,k,m,n){EEWeb.eventLog.logEvent("eeApp.insertComponent","");f=new mxGeometry(e,f,g,h);e=null;e=new eeComp(a,c,f,k,b,"?",d);e.setVertex(!0);e.setConnectable(!1);a=this.getGraph();a.addCell(e,a.getDefaultParent());n&&e.setLabelStart(n);if(null!=m)for(n=0;n<m.length;n++)this.addComponentLabel(e,m[n]);return e};
eeApp.prototype.addComponentLabel=function(a,b){var c=b.name,d=b.lbldefault,e=a.getParameter(c),f=null;null===e&&(e=d);"pos"in b&&(f=new eeLabelGeometry(b.pos,b.line,b.anchor,b.dir));return a.addComponentLabel(c,e,f)};
eeApp.prototype.addCustomComponent=function(a,b,c,d,e,f,g,h,k,m){EEWeb.eventLog.logEvent("eeApp.addCustomComponent","");e=new mxGeometry(d,e,f,g);d=null;d=new eeCusComp(b,e,h,a,"?",c);d.setVertex(!0);d.setConnectable(!1);a=this.getGraph();a.addCell(d,a.getDefaultParent());m&&d.setLabelStart(m);if(null!=k)for(m=0;m<k.length;m++)this.addComponentLabel(d,k[m]);return d};
eeApp.prototype.addSmartPin=function(a,b,c,d,e,f,g,h,k){EEWeb.eventLog.logEvent("eeApp.addSmartPin","");g=new mxGeometry(0,0,g,h);g.offset=new mxPoint(e,f);g.relative=!0;b=new eeCell(b,g,k);b.isSmartPin=!0;b.setVertex(!0);b.setConnectable(!1);b.pinNumber=c;c=EEWeb.app.getGraph();switch(d){case "Top":case "Bottom":mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);break;case "Left":mxUtils.setCellStyles(c.model,
[b],mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_RIGHT);mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT);break;case "Right":mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_LEFT),mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)}switch(d){case "Top":mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_BOTTOM);mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_VERTICAL_ALIGN,
mxConstants.ALIGN_TOP);break;case "Bottom":mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_TOP);mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM);break;case "Left":case "Right":mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),mxUtils.setCellStyles(c.model,[b],mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)}b.pinLoc=d;this.getGraph().addCell(b,a);
b.setConnectable(!1);return b};
eeApp.prototype.addPin=function(a,b,c,d){var e=b.label?"pin-label-"+b.label:"pin-label-top",f="horizontal";if("north"==b.direction||"south"==b.direction)f="vertical";e=e+";portConstraint="+f+";pinDirection="+b.direction;c=b.pinNumber?b.pinNumber:c;var f=b.text?b.text:null,g=new mxPoint(0,0);null!=b.position&&(g=new mxPoint(b.position.x,b.position.y));var h=new mxPoint(8,8);null!=b.dimensions&&(h=new mxPoint(b.dimensions.x,b.dimensions.y));e=this.createPin(a,b.id,f,g.x,g.y,h.x,h.y,e,c);d&&e.setPortNet(d);
this.getGraph().addCell(e,a);e.geometry.offset=new mxPoint(b.offset.x,b.offset.y);e.geometry.relative=!0;e.direction=b.direction;return e};eeApp.prototype.syncComponentLabels=function(){var a=this.getModel().filterDescendants(function(a){return a instanceof eeComp});_.each(a,function(a){a.syncLabels()})};eeApp.prototype.initPages=function(){this.syncPagesToNewModel()};
eeApp.prototype.syncPagesToNewModel=function(){var a=this.getModel(),b=a.getRoot().children;this.resetPages();var c=this.getGui(),d=0;_.each(b,function(b){this.addPage(b,{name:b.pageName});a.visibleStateForCellChanged(b,!1);this.setSchematicPage(d);c.scalePages();d++},this);this.setSchematicPage(0);this.getView().invalidate();this.getView().validate();amplify.publish(EEWeb.events.UPDATE_PAGE_COUNT,new ALEvent({numPages:this.pageCount(),pages:this.getPageNames()}))};
eeApp.prototype.setSchematicPage=function(a){if(a<this.pageCount()){var b=this.currentPage;if(null!==this.currentPage){this.getGraph().clearSelection();var c=this.getGraph().getPosScale();this.setPagePosScale(this.currentPage,c);this.getModel().visibleStateForCellChanged(this.getCurrentPage(),!1)}this.currentPage=a;this.getModel().visibleStateForCellChanged(this.getCurrentPage(),!0);this.defaultParent=this.getCurrentPage();this.getView().setCurrentRoot(this.getCurrentPage());(a=this.getPagePosScale(a))&&
amplify.publish(EEWeb.events.ZOOM_POS_TO,new ALEvent(a));this.getView().invalidate();amplify.publish(EEWeb.events.PAGE_CHANGED,new ALEvent({prev:b,curr:this.currentPage}))}};
eeApp.prototype.addSchematicPage=function(){if(this.pageCount()<=eeConstants.MAX_PAGE_CNT){var a=this.graph.model.getRoot(),b=new mxCell;this.graph.addCell(b,a);a=this.addPage(b);pageNum=this.pageCount()-1;amplify.publish(EEWeb.events.UPDATE_PAGE_COUNT,new ALEvent({numPages:this.pageCount(),pages:this.getPageNames()}));this.setSchematicPage(pageNum);amplify.publish(EEWeb.events.PAGE_ADDED,new ALEvent({numPages:this.pageCount(),pages:this.getPageNames(),newpage:a}))}};
eeApp.prototype.editSchematicPageName=function(a){a=$("#pages li").eq(a);a.width();a.height();$.trim(a.html())};eeApp.prototype.onPageNameChange=function(a,b){this.getModel().getRoot().children[a].pageName=b;this.setPageName(a,b)};eeApp.prototype.isPageEmpty=function(a){var b=!1;null===a.children?b=!0:0===a.children.length&&(b=!0);return b};
eeApp.prototype.onPageDelete=function(a){var b=this.getModel().getRoot().children,c=this;a<b.length&&(this.isPageEmpty(b[a])?c.deleteSchematicPage(a):(b=[],b.push("<div>"),b.push(l("delete_pagenotempty")),b.push(l("confirm_proceeddelete")),b.push("</div>"),$(b.join("")).dialog({title:l("delete_page"),resizable:!1,buttons:[{text:l("cancel"),click:function(){$(this).dialog("close")}},{text:l("CONFIRM"),click:function(){$(this).dialog("close");c.deleteSchematicPage(a)}}],draggable:!1,modal:!0,dialogClass:"graph-popup-dialog",
close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})))};
eeApp.prototype.deleteSchematicPage=function(a){var b=this.getModel().getRoot().children;null!==this.currentPage&&(this.getGraph().clearSelection(),this.getModel().visibleStateForCellChanged(this.getCurrentPage(),!1));a<b.length&&this.getGraph().removeCells([b[a]]);this.currentPage=null;a=this.deletePage(a);amplify.publish(EEWeb.events.PAGE_DELETED,new ALEvent({numPages:this.pageCount(),pages:this.getPageNames(),deletedpage:a.name}));amplify.publish(EEWeb.events.UPDATE_PAGE_COUNT,new ALEvent({numPages:this.pageCount(),
pages:this.getPageNames()}));this.setSchematicPage(0);this.validateView()};eeApp.prototype.currentView=function(){return this.getGraph().getView()};eeApp.prototype.beginUpdate=function(){var a=this.getGraph();a&&a.model.beginUpdate()};eeApp.prototype.endUpdate=function(){var a=this.getGraph();a&&a.model.endUpdate()};eeApp.prototype.validateView=function(){var a=this.getGraph();a&&a.getView().validate()};eeApp.prototype.addModelListener=function(a,b){this.graph.model.addListener(a,b)};
eeApp.prototype.addSelModelListener=function(a,b){this.graph.getSelectionModel().addListener(a,b)};eeApp.prototype.addGraphListener=function(a,b){this.graph.addListener(a,b)};eeApp.prototype.addMouseListener=function(a){this.graph.addMouseListener(a)};eeApp.prototype.initGraph=function(){};eeApp.prototype.initGui=function(){};
eeApp.prototype.addUnderscoreMixins=function(){_.mixin({toEngineering:function(a,b){var c=parseFloat(a);if(0===c)return 0;var d=Math.ceil(Math.log(Math.abs(c))/Math.log(10)),e=0,e=0>d?d-(3+d%3):d-d%3,c=c*Math.pow(10,-1*e),c=void 0===b?100<Math.abs(c)?c.toFixed(0):10<Math.abs(c)?c.toFixed(1):1<Math.abs(c)?c.toFixed(2):c.toFixed(3):c.toPrecision(b);e&&(c+="e"+e);return c},pad:function(a,b){return a.length<b?_.pad("0"+a,b):a},spadright:function(a,b){return a.length<b?_.spadright(a+" ",b):a},spadleft:function(a,
b){return a.length<b?_.spadleft(" "+a,b):a}})};
eeApp.prototype.addJqueryExtensions=function(){$.fn.tabbedDialog=function(a){this.tabs();this.dialog(a);this.find(".ui-tab-dialog-close").append($("a.ui-dialog-titlebar-close"));this.find(".ui-tab-dialog-close").css({position:"absolute",right:"0",top:"23px"});this.find(".ui-tab-dialog-close > a").css({"float":"none",padding:"0"});a=this.find("ul:first");this.parent().addClass("ui-tabs").prepend(a).draggable("option","handle",a);this.siblings(".ui-dialog-titlebar").remove();a.addClass("ui-dialog-titlebar")};
(function(a){var b=0;a.getScrollbarWidth=function(){if(!b)if(AspenLabs.isVersion){var c=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:-1E3}).appendTo("body"),d=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:-1E3}).appendTo("body");b=c.width()-d.width();c.add(d).remove()}else c=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:-1E3}).prependTo("body").append("<div />").find("div").css({width:"100%",
height:200}),b=100-c.width(),c.parent().remove();return b}})(jQuery)};eeApp.prototype.autoLoad=function(){var a=window.location.hash,b=EEWeb.app.getProjectHandler();a&&a.match(/#(\d+)/)?(a=a.match(/#(\d+)/)[1],b.openFile(null,a)):null!==eeServerData.loadProject&&""!==eeServerData.loadProject&&b.openFile(null,eeServerData.loadProject)};
eeApp.prototype.addCellShortcuts=function(){mxCell.prototype.getGraph=function(){return EEWeb.app.getGraph()};mxCell.prototype.getModel=function(){return EEWeb.app.getModel()};mxCell.prototype.getView=function(){return EEWeb.app.getView()}};eeApp.prototype.focusOnSchematic=function(){$("#schematic").focus()};eeApp.prototype.isSpecificManufacturer=function(){return eeServerData.specificManufacturerName?!0:!1};eeApp.prototype.getSpecificManufacturer=function(){return eeServerData.specificManufacturerName};
function eeLabelManager(){return EEWeb.lblmgr&&"undefined"!==typeof EEWeb.lblmgr?EEWeb.lblmgr:this instanceof eeLabelManager?this:new eeLabelManager}eeLabelManager.prototype.init=function(){var a=this;amplify.subscribe(EEWeb.events.COMPONENT_UPDATED,function(b){if("label"!==b.source)a.onComponentUpdated(b)})};
eeLabelManager.prototype.onComponentUpdated=function(a){var b=a.value,c=a.readonly;if(a=a.cell.getLabelByName(a.name))a.updateLabelValue(b),c&&EEWeb.app.getGraph().setCellStyles(mxConstants.STYLE_EDITABLE,0,[a])};function dkProject(){return this instanceof eeProject?(eeProject.call(this),this.stencilxml=null,EEWeb.project=this,this):new dkProject}mxUtils.extend(dkProject,eeProject);dkProject.prototype.getSessionDataName=function(){return"dkSessionData"};
dkProject.prototype.setId=function(a){eeProject.prototype.setId.call(this,a);a?window.location.hash="#"+this.idToHash(this.getId()):(a=window.location,"pushState"in history?history.pushState("",document.title,a.pathname+a.search):(scrollV=document.body.scrollTop,scrollH=document.body.scrollLeft,a.hash="",document.body.scrollTop=scrollV,document.body.scrollLeft=scrollH))};dkProject.prototype.getPublicData=function(a){return{name:this.name,id:this.getId(),isPublic:a}};
dkProject.prototype.getURL=function(a){var b="";switch(a){case "permissions":b=EEBasepath+"/../save/permissions";break;case "share":b=EEBasepath+"/../share";break;case "open":b=EEBasepath+"/../open";break;case "delete":b=EEBasepath+"/../delete";break;case "save_session":b=EEBasepath+"/../save/session";break;case "save":b=EEBasepath+"/../save";break;case "save_check":b=EEBasepath+"/../save/check-name"}return b};
dkProject.prototype.getProjectData=function(){var a=eeProject.prototype.getProjectData.call(this),b=this.getStencilList(),c=this.getStencilShapes(b),c=this.getStencilXml(c);a.stencillist=b.join();a.stencilxml=c;a.BOM=JSON.stringify(EEWeb.app.getBom().getView().getArray());return a};
dkProject.prototype.initHandlers=function(){eeProject.prototype.initHandlers.call(this);var a=this;amplify.subscribe(EEWeb.events.OPEN_REFERENCE_DESIGN_PROJECT,function(b,c){var d=a.hashToId(c);a.openReferenceDesignProject(b,d)})};
dkProject.prototype.restoreProject=function(a){EEWeb.eventLog.logEvent("dkProject","restore");this.clearProject();this.stencilxml=a.project.stencilxml;this.stencillist=a.project.stencillist?a.project.stencillist.split(","):[];var b=this.loadProjectStencils(a.project.model);this.summary=a.project.summary;this.description=a.project.description;this.model=a.project.model;this.view=a.project.project_view;this.version=a.project.version;this.setId(a.project.project_id);this.setOwnerId(a.project.loginId);
this.setName(a.project.project_name);this.setNew(!1);this.setPublic(0==a.project.nflag_public?!1:!0);var c=this;$.when(b).then(function(){console.log("Deferred project load resolved.");c.restoreGraphModel(a.project.model);c.notifyProjectLoaded();c.setModified(!1);amplify.publish(EEWeb.events.ZOOM_FIT);c.onRestoreProjectSession()}).fail(function(){console.log("Deferred project load failed.")})};
dkProject.prototype.doExport=function(){EEWeb.eventLog.logEvent("dkProject","export");var a=this;$("#export_dialog").dialog({title:l("exportcurrent_page"),resizable:!1,modal:!0,draggable:!1,dialogClass:"graph-popup-dialog export_dialog",buttons:[{text:l("exportcurrent_page_cancel"),click:function(){$(this).dialog("close")}},{text:l("exportcurrent_page_export"),click:function(){var b="."+$("input[name=format]:checked",this).val(),c="shrink"===$("select[name=shrink]",this).val(),d="current"===$("input[name=export_pages]:checked",
this).val(),e=$("input[name=export_page_orientation]:checked",this).val(),f=$("select[name=paper_size]",this).val(),b={extension:b,currentPage:d,orientation:e,shrink:c,paperSize:f};$(this).dialog("close");a.exportProject(b)}}],open:function(){$("input[name=format]:checked",this).click()},close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})};
dkProject.prototype.exportProject=function(a){a=_.defaults(a||{},{extension:".png",currentPage:!0,orientation:"none",shrink:!0,paperSize:"none"});var b=a.extension;switch(b){case ".xml":amplify.publish(EEWeb.events.BOM_EXPORT_XML,new ALEvent({extension:b}));break;case ".pdf":"freesize"==a.paperSize?this.exportSchematic(b,a.shrink):a.currentPage?this.exportSchematic(b,!0,a.orientation,a.paperSize):this.exportSchematicAllPages(b,!0,a.orientation,a.paperSize);break;default:this.exportSchematic(b,a.shrink)}};
dkProject.prototype.getExportData=function(a,b,c,d){var e=EEWeb.app.getUtils();a=EEWeb.app.getUtils().exportSvgFromGraph(a,c,d);e=e.stripSpecialChars(this.name,"schemeit-"+l("project"));return{w:Math.ceil(a.bounds.width),h:Math.ceil(a.bounds.height),svg:window.encodeURIComponent(a.svg),filetype:b,projectname:e}};
dkProject.prototype.getExportDataAllPages=function(a,b,c,d){var e=EEWeb.app,f=e.getUtils(),g=e.getPageNames(),h=e.pageCount(),k=e.currentPage,m=0,n={},p,q;c=c||"none";d=d||"none";_.each(g,function(b){e.setSchematicPage(m);p=f.exportSvgFromGraph(a,c,d);m+=1;q={pagename:b,w:Math.ceil(p.bounds.width),h:Math.ceil(p.bounds.height),svg:window.encodeURIComponent(p.svg)};n[m]=q});e.setSchematicPage(k);g=f.stripSpecialChars(this.name,"schemeit-"+l("project"));return{data:JSON.stringify(n),pagecount:h,filetype:b,
projectname:g}};dkProject.prototype.exportSchematic=function(a,b,c,d){b=this.getExportData(b,a,c,d);c=_.clone(amplify.request.resources.ajaxSubmit_export);a=c.url+b.projectname+a;$("<form method='post' />").appendTo("body").ajaxSubmit(_.extend(c,{url:a,data:b}))};
dkProject.prototype.exportSchematicAllPages=function(a,b,c,d){b=this.getExportDataAllPages(b,a,c,d);c=_.clone(amplify.request.resources.ajaxSubmit_exportAllPages);a=c.url+b.projectname+a;$("<form method='post' />").appendTo("body").ajaxSubmit(_.extend(c,{url:a,data:b}))};
dkProject.prototype.restoreSession=function(a){var b=this,c=a?a:this.getSessionData();c&&(console.log("Restoring session.."),this.initializeProject(),a=this.loadProjectStencils(c.model),this.setId(c.project_id),this.setPublic(c.isPublic?!0:!1),this.summary=c.summary,this.description=c.description,this.model=c.model,this.isSaving=c.isSaving,this.isSaveAs=c.isSaveAs,this.setName(c.name),this.setNew(c.isNew?!0:!1),this.version=c.version?c.version:"1.0",$.when(a).then(function(){console.log("Deferred project load resolved.");
b.restoreGraphModel(c.model);b.notifyProjectLoaded();b.setModified(c.modified);amplify.publish(EEWeb.events.ZOOM_FIT);b.doSaveOnSessionRestore()}).fail(function(){console.log("Deferred project load failed.")}),EEWeb.app.getEditor().resetHistory())};
dkProject.prototype.getCompStyles=function(a){a=mxUtils.parseXml(a).documentElement;for(var b="",c=!1,d=[],e=this.getFirstComp(a);null!=e;)"mxGraphModel"==a.nodeName?(c=e.attributes)&&c.style&&(b=c.style.nodeValue):b=e.getAttribute("style"),(c=b&&b.match(/component_[a-zA-Z0-9]*/g)&&0<b.match(/component_[a-zA-Z0-9]*/g).length)&&d.push({style:b}),e=e.nextSibling;return d};
dkProject.prototype.getFirstComp=function(a){var b=null,b="root"==a.nodeName?a:a.getElementsByTagName("root")[0],b=b.firstChild;"mxGraphModel"==a.nodeName&&(b=b.nextSibling);return b};dkProject.prototype.getProjectNameLimit=function(){return eeServerData.projectNameLimit?eeServerData.projectNameLimit:50};
dkProject.prototype.openReferenceDesignProject=function(a,b){if(this.modified){var c=this;this.onSaveModified({self:this,cancel:null,dontsave:function(){EEWeb.eventLog.sendReferenceDesignEvent(a,b);c.openFile(a,b)},save:function(){c.doSave()}})}else EEWeb.eventLog.sendReferenceDesignEvent(a,b),this.openFile(a,b)};function dkUser(){return EEWeb.user&&"undefined"!==typeof EEWeb.user?EEWeb.user:this instanceof dkUser?(eeUser.call(this),EEWeb.user=this,this.chatWindow=null,this):new dkUser}
mxUtils.extend(dkUser,eeUser);dkUser.prototype.setUserData=function(a){a?(this.name=a.user_name,this.email=a.email.replace(/\*/g,""),this.id=a.loginid,this.setLoggedIn(a.logged_in),EEWeb.eventLog.setUserContext({name:this.name,email:this.email,id:this.id})):(this.id=this.email=this.name=null,this.setLoggedIn(!1),EEWeb.eventLog.setUserContext());this.fireUserUpdate()};
dkUser.prototype.fireUserUpdate=function(){var a="",b="";if("string"===typeof this.name){var c=this.name.split(" ");1===c.length?a=c[0]:1<c.length&&(a=c.shift(),b=c.join(" "))}amplify.publish(EEWeb.events.USER_UPDATED,new ALEvent({first:a,last:b,name:this.name,email:this.email,uid:this.id,bLoggedIn:this.isLoggedIn()}))};dkUser.prototype.init=function(){eeUser.prototype.init.call(this);this.queryLoggedIn()};dkUser.prototype.loginQueryUrl=function(){return EEBasepath+"/../account/logged-in"};
dkUser.prototype.loginUrl=function(){return eeServerData.loginurl?eeServerData.loginurl:""};dkUser.prototype.logoutUrl=function(){return EEBasepath+"/../account/logout"};
dkUser.prototype.getLoginMessage=function(a){var b=[];if("21ic"!==eeServerData.accountHost)return b.push("<p>"+l("alert_login_digikey_proj")+"</p>"),b.join("");a=null!=a?'<dt id="error_msg"><dd>'+a+"<br /></dd></dt>":"";b.push("<div>");b.push("<p>"+l("must_login")+"</p>");b.push('<dl class="zend_form">');b.push(a);b.push('<dt id="email-label"><label for="email" class="required">'+l("username")+":</label></dt>");b.push('<dd id="email-element">');b.push('<input type="text" name="email" id="email" value=""></dd>');
b.push('<dt id="password-label"><label for="password" class="required">'+l("login_partsim_password")+"</label></dt>");b.push('<dd id="password-element">');b.push('<input type="password" name="password" id="password" value=""></dd>');b.push("</dl>");b.push(l("dont_have_account_partsim")+"<br/>");b.push("<a href='register/?come_from=bbs&referer=http://"+location.host+"' target='_blank'>"+l("login_partsim_register")+"</a>");b.push("</div>");return b.join("")};
dkUser.prototype.calcLoginURL=function(a){var b=null,c=null,b=null,b=document.location.href;0===a.search(/^http[s]?:/)?b=a.replace("%s",encodeURIComponent(b)):(c=b,b=b.replace(/\/#.*$/,"/"),b=b.replace(/\/editor\/.*$/i,"/"),EEWeb.app.isSpecificManufacturer()&&(b=b.replace(/#.*$/,""),"/"!=b.charAt(b.length-1)&&(b+="/")),""!==eeServerData.autoProjId&&(b=b.replace(RegExp("/"+eeServerData.autoProjId+"/(?:[^/]+/)?"),"/")),b+=a.replace("%s",encodeURIComponent(c)));EEWeb.log.info("Set document.location.href to "+
b);return b};dkUser.prototype.loginLocation=function(){var a=null,a=this.calcLoginURL(this.loginUrl());EEWeb.log.info("Set document.location.href to "+a);document.location.href=a};dkUser.prototype.queryLoggedIn=function(){var a=this;amplify.request({resourceId:"loggedin_query",success:function(b,c){a.setUserData(b)},error:function(b,c,d){a.setUserData(null)}})};
dkUser.prototype.doLogin=function(a){var b=EEWeb.project;EEWeb.eventLog.logEvent("eeUser.doLogin","");"21ic"==eeServerData.accountHost&&(this.isProjectModified()&&$.cookie("resumeSession","1"),EEWeb.skip_unload_callback=!0);var c=this;a=this.getLoginMessage(a);$(a).dialog({title:l("login"),resizable:!1,buttons:[{text:l("login_cancel_button"),click:function(){$(this).dialog("close")}},{text:l("login_button"),click:function(){if("21ic"!==eeServerData.accountHost)c.onLogin();else c.apiLogin(),$(this).dialog("close")}}],
draggable:!1,modal:!0,dialogClass:"graph-popup-dialog",close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));b.isSaving=!1;$(this).remove()}})};dkUser.prototype.doLogout=function(){var a=this,b=EEWeb.project;this.logoutUrl();window.location.hostname.match(/\.digikey\.com$/);if(b.isModified())b.onSaveModified({self:this,cancel:null,dontsave:function(){a.sendLogoutRequest()},save:function(){b.doSave()}});else a.sendLogoutRequest()};
dkUser.prototype.sendLogoutRequest=function(){var a=this,b=EEWeb.project;amplify.request({resourceId:"logout",success:function(c,d){a.setUserData(null);window.location.hash="";b.setName(l("newproject"));b.setModified(!0)}})};dkUser.prototype.doSignup=function(){this.isProjectModified()&&$.cookie("resumeSession","1");EEWeb.skip_unload_callback=!0;window.location="account/register"};
dkUser.prototype.onLogin=function(){this.isProjectModified()&&$.cookie("resumeSession","1");EEWeb.skip_unload_callback=!0;this.loginLocation()};dkUser.prototype.openChat=function(){var a=EEWeb.helper.getChatUrl();this.chatWindow?this.chatWindow.closed?this.chatWindow=window.open(a,"schemeit_live_chat","width=560,height=510,toolbar=no,scrollbars=no,menubar=no,location=no"):this.chatWindow.focus():this.chatWindow=window.open(a,"schemeit_live_chat","width=560,height=510,toolbar=no,scrollbars=no,menubar=no,location=no")};
dkUser.prototype.doContactUs=function(){window.open(eeServerData.contactusurl,"_blank")};dkUser.prototype.apiLogin=function(){var a=this,b={id:0,username:$("#email").val(),password:$("#password").val()};amplify.request({resourceId:"login",data:b,success:function(b,d){b.error?a.doLogin(b.error):a.setUserData(b.user)},error:function(a,b){}})};function dkApp(){return void 0!==EEWeb.app?EEWeb.app:this instanceof dkApp?(eeApp.call(this),EEWeb.app=this,this):new dkApp}mxUtils.extend(dkApp,eeApp);
dkApp.prototype.onResize=function(a){!1!==this.timeout&&this.clearTimeout(this.timeout);AspenLabs.ieVersion&&8>=AspenLabs.ieVersion?this.timeout=setTimeout(function(){amplify.publish(EEWeb.events.REPOS_DIALOGS,new ALEvent({}))},200):amplify.publish(EEWeb.events.REPOS_DIALOGS,new ALEvent({}));a=$("#pagetab_div");var b=$("ul",a).height(),b=Math.ceil(b/30);EEWeb.log.info("Number of lines:"+b);a.css("top",-30*(b-1)+"px");this.adjustBomTable();a=$("#digikey_splitcontainer").height();a!==this.prevSplitContainerHeight&&
(this.prevSplitContainerHeight=a,$("#digikey_splitter").trigger("resize"));this.getGraph().sizeDidChange();amplify.publish(EEWeb.events.RESIZE_DONE,new ALEvent({}))};dkApp.prototype.preloadData=function(){this.setSplashStatus("Loading component data...");this.loadComponentData(this.utilsObject)};dkApp.prototype.loadComponentData=function(a){a.loadStencils();a.loadParameterSets();a.loadDynamicComponents();a.loadDynamicStencils();a.loadDynamicStencilDefs();amplify.publish(EEWeb.events.COMPONENTS_LOADED)};
dkApp.prototype.createObjects=function(){this.utilsObject=new dkUtils;this.projectHandler=new dkProject(this);this.bomObject=new dkBom(new dkBomView("#bom_table"));this.userObject=new dkUser;this.linestyleMgr=new eeLineStyle;this.vendor=new dkVendor;this.vendor.setPartSearch(new eePartSearch(new window[EEWeb.searchStrategy]))};dkApp.prototype.initObjects=function(){eeApp.prototype.initObjects.call(this)};dkApp.prototype.initListeners=function(){eeApp.prototype.initListeners.call(this)};
dkApp.prototype.initFinal=function(){amplify.publish(EEWeb.events.TAB_CLICK,new ALEvent({tab:"#tab_main"}));this.onResize();eeApp.prototype.initFinal.call(this)};dkApp.prototype.onProjectLoad=function(a){eeApp.prototype.onProjectLoad.call(this,a)};dkApp.prototype.createGraph=function(){this.editor=new dkEditor;this.graph=this.editor.graph;this.editor.setGraphContainer(document.getElementById("schematic"));this.editor.validating=!0};
dkApp.prototype.initGraph=function(){mxEdgeHandler.prototype.snapToTerminals=!0;eeConnectionHandler.prototype.movePreviewAway=!1;eeConnectionHandler.prototype.waypointsEnabled=!0;mxPanningHandler.prototype.useGrid=!0;mxShape.prototype.crisp=!1;mxGraphModel.prototype.maintainEdgeParent=!1;mxGraph.prototype.resetEdgesOnConnect=!1;mxGraphHandler.prototype.scaleGrid=!0;var a=EEWeb.app.getEditor().graph;a.connectionHandler.initKeyHandlers();mxGraph.prototype.stopEditing=function(b){a.stopEditing(b)};mxLog.show=
function(){};this.addCellShortcuts();a.minimumContainerSize=new mxRectangle(0,0,1920,1200);a.setExtendParents(!1);a.setExtendParentsOnAdd(!1);a.setConstrainChildren(!1);a.setCloneInvalidEdges(!0);a.setConstrainChildrenOnResize(!0);a.view.scale=1;a.setPanning(!0);a.setConnectable(!0);a.setConnectableEdges(!0);a.setDisconnectOnMove(!1);a.setDropEnabled(!0);a.foldingEnabled=!1;a.cellsResizable=!0;a.zoomFactor=2;a.centerZoom=!1;a.resizeContainer=!1;a.pageFormat=new mxRectangle(0,0,5E3,5E3);a.maximumGraphBounds=
new mxRectangle(0,0,5E3,5E3);a.pageScale=1;a.preferPageSize=!0;a.setAllowNegativeCoordinates(!1);a.view.validate();a.setEnterStopsCellEditing(!0);a.vertexLabelsMovable=!1;a.setTooltips(!0);mxEvent.disableContextMenu(document.getElementById("schematic"));AspenLabs.ieVersion&&8>=AspenLabs.ieVersion?setTimeout(function(){a.container.focus()},20):a.container.focus();a.addStyles()};dkApp.prototype.createGui=function(){this.guiObject=new dkGui(this)};
dkApp.prototype.initGui=function(){this.guiObject.init();var a=this.getComponentDialog();eeComp.prototype.propsDialog=a};dkApp.prototype.autoLoad=function(){var a=window.location.hash,a=a?a.match(/#([a-z0-9]+)/):null,b=this.getProjectHandler();a?(a=b.hashToId(a[1]),amplify.publish(EEWeb.events.AUTO_LOAD,new ALEvent({name:null,id:a}))):null!==(a=eeServerData.autoProjId)&&""!==a?(a=b.hashToId(a),amplify.publish(EEWeb.events.AUTO_LOAD,new ALEvent({name:null,id:a}))):amplify.publish(EEWeb.events.PROJECT_RESTORE_SESSION)};
dkApp.prototype.insertComponentSymbol=function(a,b,c,d,e,f,g,h,k,m,n){EEWeb.eventLog.logEvent("eeApp.insertComponent","");d=new mxGeometry(e,f,g,h);a=new eeCompSymbol(a,c,d,k,b,"");a.setVertex(!0);a.setConnectable(!0);b=this.getGraph();b.addCell(a,b.getDefaultParent());n&&a.setLabelStart(n);if(null!=m)for(n=0;n<m.length;n++)this.addComponentLabel(a,m[n]);return a};function dkEditor(a){eeEditor.apply(this,arguments)}mxUtils.extend(dkEditor,eeEditor);var embedEditorBase=dkEditor;
dkEditor.prototype.createGraph=function(){var a=new eeGraphModel,a=new dkGraph(null,a,this.graphRenderHint);return this.initNewGraph(a)};function dkGui(){return EEWeb.gui&&"undefined"!==typeof EEWeb.gui?EEWeb.gui:this instanceof dkGui?(eeGui.call(this),this.product=null,this.tacLoaded=!1,EEWeb.gui=this,this):new dkGui}mxUtils.extend(dkGui,eeGui);dkGui.prototype.init=function(){eeGui.prototype.init.call(this);this.addLineStyleActions();this.initFeedbackHandlers();var a=this;$("#view_terms").click(function(){a.showTAC()})};
dkGui.prototype.initHandlers=function(){eeGui.prototype.initHandlers.call(this);var a=this;amplify.subscribe(EEWeb.events.APP_LOADED,function(b){a.showInitialDialogs()});amplify.subscribe(EEWeb.events.COMP_DKBAR_HIDE,function(b){a.onCompDigikeyBarHide(b)});amplify.subscribe(EEWeb.events.COMP_DKBAR_SHOW,function(b){a.onCompDigikeyBarShow(b)});EEWeb.app.addSelModelListener(mxEvent.CHANGE,mxUtils.bind(this,function(b,c){a.toggleLineStyleButtons()}));var b=$("#export_dialog"),c=$("select[name=paper_size]",
b),d="",e=$("#image_export_title",b),f=$("#pdf_export_title",b),g=$("#pages_to_export",b),h=$("#selection_to_export",b),k=$("#orientation_to_export",b),m=$("#papersize_to_export",b);b.on("click",".image_export",function(a){f.hide();e.show();g.hide();h.show();k.hide();m.hide()});b.on("click",".pdf_export",function(b){f.show();e.hide();m.show();d=c.val();a.processPaperSize(d)});b.on("click",".xml_export",function(a){f.hide();e.hide();g.hide();h.hide();k.hide();m.hide()});c.on("change",function(b){d=
c.val();a.processPaperSize(d)})};dkGui.prototype.processPaperSize=function(a){var b=$("#export_dialog"),c=$("#pages_to_export",b),d=$("#selection_to_export",b),b=$("#orientation_to_export",b);"freesize"==a?(d.show(),c.hide(),b.hide()):(d.hide(),c.show(),b.show())};
dkGui.prototype.addEditorActions=function(){eeGui.prototype.addEditorActions.call(this);EEWeb.app.getEditor().addAction("undo",function(){EEWeb.eventLog.logEvent("dkGui.undo","");EEWeb.app.getEditor().undo();amplify.publish(EEWeb.events.REFRESH_BOM,new ALEvent({}))});EEWeb.app.getEditor().addAction("redo",function(){EEWeb.eventLog.logEvent("dkGui.redo","");EEWeb.app.getEditor().redo();amplify.publish(EEWeb.events.REFRESH_BOM,new ALEvent({}))})};
dkGui.prototype.addGuiActions=function(){eeGui.prototype.addGuiActions.call(this);$(".search_box_logo").click(function(){var a=EEWeb.helper.getHomePage();window.open(a,"_blank")});$("#line_style").on("mouseenter",".ls_option li",function(){var a=$(this);a.children(":first").hasClass("img")&&a.addClass("linestyle_hover")}).on("mouseleave",".ls_option li",function(){$(this).removeClass("linestyle_hover")});$level4=$(".level_4, #sidebar_components");$("input","#feedback").on("keyup",function(){var a=
$.trim($(this).val());""!=a&&EEWeb.app.getUtils().isValidEmailAddress(a)?$("#feeback_no_email_message").hide():$("#feeback_no_email_message").show()});var a=this;(function(){var b=null;$level4.on("mouseenter",".sidebar-component, .sidebar-sub-category-heading",function(){var c=$(this),d=c.offset(),e=$(".component-name",c),f=$.trim(e.text()),g=$.trim($(".component-description",c).text());""==f&&(e=c.children(":first"),f=$.trim(e.text()));var e=e.width(),h=$(".component-description",c).width(),e=Math.max(e,
h),c=$(c).width()-65;a.sidebarHasScrollbar()&&(c-=$.getScrollbarWidth());e>c?(g&&(f+="<br>"+g),$(this).append("<div id='l4_tipdiv' class='l4_tooltip classic'><span class=\"tooltip_fullname\">"+f+"</span></div>"),b=$("#l4_tipdiv"),b.css("top",d.top+"px")):b=null});$level4.on("mouseleave",".sidebar-component, .sidebar-sub-category-heading",function(){b&&(b.remove(),b=null)})})()};
dkGui.prototype.addToolbarActions=function(){var a=this,b=EEWeb.app.getProjectHandler(),c=EEWeb.app.getUtils();eeGui.prototype.addToolbarActions.call(this);$("#toolbar_line_style").click(function(){var b=$("#line_style_dialog");if(a.isLineStyleDlgOpen())b.dialog("close");else a.onLineStyle()});$("#toolbar_bom_quote").click(function(){amplify.publish(EEWeb.events.BOM_QUOTE,new ALEvent)});$("#toolbar_notes").click(function(){amplify.publish(EEWeb.events.OPEN_NOTES,{projectHandler:b})});$("#toolbar_image").click(function(){amplify.publish(EEWeb.events.OPEN_IMAGE_URL_DIALOG)});
$("#toolbar_link").click(function(){c.newTextLink()})};dkGui.prototype.onCompDigikeyBarHide=function(a){this.hideCompDigikeyBar()};dkGui.prototype.onCompDigikeyBarShow=function(a){this.showCompDigikeyBar()};dkGui.prototype.sidebarHasScrollbar=function(){var a=document.getElementById("sidebar_components").scrollHeight,b=$("#sidebar_components").height();return a>b};
dkGui.prototype.onTabClick=function(a){$("#top_bar").show();var b=a[0].id;$("#toolbar ul").hide();$("#tabs li").removeClass("tab_hot");a.removeClass("tab_hover");a.addClass("tab_hot");a="#menu_"+b.substring(4);$(a+","+a+" ul").show();switch(b.substring(4)){case "main":$(".tool_mode").show();$(".bom_mode").hide();$(".pcb_design_mode").hide();break;case "object":$(".tool_mode").show();$(".bom_mode").hide();$(".pcb_design_mode").hide();break;case "font":$(".tool_mode").show();$(".bom_mode").hide();$(".pcb_design_mode").hide();
break;case "pcb_design":$(".pcb_design_mode").show();$(".tool_mode").hide();$(".bom_mode").hide();break;case "bom":$(".bom_mode").show(),$(".tool_mode").hide(),$(".pcb_design_mode").hide(),amplify.publish(EEWeb.events.REFRESH_BOM,new ALEvent({})),amplify.publish(EEWeb.events.RESIZE,new ALEvent({}))}amplify.publish(EEWeb.events.RESIZE,new ALEvent({}));amplify.publish(EEWeb.events.TAB_CHANGED,new ALEvent({tab:b.substring(4)}))};dkGui.prototype.onProjectLoad=function(a){};
dkGui.prototype.initPropertiesDialog=function(){var a=this;$("#properties").dialog({title:l("componentproperties"),autoOpen:!1,modal:!0,dialogClass:"graph-popup-dialog",width:400,height:435,close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))},open:function(){a.refresh_properties_dialog()},buttons:[{text:l("componentproperties_cancel"),click:function(){$(this).dialog("close")}},{text:l("componentproperties_save"),click:function(){EEWeb.eventLog.logEvent("properties","Save");
var a=$(this).dialog("option","propcell");if(null!==a&&a instanceof eeComp){var c={};$("input",this).filter(":text").each(function(a,b){var f=$(this),g=f.val(),f=f.attr("name");c[f]={value:g,show:!1}}).end().filter(":checkbox").each(function(a,b){var f=$(this),g=f.prop("checked"),f=f.attr("name"),f=f.substr(5);c[f].show=g});$("textarea",this).each(function(){var a=$(this),b=a.val(),a=a.attr("name");c[a]={value:b,show:!1}});a.updateParameters(c)}$(this).dialog("close")}}]})};
dkGui.prototype.initFeedbackHandlers=function(){var a=this;$("#feedback").dialog({title:l("schemeitfeedback"),autoOpen:!1,resizable:!0,modal:!1,draggable:!0,dialogClass:"graph-popup-dialog",width:400,height:350,buttons:[{text:l("feedback_cancel"),click:function(){$(this).dialog("close")}},{text:l("feedback_send"),click:function(){EEWeb.eventLog.logEvent("feedback","send");""!=$("textarea",this).val()?($(this).dialog("close"),a.sendFeedback($("input",this).val(),$("textarea",this).val())):$("<div>"+
l("schemeitfeedback_entermsg")+"</div>").dialog({title:l("alert"),dialogClass:"graph-popup-dialog",buttons:[{text:l("feedback_ok"),click:function(){$(this).dialog("close")}}]})}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}});$("#feedback_button").click(function(b){b.preventDefault();$("#feedback").dialog("open");a.populateFeedbackEmail()})};
dkGui.prototype.populateFeedbackEmail=function(){var a=EEWeb.user,b=$("input","#feedback"),c=$("#feeback_no_email_message"),a=a.email;c.html(l("feedback_no_email"));this.isLoggedIn()?(b.val(a),c.hide()):c.show()};
dkGui.prototype.sendFeedback=function(a,b){var c=!0;amplify.request({resourceId:"feedback",data:{from:a,body:b},success:function(a){EEWeb.eventLog.logEvent("feedback","sent");a.error?$("<div>"+a.error+"</div>").dialog({title:l("error"),dialogClass:"graph-popup-dialog",buttons:[{text:l("error_ok"),click:function(){c=!1;$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}}):(EEWeb.eventLog.logEvent("feedback","failed"),$("<div>"+a.response+"</div>").dialog({title:l("confirmation"),
dialogClass:"graph-popup-dialog",buttons:[{text:l("confirmation_ok"),click:function(){$("#feedback textarea").val("");c=!0;$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}}))}});return c};dkGui.prototype.showInitialDialogs=function(){"yes"===eeServerData.showWelcome?this.showWelcome():"yes"===eeServerData.showTerms&&this.showTerms()};dkGui.prototype.isDe=function(){return-1<EEWeb.helper.getDomainName().indexOf("digikey.de")};
dkGui.prototype.showTAC=function(){var a=eeServerData.termsDialogPath||"terms-template/"+l_name+"/tou.html",b=eeServerData.termsDialogTitle||l("schemeitterms"),a=TemplatePath+a;$("<div></div>").load(a).dialog({title:b,resizable:!1,modal:!0,draggable:!1,dialogClass:"toc-dialog",width:760,height:435,buttons:[{text:l("schemeitterms_close"),click:function(){$(this).dialog("close")}}],close:function(){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};
dkGui.prototype.showPrivacy=function(){var a=eeServerData.privacyTermsDialogPath||"terms-template/"+l_name+"/privacy.html",b=eeServerData.privacyTermsDialogAcceptButton||l("schemeitprivacy_accept"),c=eeServerData.privacyTermsDialogCancelButton||l("schemeitterms_cancel"),a=TemplatePath+a;"yes"===eeServerData.showTerms&&$("#privacy_policy").load(a).dialog({autoOpen:!0,title:"",resizable:!1,modal:!0,draggable:!1,dialogClass:"privacy-dialog",width:680,height:380,closeOnEscape:!1,buttons:[{text:c,click:function(){window.location=
EEWeb.helper.getHomePage()}},{text:b,click:function(){amplify.request({resourceId:"acceptterms"});$(this).dialog("close")}}],open:function(a,b){$(".privacy-dialog .ui-dialog-titlebar-close").hide()},close:function(a,b){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};
dkGui.prototype.showTerms=function(){var a=this,b=eeServerData.termsDialogPath||"terms-template/"+l_name+"/tou.html",c=eeServerData.termsDialogTitle||l("schemeitterms"),d=eeServerData.termsDialogAgreeButton||l("schemeitterms_agree"),e=eeServerData.termsDialogCancelButton||l("schemeitterms_cancel"),b=TemplatePath+b;"yes"===eeServerData.showTerms&&$("#terms_and_conditions").load(b).dialog({autoOpen:!0,title:c,resizable:!1,modal:!0,draggable:!1,dialogClass:"toc-dialog",width:760,height:435,closeOnEscape:!1,
buttons:[{text:e,click:function(){window.location=EEWeb.helper.getHomePage()}},{text:d,click:function(){a.isDe()?a.showPrivacy():amplify.request({resourceId:"acceptterms"});$(this).dialog("close")}}],open:function(a,b){$(".toc-dialog .ui-dialog-titlebar-close").hide()},close:function(a,b){amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};
dkGui.prototype.showWelcome=function(){var a=this;"yes"===eeServerData.showWelcome&&$("#welcome").dialog({autoOpen:!0,title:l("welcometoschemeit"),resizable:!1,modal:!0,draggable:!1,dialogClass:"graph-popup-dialog",width:400,height:265,buttons:[{text:l("welcometoschemeit_tryit"),click:function(){$(this).dialog("close");return!1}},{text:l("welcometoschemeit_login"),click:function(){if("21ic"==eeServerData.accountHost)$(this).dialog("close"),EEWeb.user.doLogin();else EEWeb.user.onLogin();return!1}}],
close:function(b,c){a.showTerms();amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}));$(this).remove()}})};dkGui.prototype.onUserUpdated=function(a){eeGui.prototype.onUserUpdated.call(this,a);this.isLoggedIn()?($("#login_header .name").text(a.name),$("#logout").show(),$("#login").hide(),$("#sign_up").hide()):($("#login_header .name").text(l("welcomeguest")),$("#logout").hide(),$("#login").show(),$("#sign_up").show())};
dkGui.prototype.refresh_properties_dialog=function(){EEWeb.eventLog.logEvent("properties","refresh");var a=$("#properties");if(a.dialog("isOpen")){var b=a.dialog("option","propcell");if(null!==b)if(b.bom_include)if(b instanceof eeComp){for(var b=b.getAllParameters(),c=[eeConstants.LABEL_REFDES,"name","value","manpn","dkpn"],d=0;d<c.length;d++){var e=c[d],f=$("input[name="+e+"]",a),g=$("input[type=checkbox][name=show-"+e+"]",a);e in b?(f.val(b[e].value),b[e].show?g.prop("checked",!0):g.removeAttr("checked")):
(f.val(""),g.removeAttr("checked"))}c=["desc","notes"];for(d=0;d<c.length;d++)e=c[d],f=$("textarea[name="+e+"]",a),e in b?f.val(b[e].value):f.val("");$("#properties .error").hide();$("#properties .fields").show()}else $("#properties .error").text(l("selectedcomponent_noprop")).show(),$("#properties .fields").hide();else $("#properties .error").text(l("selectionnot_component")).show(),$("#properties .fields").hide();else $("#properties .error").text(l("nocomponent_selected")).show(),$("#properties .fields").hide()}};
dkGui.prototype.showDigikeyBar=function(){$("#schematic-wrapper").removeClass("dkBarOff").addClass("dkBarOn");$("#search_box").removeClass("sidebar_off").addClass("sidebar_on");$("#digikey_bar").show();amplify.publish(EEWeb.events.RESIZE,new ALEvent({}))};dkGui.prototype.hideDigikeyBar=function(){$("#search_box").removeClass("sidebar_on").addClass("sidebar_off");$("#schematic-wrapper").removeClass("dkBarOn").addClass("dkBarOff");$("#digikey_bar").slideUp();amplify.publish(EEWeb.events.RESIZE,new ALEvent({}))};
dkGui.prototype.showCompDigikeyBar=function(){$("#component_digikey_bar").show();$("#component_digikey_btnbar").show()};dkGui.prototype.hideCompDigikeyBar=function(){$("#component_digikey_bar").hide();$("#component_digikey_btnbar").hide()};
dkGui.prototype.onMouseWheel=function(a){var b=a.originalEvent.wheelDelta,c=a.originalEvent.detail,d=0!=a.originalEvent.deltaY?a.originalEvent.deltaY:a.originalEvent.deltaX;void 0!==b&&0>b||0!==c&&0<c||0!==d&&0<d?this.zoomOut(a):this.zoomIn(a);a.stopPropagation();a.preventDefault()};dkGui.prototype.minZoomScale=function(){var a=EEWeb.app.getGraph(),b=a.pageFormat.width,a=a.pageFormat.height,c=$(window),d=c.width(),c=c.height();return Math.min(d/b,c/a)/2};
dkGui.prototype.getSchematicPoint=function(a,b){var c=EEWeb.app.getGraph(),d=mxUtils.convertPoint(c.container,a,b),e=c.view.scale,f=c.view.translate;f.x+=c.panDx/e;f.y+=c.panDy/e;d.x=c.snap(d.x/e-f.x);d.y=c.snap(d.y/e-f.y);return d};
dkGui.prototype.onLineStyle=function(){var a=this,b=EEWeb.app.getLinestyle();$("#line_style_dialog").dialog({title:l("schemeit_line_style"),resizable:!1,modal:!1,draggable:!0,dialogClass:"graph-popup-dialog",width:250,height:380,open:function(){a.setLineStyleDlgOpen(!0);b.loadLineStyles();a.toggleLineStyleButtons()},close:function(){a.setLineStyleDlgOpen(!1);amplify.publish(EEWeb.events.DIALOG_CLOSED,new ALEvent({}))}})};
dkGui.prototype.addLineStyleActions=function(){var a=EEWeb.app.getLinestyle();$("#line_style").on("click","#linetype_straight",function(){a.lineStyleChange([mxConstants.STYLE_EDGE],["null"])});$("#line_style").on("click","#linetype_entity",function(){a.lineStyleChange([mxConstants.STYLE_EDGE],["entityRelationEdgeStyle"])});$("#line_style").on("click","#linetype_horizontal",function(){a.lineStyleChange([mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","horizontal"])});$("#line_style").on("click",
"#linetype_vertical",function(){a.lineStyleChange([mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW],["elbowEdgeStyle","vertical"])});$("#line_style").on("click","#linetype_segment",function(){a.lineStyleChange([mxConstants.STYLE_EDGE],["segmentEdgeStyle"])});$("#line_style").on("click","#linetype_orthogonal",function(){a.lineStyleChange([mxConstants.STYLE_EDGE],["orthogonalEdgeStyle"])});$("#line_style").on("click","#linestart_noarrow",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],
[mxConstants.NONE,0])});$("#line_style").on("click","#linestart_classic",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1])});$("#line_style").on("click","#linestart_open",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,1])});$("#line_style").on("click","#linestart_block",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1])});$("#line_style").on("click",
"#linestart_oval",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1])});$("#line_style").on("click","#linestart_diamond",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1])});$("#line_style").on("click","#linestart_thindiamond",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1])});$("#line_style").on("click","#linestart_classictrans",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,
"startFill"],[mxConstants.ARROW_CLASSIC,0])});$("#line_style").on("click","#linestart_blocktrans",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0])});$("#line_style").on("click","#linestart_ovaltrans",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0])});$("#line_style").on("click","#linestart_diamondtrans",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,
0])});$("#line_style").on("click","#linestart_thindiamondtrans",function(){a.lineStyleChange([mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0])});$("#line_style").on("click","#lineend_noarrow",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0])});$("#line_style").on("click","#lineend_classic",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1])});$("#line_style").on("click","#lineend_open",
function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,1])});$("#line_style").on("click","#lineend_block",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1])});$("#line_style").on("click","#lineend_oval",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1])});$("#line_style").on("click","#lineend_diamond",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,
1])});$("#line_style").on("click","#lineend_thindiamond",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1])});$("#line_style").on("click","#lineend_classictrans",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0])});$("#line_style").on("click","#lineend_blocktrans",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0])});$("#line_style").on("click","#lineend_ovaltrans",
function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0])});$("#line_style").on("click","#lineend_diamondtrans",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0])});$("#line_style").on("click","#lineend_thindiamondtrans",function(){a.lineStyleChange([mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0])})};
dkGui.prototype.setLineStyleDlgOpen=function(a){(this.LineStyleDlgOpen=a)?$("#toolbar_line_style").addClass("toolbar_open"):$("#toolbar_line_style").removeClass("toolbar_open")};dkGui.prototype.isLineStyleDlgOpen=function(){return this.LineStyleDlgOpen};dkGui.prototype.enableLineStyles=function(){var a=$("#line_style .ls_option li div");a.addClass("img");a.removeClass("img_disabled")};
dkGui.prototype.disableLineStyles=function(){var a=$("#line_style .ls_option li div");a.addClass("img_disabled");a.removeClass("img")};dkGui.prototype.toggleLineStyleButtons=function(){EEWeb.app.getGraph().selectionHasEEConnections()?this.enableLineStyles():this.disableLineStyles()};dkGui.prototype.loadHelpImages=function(){var a=$("#help_png");a.length&&a.attr("src",EEBasepath+"/img/scheme-it.png")};dkGui.prototype.scalePages=function(){this.zoomToFit()};
function dkGraph(a,b,c,d){eeGraph.call(this,a,b,c,d)}mxUtils.extend(dkGraph,eeGraph);var embedGraphBase=dkGraph;dkGraph.prototype.createHandlers=function(){eeGraph.prototype.createHandlers.call(this);this.connectionHandler.constraintHandler.pointImage=new mxImage(EEBasepath+"img/point.gif",5,5)};dkGraph.prototype.beforeCreateGraphHandler=function(){this.dragItemHandler=new eeDragItemHandler(this);this.eeLabelHandler=new eeLabelHandler(this);this.eePinHandler=new eePinHandler(this)};
dkGraph.prototype.afterCreateGraphHandler=function(){this.eeLabelHandler.setmxHandler(this.graphHandler);this.eePinHandler.setmxHandler(this.graphHandler)};dkGraph.prototype.createConnectionHandler=function(){return new dkConnectionHandler(this)};
dkGraph.prototype.getTooltipForCell=function(a){var b="",c=null;if(a instanceof eeComp){if("PROD"!=eeServerData.buildType){b="Component Id:"+a.id+"\n";(c=a.getParameter(eeConstants.LABEL_REFDES))&&(b=b+"Refdes:"+c+"\n");var d=a.getParameter("value");c&&(b=b+"Value:"+d+"\n");c=a.getView().getState(a,!0);if(a.children)for(var d=a.geometry,b=b+(" width:"+d.width+" height: "+d.height+"\n"),d=0,e=a.children.length;d<e;d++){var f=a.children[d];f instanceof eePin&&(b+=this.pinTip("Pin["+d+"]",c,f))}}}else if(a instanceof
eeLabel)b=a.getLabelName()+" = "+a.getValue();else if(a instanceof eeEdge)if("PROD"!=eeServerData.buildType){if(b="Edge id:"+a.id+"\n",b=b+EEWeb.app.getUtils().array2Str2("points",a.geometry.points)+"\n",c=a.getView().getState(a,!0),b=b+EEWeb.app.getUtils().array2Str2("abspts",c.absolutePoints)+"\n",a.source&&(b+=this.pinTip("Source",c,a.source)),a.target&&(b+=this.pinTip("Target",c,a.target)),d=a.geometry)d.sourcePoint&&(b+=" srcPoint:"+d.sourcePoint.toString()),d.targetPoint&&(b+=" trgPoint:"+d.targetPoint.toString())}else b=
"click-drag to draw wire";else"PROD"!=eeServerData.buildType&&(b="Cell Id:"+a.id+"\n",b+="Object Type:"+a.constructor+"\n");return b};
dkGraph.prototype.pinTip=function(a,b,c){var d=EEWeb.app.getGui().getPinDirection(c),e=c.getView().getState(c,!0);b=EEWeb.app.getGui().getInitialOrientation(b,e);var f=e.style,e=c.geometry;a=a+" id:"+c.id+" dir:"+d+" dirAttr:"+c.direction+" orient:"+b+" pd:"+f.pinDirection+" pc:"+f.portConstraint+" fV:"+f[mxConstants.STYLE_STENCIL_FLIPV_PATCH]+" fH:"+f[mxConstants.STYLE_STENCIL_FLIPH_PATCH]+" stDir:"+f[mxConstants.STYLE_DIRECTION];e&&(a+=" x:"+e.x+" y:"+e.y,e.offset&&(a+=" ox:"+e.offset.x+" oy:"+
e.offset.y));return a+"\n"};dkGraph.prototype.panToPoint=function(a,b){var c=this.view.getScale();this.panGraph(-(a.x*c-(b.x-315)),-(a.y*c-(b.y-143)))};dkGraph.prototype.panGraph=function(a,b){this.panTop=b;this.panLeft=a;this.view.setTranslate(0,0);eeGraph.prototype.panGraph.call(this,a,b)};dkGraph.prototype.currentpanPosition=function(){return new mxPoint(this.panLeft,this.panTop)};
dkGraph.prototype.cellsOrdered=function(a,b){if(null!=a){this.model.beginUpdate();try{for(var c=0;c<a.length;c++){var d=this.model.getParent(a[c]),e;if(b)if(e=d.getIndex(a[c]),0<e)this.model.add(d,a[c],e-1);else break;else if(e=d.getIndex(a[a.length-c-1]),e<this.model.getChildCount(d)-1)this.model.add(d,a[a.length-c-1],e+1);else break}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",b,"cells",a))}finally{this.model.endUpdate()}}};
dkGraph.prototype.getCellStyle=function(a){var b=eeGraph.prototype.getCellStyle.call(this,a,!0);null!=b&&this.model.isEdge(a)&&(b=mxUtils.clone(b),a.isWire&&a.isWire?(b.rounded=!1,b.edgeStyle="wireEdgeStyle",b=this.setStyleEnds(b,a)):(b.rounded=!0,"wireEdgeStyle"==b.edgeStyle&&(b.edgeStyle="segmentEdgeStyle")));return b};dkGraph.prototype.isDiagramConnection=function(a,b){return a&&a.useDiagramConnection()||b&&b.useDiagramConnection()};
dkGraph.prototype.getAllConnectionConstraints=function(a){var b=null!=a?a.cell:null,c=null!=a?this.getCellGeometry(b):null,c=null!=c?!c.relative:!1,d=b&&!(b instanceof eeCompSymbol),e=this.connectionHandler,e=(e=e.previous?e.previous.cell:null)&&e.isACustomPin()||e instanceof eePin||e instanceof eeEdge;if(c&&this.getModel().isVertex(b)&&0==this.getModel().getChildCount(b)&&d&&"ports"in b){var f=[];_.each(b.ports,function(a){a=new mxConnectionConstraint(new mxPoint((a.offset.x+4)/b.geometry.width,
(a.offset.y+4)/b.geometry.height),!0);f.push(a)});return f}return a.shape&&a.shape.stencil&&!e?a.shape.stencil.constraints:null};dkGraph.prototype.selectionHasEEConnections=function(){var a=this.getSelectionCells();return _.find(a,function(a){return a instanceof eeConnection})?!0:!1};dkGraph.prototype.getDragItemHandler=function(){return this.dragItemHandler};
(function(){function a(){mxCylinder.call(this)}function b(){mxCylinder.call(this)}function c(){mxCylinder.call(this)}function d(){mxActor.call(this)}function e(){mxCylinder.call(this)}function f(){mxActor.call(this)}function g(){mxActor.call(this)}function h(){mxActor.call(this)}function k(){mxActor.call(this)}function m(){mxActor.call(this)}function n(){mxActor.call(this)}function p(){mxActor.call(this)}function q(){mxRectangleShape.call(this)}function u(){mxActor.call(this)}function x(){mxRectangleShape.call(this)}
function r(){mxRectangleShape.call(this)}function w(){mxCylinder.call(this)}function s(){mxShape.call(this)}function y(){mxRectangleShape.call(this)}function K(){mxShape.call(this)}function L(){mxShape.call(this)}function D(){mxCylinder.call(this)}function M(){mxDoubleEllipse.call(this)}function S(){mxDoubleEllipse.call(this)}function T(){mxArrow.call(this)}function E(){mxActor.call(this)}function A(){mxRectangleShape.call(this)}function B(){mxActor.call(this)}function C(){mxActor.call(this)}function z(){mxActor.call(this)}
function N(){mxActor.call(this)}function F(){mxActor.call(this)}function O(){mxActor.call(this)}function P(){mxActor.call(this)}function G(){mxActor.call(this)}function H(){mxActor.call(this)}function Q(){mxEllipse.call(this)}function R(){mxActor.call(this)}function I(){mxActor.call(this)}function J(){mxActor.call(this)}mxUtils.extend(a,mxCylinder);a.prototype.size=20;a.prototype.redrawPath=function(a,b,c,d,e,f){b=Math.max(0,Math.min(d,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));
f?(a.moveTo(b,e),a.lineTo(b,b),a.lineTo(0,0),a.moveTo(b,b),a.lineTo(d,b)):(a.moveTo(0,0),a.lineTo(d-b,0),a.lineTo(d,b),a.lineTo(d,e),a.lineTo(b,e),a.lineTo(0,e-b),a.lineTo(0,0),a.close());a.end()};mxCellRenderer.prototype.defaultShapes.cube=a;mxUtils.extend(b,mxCylinder);b.prototype.redrawPath=function(a,b,c,d,e,f){b=Math.min(e/2,Math.round(e/8)+this.strokewidth-1);if(f&&null!=this.fill||!f&&null==this.fill)a.moveTo(0,b),a.curveTo(0,2*b,d,2*b,d,b),f||(a.stroke(),a.begin()),a.translate(0,b/2),a.moveTo(0,
b),a.curveTo(0,2*b,d,2*b,d,b),f||(a.stroke(),a.begin()),a.translate(0,b/2),a.moveTo(0,b),a.curveTo(0,2*b,d,2*b,d,b),f||(a.stroke(),a.begin()),a.translate(0,-b);f||(a.moveTo(0,b),a.curveTo(0,-b/3,d,-b/3,d,b),a.lineTo(d,e-b),a.curveTo(d,e+b/3,0,e+b/3,0,e-b),a.close())};b.prototype.getLabelBounds=function(a){var b=2.5*Math.min(a.height/2,Math.round(a.height/8)+this.strokewidth-1);null==this.direction||this.direction==mxConstants.DIRECTION_EAST?(a.y+=b,a.height-=b):this.direction==mxConstants.DIRECTION_SOUTH&&
(a.width-=b);this.direction==mxConstants.DIRECTION_WEST&&(a.height-=b);this.direction==mxConstants.DIRECTION_NORTH&&(a.x+=b,a.width-=b);return a};mxCellRenderer.prototype.defaultShapes.datastore=b;mxUtils.extend(c,mxCylinder);c.prototype.size=30;c.prototype.redrawPath=function(a,b,c,d,e,f){b=Math.max(0,Math.min(d,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));f?(a.moveTo(d-b,0),a.lineTo(d-b,b),a.lineTo(d,b)):(a.moveTo(0,0),a.lineTo(d-b,0),a.lineTo(d,b),a.lineTo(d,e),a.lineTo(0,
e),a.lineTo(0,0),a.close());a.end()};mxCellRenderer.prototype.defaultShapes.note=c;mxUtils.extend(d,mxActor);d.prototype.redrawPath=function(a,b,c,d,e){a.moveTo(0,0);a.quadTo(d/2,0.5*e,d,0);a.quadTo(0.5*d,e/2,d,e);a.quadTo(d/2,0.5*e,0,e);a.quadTo(0.5*d,e/2,0,0);a.end()};mxCellRenderer.prototype.defaultShapes["switch"]=d;mxUtils.extend(e,mxCylinder);e.prototype.tabWidth=60;e.prototype.tabHeight=20;e.prototype.tabPosition="right";e.prototype.redrawPath=function(a,b,c,d,e,f){b=Math.max(0,Math.min(d,
parseFloat(mxUtils.getValue(this.style,"tabWidth",this.tabWidth))));c=Math.max(0,Math.min(e,parseFloat(mxUtils.getValue(this.style,"tabHeight",this.tabHeight))));var g=mxUtils.getValue(this.style,"tabPosition",this.tabPosition);f?"left"==g?(a.moveTo(0,c),a.lineTo(b,c)):(a.moveTo(d-b,c),a.lineTo(d,c)):("left"==g?(a.moveTo(0,0),a.lineTo(b,0),a.lineTo(b,c),a.lineTo(d,c)):(a.moveTo(0,c),a.lineTo(d-b,c),a.lineTo(d-b,0),a.lineTo(d,0)),a.lineTo(d,e),a.lineTo(0,e),a.lineTo(0,c),a.close());a.end()};mxCellRenderer.prototype.defaultShapes.folder=
e;mxUtils.extend(f,mxActor);f.prototype.size=30;f.prototype.redrawPath=function(a,b,c,d,e){b=Math.max(0,Math.min(d,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(b,0),new mxPoint(d,0),new mxPoint(d,e),new mxPoint(0,e),new mxPoint(0,b)],this.isRounded,c,!0);a.end()};mxCellRenderer.prototype.defaultShapes.card=f;mxUtils.extend(g,mxActor);g.prototype.size=0.4;g.prototype.redrawPath=
function(a,b,c,d,e){b=e*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));a.moveTo(0,b/2);a.quadTo(d/4,1.4*b,d/2,b/2);a.quadTo(3*d/4,b*(1-1.4),d,b/2);a.lineTo(d,e-b/2);a.quadTo(3*d/4,e-1.4*b,d/2,e-b/2);a.quadTo(d/4,e-b*(1-1.4),0,e-b/2);a.lineTo(0,b/2);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.tape=g;mxUtils.extend(h,mxActor);h.prototype.size=0.3;h.prototype.redrawPath=function(a,b,c,d,e){b=e*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,
"size",this.size))));a.moveTo(0,0);a.lineTo(d,0);a.lineTo(d,e-b/2);a.quadTo(3*d/4,e-1.4*b,d/2,e-b/2);a.quadTo(d/4,e-b*(1-1.4),0,e-b/2);a.lineTo(0,b/2);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.document=h;mxUtils.extend(k,mxActor);k.prototype.size=0.2;k.prototype.redrawPath=function(a,b,c,d,e){b=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(0,
e),new mxPoint(b,0),new mxPoint(d,0),new mxPoint(d-b,e)],this.isRounded,c,!0);a.end()};mxCellRenderer.prototype.defaultShapes.parallelogram=k;mxUtils.extend(m,mxActor);m.prototype.size=0.2;m.prototype.redrawPath=function(a,b,c,d,e){b=d*Math.max(0,Math.min(0.5,parseFloat(mxUtils.getValue(this.style,"size",this.size))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(0,e),new mxPoint(b,0),new mxPoint(d-b,0),new mxPoint(d,e)],this.isRounded,
c,!0)};mxCellRenderer.prototype.defaultShapes.trapezoid=m;mxUtils.extend(n,mxActor);n.prototype.size=0.5;n.prototype.redrawPath=function(a,b,c,d,e){a.setFillColor(null);b=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(d,0),new mxPoint(b,0),new mxPoint(b,e/2),new mxPoint(0,e/2),new mxPoint(b,e/2),new mxPoint(b,e),new mxPoint(d,e)],this.isRounded,c,!1);
a.end()};mxCellRenderer.prototype.defaultShapes.curlyBracket=n;mxUtils.extend(p,mxActor);p.prototype.redrawPath=function(a,b,c,d,e){a.setStrokeWidth(1);a.setFillColor(this.stroke);b=d/5;a.rect(0,0,b,e);a.fillAndStroke();a.rect(2*b,0,b,e);a.fillAndStroke();a.rect(4*b,0,b,e);a.fillAndStroke()};mxCellRenderer.prototype.defaultShapes.parallelMarker=p;mxUtils.extend(q,mxRectangleShape);q.prototype.size=0.1;q.prototype.isHtmlAllowed=function(){return!1};q.prototype.getLabelBounds=function(a){if(mxUtils.getValue(this.state.style,
mxConstants.STYLE_HORIZONTAL,!0)==(null==this.direction||this.direction==mxConstants.DIRECTION_EAST||this.direction==mxConstants.DIRECTION_WEST)){var b=a.width,c=a.height;a=new mxRectangle(a.x,a.y,b,c);var d=b*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));if(this.isRounded)var e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100,d=Math.max(d,Math.min(b*e,c*e));a.x+=d;a.width-=2*d}return a};q.prototype.paintForeground=
function(a,b,c,d,e){var f=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));if(this.isRounded)var g=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100,f=Math.max(f,Math.min(d*g,e*g));a.begin();a.moveTo(b+f,c);a.lineTo(b+f,c+e);a.moveTo(b+d-f,c);a.lineTo(b+d-f,c+e);a.end();a.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.process=q;mxUtils.extend(u,mxActor);
u.prototype.size=0.2;u.prototype.redrawPath=function(a,b,c,d,e){b=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(0,0),new mxPoint(d-b,0),new mxPoint(d,e/2),new mxPoint(d-b,e),new mxPoint(0,e),new mxPoint(b,e/2)],this.isRounded,c,!0);a.end()};mxCellRenderer.prototype.defaultShapes.step=u;mxUtils.extend(x,mxRectangleShape);x.prototype.isHtmlAllowed=function(){return!1};
x.prototype.paintForeground=function(a,b,c,d,e){var f=Math.min(d/5,e/5)+1;a.begin();a.moveTo(b+d/2,c+f);a.lineTo(b+d/2,c+e-f);a.moveTo(b+f,c+e/2);a.lineTo(b+d-f,c+e/2);a.end();a.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.plus=x;var W=mxRhombus.prototype.paintVertexShape;mxRhombus.prototype.getLabelBounds=function(a){if(1==this.style["double"]){var b=(2*Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||
0))*this.scale;return new mxRectangle(a.x+b,a.y+b,a.width-2*b,a.height-2*b)}return a};mxRhombus.prototype.paintVertexShape=function(a,b,c,d,e){W.apply(this,arguments);if(!this.outline&&1==this.style["double"]){var f=2*Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0);b+=f;c+=f;d-=2*f;e-=2*f;0<d&&0<e&&(a.setShadow(!1),W.apply(this,[a,b,c,d,e]))}};mxUtils.extend(r,mxRectangleShape);r.prototype.isHtmlAllowed=function(){return!1};r.prototype.getLabelBounds=function(a){if(1==
this.style["double"]){var b=(Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0))*this.scale;return new mxRectangle(a.x+b,a.y+b,a.width-2*b,a.height-2*b)}return a};r.prototype.paintForeground=function(a,b,c,d,e){if(null!=this.style){if(!this.outline&&1==this.style["double"]){var f=Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0);b+=f;c+=f;d-=2*f;e-=2*f;0<d&&0<e&&mxRectangleShape.prototype.paintBackground.apply(this,arguments)}a.setDashed(!1);
var f=0,g=null;do{g=mxCellRenderer.prototype.defaultShapes[this.style["symbol"+f]];if(null!=g){var h=this.style["symbol"+f+"Align"],k=this.style["symbol"+f+"VerticalAlign"],m=this.style["symbol"+f+"Width"],n=this.style["symbol"+f+"Height"],p=this.style["symbol"+f+"Spacing"]||0,q=this.style["symbol"+f+"ArcSpacing"];null!=q&&(p+=this.getArcSize(d+this.strokewidth,e+this.strokewidth)*q);var q=b,r=c,q=h==mxConstants.ALIGN_CENTER?q+(d-m)/2:h==mxConstants.ALIGN_RIGHT?q+(d-m-p):q+p,r=k==mxConstants.ALIGN_MIDDLE?
r+(e-n)/2:k==mxConstants.ALIGN_BOTTOM?r+(e-n-p):r+p;a.save();h=new g;h.style=this.style;g.prototype.paintVertexShape.call(h,a,q,r,m,n);a.restore()}f++}while(null!=g)}mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxCellRenderer.prototype.defaultShapes.ext=r;mxUtils.extend(w,mxCylinder);w.prototype.redrawPath=function(a,b,c,d,e,f){f?(a.moveTo(0,0),a.lineTo(d/2,e/2),a.lineTo(d,0),a.end()):(a.moveTo(0,0),a.lineTo(d,0),a.lineTo(d,e),a.lineTo(0,e),a.close())};mxCellRenderer.prototype.defaultShapes.message=
w;mxUtils.extend(s,mxShape);s.prototype.paintBackground=function(a,b,c,d,e){a.translate(b,c);a.ellipse(d/4,0,d/2,e/4);a.fillAndStroke();a.begin();a.moveTo(d/2,e/4);a.lineTo(d/2,2*e/3);a.moveTo(d/2,e/3);a.lineTo(0,e/3);a.moveTo(d/2,e/3);a.lineTo(d,e/3);a.moveTo(d/2,2*e/3);a.lineTo(0,e);a.moveTo(d/2,2*e/3);a.lineTo(d,e);a.end();a.stroke()};mxCellRenderer.prototype.defaultShapes.umlActor=s;mxUtils.extend(y,mxRectangleShape);y.prototype.size=40;y.prototype.isHtmlAllowed=function(){return!1};y.prototype.getLabelBounds=
function(a){var b=Math.max(0,Math.min(a.height,parseFloat(mxUtils.getValue(this.style,"size",this.size))*this.scale));return new mxRectangle(a.x,a.y,a.width,b)};y.prototype.paintBackground=function(a,b,c,d,e){var f=Math.max(0,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size))));mxRectangleShape.prototype.paintBackground.call(this,a,b,c,d,f);f<e&&(a.setDashed(!0),a.begin(),a.moveTo(b+d/2,c+f),a.lineTo(b+d/2,c+e),a.end(),a.stroke())};y.prototype.paintForeground=function(a,b,c,d,e){var f=
Math.max(0,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size))));mxRectangleShape.prototype.paintForeground.call(this,a,b,c,d,Math.min(e,f))};mxCellRenderer.prototype.defaultShapes.umlLifeline=y;mxPerimeter.LifelinePerimeter=function(a,b,c,d){b=mxUtils.getValue(b.style,"size",y.prototype.size)*b.view.scale;return new mxPoint(a.getCenterX(),Math.min(a.y+a.height,Math.max(a.y+b,c.y)))};mxStyleRegistry.putValue("lifelinePerimeter",mxPerimeter.LifelinePerimeter);mxUtils.extend(K,mxShape);
K.prototype.size=10;K.prototype.paintBackground=function(a,b,c,d,e){var f=parseFloat(mxUtils.getValue(this.style,"size",this.size));a.translate(b,c);a.ellipse((d-f)/2,0,f,f);a.fillAndStroke();a.begin();a.moveTo(d/2,f);a.lineTo(d/2,e);a.end();a.stroke()};mxCellRenderer.prototype.defaultShapes.lollipop=K;mxUtils.extend(L,mxShape);L.prototype.size=10;L.prototype.inset=2;L.prototype.paintBackground=function(a,b,c,d,e){var f=parseFloat(mxUtils.getValue(this.style,"size",this.size)),g=parseFloat(mxUtils.getValue(this.style,
"inset",this.inset))+this.strokewidth;a.translate(b,c);a.begin();a.moveTo(d/2,f+g);a.lineTo(d/2,e);a.end();a.stroke();a.begin();a.moveTo((d-f)/2-g,f/2);a.quadTo((d-f)/2-g,f+g,d/2,f+g);a.quadTo((d+f)/2+g,f+g,(d+f)/2+g,f/2);a.end();a.stroke()};mxCellRenderer.prototype.defaultShapes.requires=L;mxUtils.extend(D,mxCylinder);D.prototype.jettyWidth=32;D.prototype.jettyHeight=12;D.prototype.redrawPath=function(a,b,c,d,e,f){var g=parseFloat(mxUtils.getValue(this.style,"jettyWidth",this.jettyWidth));b=parseFloat(mxUtils.getValue(this.style,
"jettyHeight",this.jettyHeight));c=g/2;var g=c+g/2,h=0.3*e-b/2,k=0.7*e-b/2;f?(a.moveTo(c,h),a.lineTo(g,h),a.lineTo(g,h+b),a.lineTo(c,h+b),a.moveTo(c,k),a.lineTo(g,k),a.lineTo(g,k+b),a.lineTo(c,k+b)):(a.moveTo(c,0),a.lineTo(d,0),a.lineTo(d,e),a.lineTo(c,e),a.lineTo(c,k+b),a.lineTo(0,k+b),a.lineTo(0,k),a.lineTo(c,k),a.lineTo(c,h+b),a.lineTo(0,h+b),a.lineTo(0,h),a.lineTo(c,h),a.close());a.end()};mxCellRenderer.prototype.defaultShapes.component=D;mxUtils.extend(M,mxDoubleEllipse);M.prototype.outerStroke=
!0;M.prototype.paintVertexShape=function(a,b,c,d,e){var f=Math.min(4,Math.min(d/5,e/5));0<d&&0<e&&(a.ellipse(b+f,c+f,d-2*f,e-2*f),a.fillAndStroke());a.setShadow(!1);this.outerStroke&&(a.ellipse(b,c,d,e),a.stroke())};mxCellRenderer.prototype.defaultShapes.endState=M;mxUtils.extend(S,M);S.prototype.outerStroke=!1;mxCellRenderer.prototype.defaultShapes.startState=S;mxUtils.extend(T,mxArrow);T.prototype.paintEdgeShape=function(a,b){var c=10+4*Math.max(0,this.strokewidth-1),d=b[0],e=b[b.length-1],f=e.x-
d.x,g=e.y-d.y,e=Math.sqrt(f*f+g*g),h=f/e,k=g/e,f=c*k/3,c=-c*h/3,g=d.x-f/2,d=d.y-c/2,m=g+f,n=d+c,h=m+e*h,e=n+e*k,k=h+f-3*f,p=e+c-3*c;a.begin();a.moveTo(m,n);a.lineTo(h,e);a.moveTo(k+f,p+c);a.lineTo(g,d);a.stroke()};mxCellRenderer.prototype.defaultShapes.link=T;mxUtils.extend(E,mxActor);E.prototype.size=30;E.prototype.redrawPath=function(a,b,c,d,e){b=Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size)));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/
2;this.addPoints(a,[new mxPoint(0,e),new mxPoint(0,b),new mxPoint(d,0),new mxPoint(d,e)],this.isRounded,c,!0);a.end()};mxCellRenderer.prototype.defaultShapes.manualInput=E;mxUtils.extend(A,mxRectangleShape);A.prototype.dx=20;A.prototype.dy=20;A.prototype.isHtmlAllowed=function(){return!1};A.prototype.paintForeground=function(a,b,c,d,e){mxRectangleShape.prototype.paintForeground.apply(this,arguments);var f=0;if(this.isRounded)var g=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/
100,f=Math.max(f,Math.min(d*g,e*g));g=Math.max(f,Math.min(d,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));f=Math.max(f,Math.min(e,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));a.begin();a.moveTo(b,c+f);a.lineTo(b+d,c+f);a.end();a.stroke();a.begin();a.moveTo(b+g,c);a.lineTo(b+g,c+e);a.end();a.stroke()};mxCellRenderer.prototype.defaultShapes.internalStorage=A;mxUtils.extend(B,mxActor);B.prototype.dx=20;B.prototype.dy=20;B.prototype.redrawPath=function(a,b,c,d,e){b=Math.max(0,Math.min(d,
parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));c=Math.max(0,Math.min(e,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));Math.min(d/2,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(0,0),new mxPoint(d,0),new mxPoint(d,c),new mxPoint(b,c),new mxPoint(b,e),new mxPoint(0,e)],this.isRounded,f,!0);a.end()};mxCellRenderer.prototype.defaultShapes.corner=
B;mxUtils.extend(C,mxActor);C.prototype.dx=20;C.prototype.dy=20;C.prototype.redrawPath=function(a,b,c,d,e){b=Math.max(0,Math.min(d,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));c=Math.max(0,Math.min(e,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));Math.abs(d-b);Math.min(d/2,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size))));var f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(0,0),new mxPoint(d,
0),new mxPoint(d,c),new mxPoint((d+b)/2,c),new mxPoint((d+b)/2,e),new mxPoint((d-b)/2,e),new mxPoint((d-b)/2,c),new mxPoint(0,c)],this.isRounded,f,!0);a.end()};mxCellRenderer.prototype.defaultShapes.tee=C;mxUtils.extend(z,mxActor);z.prototype.arrowWidth=0.3;z.prototype.arrowSize=0.2;z.prototype.redrawPath=function(a,b,c,d,e){var f=e*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowWidth",this.arrowWidth))));b=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowSize",
this.arrowSize))));c=(e-f)/2;f=c+f;a.moveTo(0,c);a.lineTo(d-b,c);a.lineTo(d-b,0);a.lineTo(d,e/2);a.lineTo(d-b,e);a.lineTo(d-b,f);a.lineTo(0,f);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.singleArrow=z;mxUtils.extend(N,mxActor);N.prototype.redrawPath=function(a,b,c,d,e){var f=e*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowWidth",z.prototype.arrowWidth))));b=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowSize",z.prototype.arrowSize))));c=(e-
f)/2;f=c+f;a.moveTo(0,e/2);a.lineTo(b,0);a.lineTo(b,c);a.lineTo(d-b,c);a.lineTo(d-b,0);a.lineTo(d,e/2);a.lineTo(d-b,e);a.lineTo(d-b,f);a.lineTo(b,f);a.lineTo(b,e);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.doubleArrow=N;mxUtils.extend(F,mxActor);F.prototype.size=0.1;F.prototype.redrawPath=function(a,b,c,d,e){b=d*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));a.moveTo(b,0);a.lineTo(d,0);a.quadTo(d-2*b,e/2,d,e);a.lineTo(b,e);a.quadTo(b-2*b,e/2,b,0);
a.close();a.end()};mxCellRenderer.prototype.defaultShapes.dataStorage=F;mxUtils.extend(O,mxActor);O.prototype.redrawPath=function(a,b,c,d,e){a.moveTo(0,0);a.quadTo(d,0,d,e/2);a.quadTo(d,e,0,e);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.or=O;mxUtils.extend(P,mxActor);P.prototype.redrawPath=function(a,b,c,d,e){a.moveTo(0,0);a.quadTo(d,0,d,e/2);a.quadTo(d,e,0,e);a.quadTo(d/2,e/2,0,0);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.xor=P;mxUtils.extend(G,mxActor);G.prototype.size=
20;G.prototype.redrawPath=function(a,b,c,d,e){b=Math.min(d/2,Math.min(e,parseFloat(mxUtils.getValue(this.style,"size",this.size))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(b,0),new mxPoint(d-b,0),new mxPoint(d,0.8*b),new mxPoint(d,e),new mxPoint(0,e),new mxPoint(0,0.8*b)],this.isRounded,c,!0);a.end()};mxCellRenderer.prototype.defaultShapes.loopLimit=G;mxUtils.extend(H,mxActor);H.prototype.size=0.375;H.prototype.redrawPath=function(a,
b,c,d,e){b=e*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(a,[new mxPoint(0,0),new mxPoint(d,0),new mxPoint(d,e-b),new mxPoint(d/2,e),new mxPoint(0,e-b)],this.isRounded,c,!0);a.end()};mxCellRenderer.prototype.defaultShapes.offPageConnector=H;mxUtils.extend(Q,mxEllipse);Q.prototype.paintVertexShape=function(a,b,c,d,e){mxEllipse.prototype.paintVertexShape.apply(this,
arguments);a.begin();a.moveTo(b+d/2,c+e);a.lineTo(b+d,c+e);a.end();a.stroke()};mxCellRenderer.prototype.defaultShapes.tapeData=Q;mxUtils.extend(R,mxActor);R.prototype.redrawPath=function(a,b,c,d,e){b=Math.min(d,e/2);a.moveTo(0,0);a.lineTo(d-b,0);a.quadTo(d,0,d,e/2);a.quadTo(d,e,d-b,e);a.lineTo(0,e);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.delay=R;mxUtils.extend(I,mxActor);I.prototype.size=0.2;I.prototype.redrawPath=function(a,b,c,d,e){b=Math.min(e,d);var f=Math.max(0,Math.min(b,b*
parseFloat(mxUtils.getValue(this.style,"size",this.size))));b=(e-f)/2;c=b+f;var g=(d-f)/2,f=g+f;a.moveTo(0,b);a.lineTo(g,b);a.lineTo(g,0);a.lineTo(f,0);a.lineTo(f,b);a.lineTo(d,b);a.lineTo(d,c);a.lineTo(f,c);a.lineTo(f,e);a.lineTo(g,e);a.lineTo(g,c);a.lineTo(0,c);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.cross=I;mxUtils.extend(J,mxActor);J.prototype.size=0.25;J.prototype.redrawPath=function(a,b,c,d,e){b=Math.min(d,e/2);c=Math.min(d-b,Math.max(0,parseFloat(mxUtils.getValue(this.style,
"size",this.size)))*d);a.moveTo(0,e/2);a.lineTo(c,0);a.lineTo(d-b,0);a.quadTo(d,0,d,e/2);a.quadTo(d,e,d-b,e);a.lineTo(c,e);a.close();a.end()};mxCellRenderer.prototype.defaultShapes.display=J;mxMarker.addMarker("dash",function(a,b,c,d,e,f,g,h,k,m){var n=e*(g+k+1),p=f*(g+k+1);return function(){a.begin();a.moveTo(d.x-n/2-p/2,d.y-p/2+n/2);a.lineTo(d.x+p/2-3*n/2,d.y-3*p/2-n/2);a.stroke()}});if("undefined"!=typeof mxVertexHandler){var t=function(a,b,c,d,e){a=new mxHandle(a,null,mxVertexHandler.prototype.secondaryHandleImage);
a.execute=function(){for(var a=0;a<b.length;a++)this.copyStyle(b[a])};a.getPosition=c;a.setPosition=d;a.ignoreGrid=null!=e?e:!0;return a},X=function(a){return function(b){return[t(b,["size"],function(b){var c=Math.max(0,Math.min(a,parseFloat(mxUtils.getValue(this.state.style,"size",m.prototype.size))));return new mxPoint(b.x+c*b.width*0.75,b.y+b.height/4)},function(b,c){this.state.style.size=Math.max(0,Math.min(a,(c.x-b.x)/(0.75*b.width)))})]}},U=function(a){return function(b){return[t(b,["size"],
function(b){var c=parseFloat(mxUtils.getValue(this.state.style,"size",a));return new mxPoint(b.x+c*b.width,b.getCenterY())},function(a,b){this.state.style.size=Math.max(0,Math.min(1,(b.x-a.x)/a.width))})]}},V=function(a,b){return function(c){return[t(c,["size"],function(c){var d=Math.max(0,Math.min(c.width,Math.min(c.height,parseFloat(mxUtils.getValue(this.state.style,"size",b)))))*a;return new mxPoint(c.x+d,c.y+d)},function(b,c){this.state.style.size=Math.round(Math.max(0,Math.min(Math.min(b.width,
c.x-b.x),Math.min(b.height,c.y-b.y)))/a)})]}},Y=function(a){return function(b){return[t(b,["arrowWidth","arrowSize"],function(b){var c=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"arrowWidth",z.prototype.arrowWidth))),d=Math.max(0,Math.min(a,mxUtils.getValue(this.state.style,"arrowSize",z.prototype.arrowSize)));return new mxPoint(b.x+(1-d)*b.width,b.y+(1-c)*b.height/2)},function(b,c){this.state.style.arrowWidth=Math.max(0,Math.min(1,Math.abs(b.y+b.height/2-c.y)/b.height*2));this.state.style.arrowSize=
Math.max(0,Math.min(a,(b.x+b.width-c.x)/b.width))})]}},Z={swimlane:function(a){return[t(a,[mxConstants.STYLE_STARTSIZE],function(a){var b=parseFloat(mxUtils.getValue(this.state.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));return 1==mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,1)?new mxPoint(a.getCenterX(),a.y+Math.max(0,Math.min(a.height,b))):new mxPoint(a.x+Math.max(0,Math.min(a.width,b)),a.getCenterY())},function(a,b){this.state.style[mxConstants.STYLE_STARTSIZE]=
1==mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,1)?Math.round(Math.max(0,Math.min(a.height,b.y-a.y))):Math.round(Math.max(0,Math.min(a.width,b.x-a.x)))})]},umlLifeline:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(a.height,parseFloat(mxUtils.getValue(this.state.style,"size",y.prototype.size))));return new mxPoint(a.getCenterX(),a.y+b)},function(a,b){this.state.style.size=Math.round(Math.max(0,Math.min(a.height,b.y-a.y)))})]},process:function(a){return[t(a,
["size"],function(a){var b=Math.max(0,Math.min(0.5,parseFloat(mxUtils.getValue(this.state.style,"size",q.prototype.size))));return new mxPoint(a.x+a.width*b,a.y+a.height/4)},function(a,b){this.state.style.size=Math.max(0,Math.min(0.5,(b.x-a.x)/a.width))})]},cross:function(a){return[t(a,["size"],function(a){var b=Math.min(a.width,a.height),b=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"size",I.prototype.size)))*b/2;return new mxPoint(a.getCenterX()-b,a.getCenterY()-b)},function(a,b){var c=
Math.min(a.width,a.height);this.state.style.size=Math.max(0,Math.min(1,Math.min(Math.max(0,a.getCenterY()-b.y)/c*2,Math.max(0,a.getCenterX()-b.x)/c*2)))})]},note:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(a.width,Math.min(a.height,parseFloat(mxUtils.getValue(this.state.style,"size",c.prototype.size)))));return new mxPoint(a.x+a.width-b,a.y+b)},function(a,b){this.state.style.size=Math.round(Math.max(0,Math.min(Math.min(a.width,a.x+a.width-b.x),Math.min(a.height,b.y-a.y))))})]},
manualInput:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(a.height,mxUtils.getValue(this.state.style,"size",E.prototype.size)));return new mxPoint(a.x+a.width/4,a.y+3*b/4)},function(a,b){this.state.style.size=Math.round(Math.max(0,Math.min(a.height,4*(b.y-a.y)/3)))})]},dataStorage:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",F.prototype.size))));return new mxPoint(a.x+(1-b)*a.width,a.getCenterY())},
function(a,b){this.state.style.size=Math.max(0,Math.min(1,(a.x+a.width-b.x)/a.width))})]},internalStorage:function(a){return[t(a,["dx","dy"],function(a){var b=Math.max(0,Math.min(a.width,mxUtils.getValue(this.state.style,"dx",A.prototype.dx))),c=Math.max(0,Math.min(a.height,mxUtils.getValue(this.state.style,"dy",A.prototype.dy)));return new mxPoint(a.x+b,a.y+c)},function(a,b){this.state.style.dx=Math.round(Math.max(0,Math.min(a.width,b.x-a.x)));this.state.style.dy=Math.round(Math.max(0,Math.min(a.height,
b.y-a.y)))})]},corner:function(a){return[t(a,["dx","dy"],function(a){var b=Math.max(0,Math.min(a.width,mxUtils.getValue(this.state.style,"dx",B.prototype.dx))),c=Math.max(0,Math.min(a.height,mxUtils.getValue(this.state.style,"dy",B.prototype.dy)));return new mxPoint(a.x+b,a.y+c)},function(a,b){this.state.style.dx=Math.round(Math.max(0,Math.min(a.width,b.x-a.x)));this.state.style.dy=Math.round(Math.max(0,Math.min(a.height,b.y-a.y)))})]},tee:function(a){return[t(a,["dx","dy"],function(a){var b=Math.max(0,
Math.min(a.width,mxUtils.getValue(this.state.style,"dx",C.prototype.dx))),c=Math.max(0,Math.min(a.height,mxUtils.getValue(this.state.style,"dy",C.prototype.dy)));return new mxPoint(a.x+(a.width+b)/2,a.y+c)},function(a,b){this.state.style.dx=Math.round(Math.max(0,2*Math.min(a.width/2,b.x-a.x-a.width/2)));this.state.style.dy=Math.round(Math.max(0,Math.min(a.height,b.y-a.y)))})]},singleArrow:Y(1),doubleArrow:Y(0.5),folder:function(a){return[t(a,["tabWidth","tabHeight"],function(a){var b=Math.max(0,Math.min(a.width,
mxUtils.getValue(this.state.style,"tabWidth",e.prototype.tabWidth))),c=Math.max(0,Math.min(a.height,mxUtils.getValue(this.state.style,"tabHeight",e.prototype.tabHeight)));mxUtils.getValue(this.state.style,"tabPosition",e.prototype.tabPosition)==mxConstants.ALIGN_RIGHT&&(b=a.width-b);return new mxPoint(a.x+b,a.y+c)},function(a,b){var c=Math.max(0,Math.min(a.width,b.x-a.x));mxUtils.getValue(this.state.style,"tabPosition",e.prototype.tabPosition)==mxConstants.ALIGN_RIGHT&&(c=a.width-c);this.state.style.tabWidth=
Math.round(c);this.state.style.tabHeight=Math.round(Math.max(0,Math.min(a.height,b.y-a.y)))})]},document:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",h.prototype.size))));return new mxPoint(a.x+3*a.width/4,a.y+(1-b)*a.height)},function(a,b){this.state.style.size=Math.max(0,Math.min(1,(a.y+a.height-b.y)/a.height))})]},tape:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,
"size",g.prototype.size))));return new mxPoint(a.getCenterX(),a.y+b*a.height/2)},function(a,b){this.state.style.size=Math.max(0,Math.min(1,(b.y-a.y)/a.height*2))})]},offPageConnector:function(a){return[t(a,["size"],function(a){var b=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",H.prototype.size))));return new mxPoint(a.getCenterX(),a.y+(1-b)*a.height)},function(a,b){this.state.style.size=Math.max(0,Math.min(1,(a.y+a.height-b.y)/a.height))})]},step:U(u.prototype.size),curlyBracket:U(n.prototype.size),
display:U(J.prototype.size),cube:V(1,a.prototype.size),card:V(0.5,f.prototype.size),loopLimit:V(0.5,G.prototype.size),trapezoid:X(0.5),parallelogram:X(1)};mxVertexHandler.prototype.createCustomHandles=function(){if(this.graph.isCellRotatable(this.state.cell)){var a=Z[this.state.style.shape];if(null!=a)return a(this.state)}return null}}mxRectangleShape.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),!0),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.75,
0),!0),new mxConnectionConstraint(new mxPoint(0,0.25),!0),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(0,0.75),!0),new mxConnectionConstraint(new mxPoint(1,0.25),!0),new mxConnectionConstraint(new mxPoint(1,0.5),!0),new mxConnectionConstraint(new mxPoint(1,0.75),!0),new mxConnectionConstraint(new mxPoint(0.25,1),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0.75,1),!0)];mxEllipse.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,
0),!0),new mxConnectionConstraint(new mxPoint(1,0),!0),new mxConnectionConstraint(new mxPoint(0,1),!0),new mxConnectionConstraint(new mxPoint(1,1),!0),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(1,0.5))];mxLabel.prototype.constraints=mxRectangleShape.prototype.constraints;mxImageShape.prototype.constraints=mxRectangleShape.prototype.constraints;mxSwimlane.prototype.constraints=
mxRectangleShape.prototype.constraints;x.prototype.constraints=mxRectangleShape.prototype.constraints;c.prototype.constraints=mxRectangleShape.prototype.constraints;f.prototype.constraints=mxRectangleShape.prototype.constraints;a.prototype.constraints=mxRectangleShape.prototype.constraints;e.prototype.constraints=mxRectangleShape.prototype.constraints;A.prototype.constraints=mxRectangleShape.prototype.constraints;F.prototype.constraints=mxRectangleShape.prototype.constraints;Q.prototype.constraints=
mxEllipse.prototype.constraints;E.prototype.constraints=mxRectangleShape.prototype.constraints;R.prototype.constraints=mxRectangleShape.prototype.constraints;J.prototype.constraints=mxRectangleShape.prototype.constraints;G.prototype.constraints=mxRectangleShape.prototype.constraints;H.prototype.constraints=mxRectangleShape.prototype.constraints;mxCylinder.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.15,0.05),!1),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.85,
0.05),!1),new mxConnectionConstraint(new mxPoint(0,0.3),!0),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(0,0.7),!0),new mxConnectionConstraint(new mxPoint(1,0.3),!0),new mxConnectionConstraint(new mxPoint(1,0.5),!0),new mxConnectionConstraint(new mxPoint(1,0.7),!0),new mxConnectionConstraint(new mxPoint(0.15,0.95),!1),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0.85,0.95),!1)];s.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,
0.1),!1),new mxConnectionConstraint(new mxPoint(0.5,0),!1),new mxConnectionConstraint(new mxPoint(0.75,0.1),!1),new mxConnectionConstraint(new mxPoint(0,1/3),!1),new mxConnectionConstraint(new mxPoint(0,1),!1),new mxConnectionConstraint(new mxPoint(1,1/3),!1),new mxConnectionConstraint(new mxPoint(1,1),!1),new mxConnectionConstraint(new mxPoint(0.5,0.5),!1)];D.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),!0),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.75,
0),!0),new mxConnectionConstraint(new mxPoint(0,0.3),!0),new mxConnectionConstraint(new mxPoint(0,0.7),!0),new mxConnectionConstraint(new mxPoint(1,0.25),!0),new mxConnectionConstraint(new mxPoint(1,0.5),!0),new mxConnectionConstraint(new mxPoint(1,0.75),!0),new mxConnectionConstraint(new mxPoint(0.25,1),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0.75,1),!0)];mxActor.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.25,
0.2),!1),new mxConnectionConstraint(new mxPoint(0.1,0.5),!1),new mxConnectionConstraint(new mxPoint(0,0.75),!0),new mxConnectionConstraint(new mxPoint(0.75,0.25),!1),new mxConnectionConstraint(new mxPoint(0.9,0.5),!1),new mxConnectionConstraint(new mxPoint(1,0.75),!0),new mxConnectionConstraint(new mxPoint(0.25,1),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0.75,1),!0)];d.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),!1),new mxConnectionConstraint(new mxPoint(0.5,
0.25),!1),new mxConnectionConstraint(new mxPoint(1,0),!1),new mxConnectionConstraint(new mxPoint(0.25,0.5),!1),new mxConnectionConstraint(new mxPoint(0.75,0.5),!1),new mxConnectionConstraint(new mxPoint(0,1),!1),new mxConnectionConstraint(new mxPoint(0.5,0.75),!1),new mxConnectionConstraint(new mxPoint(1,1),!1)];g.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.35),!1),new mxConnectionConstraint(new mxPoint(0,0.5),!1),new mxConnectionConstraint(new mxPoint(0,0.65),!1),new mxConnectionConstraint(new mxPoint(1,
0.35),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1),new mxConnectionConstraint(new mxPoint(1,0.65),!1),new mxConnectionConstraint(new mxPoint(0.25,1),!1),new mxConnectionConstraint(new mxPoint(0.75,0),!1)];u.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),!0),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.75,0),!0),new mxConnectionConstraint(new mxPoint(0.25,1),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0.75,
1),!0),new mxConnectionConstraint(new mxPoint(0.1,0.25),!1),new mxConnectionConstraint(new mxPoint(0.2,0.5),!1),new mxConnectionConstraint(new mxPoint(0.1,0.75),!1),new mxConnectionConstraint(new mxPoint(0.9,0.25),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1),new mxConnectionConstraint(new mxPoint(0.9,0.75),!1)];mxLine.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),!1),new mxConnectionConstraint(new mxPoint(0.25,0.5),!1),new mxConnectionConstraint(new mxPoint(0.75,0.5),
!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1)];K.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.5,0),!1),new mxConnectionConstraint(new mxPoint(0.5,1),!1)];mxDoubleEllipse.prototype.constraints=mxEllipse.prototype.constraints;mxRhombus.prototype.constraints=mxEllipse.prototype.constraints;mxTriangle.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.25),!0),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(0,0.75),!0),
new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(1,0.5),!0)];mxHexagon.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.375,0),!0),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.625,0),!0),new mxConnectionConstraint(new mxPoint(0.125,0.25),!1),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(0.125,0.75),!1),new mxConnectionConstraint(new mxPoint(0.875,
0.25),!1),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(1,0.5),!0),new mxConnectionConstraint(new mxPoint(0.875,0.75),!1),new mxConnectionConstraint(new mxPoint(0.375,1),!0),new mxConnectionConstraint(new mxPoint(0.5,1),!0),new mxConnectionConstraint(new mxPoint(0.625,1),!0)];mxCloud.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0.25),!1),new mxConnectionConstraint(new mxPoint(0.4,0.1),!1),new mxConnectionConstraint(new mxPoint(0.16,
0.55),!1),new mxConnectionConstraint(new mxPoint(0.07,0.4),!1),new mxConnectionConstraint(new mxPoint(0.31,0.8),!1),new mxConnectionConstraint(new mxPoint(0.13,0.77),!1),new mxConnectionConstraint(new mxPoint(0.8,0.8),!1),new mxConnectionConstraint(new mxPoint(0.55,0.95),!1),new mxConnectionConstraint(new mxPoint(0.875,0.5),!1),new mxConnectionConstraint(new mxPoint(0.96,0.7),!1),new mxConnectionConstraint(new mxPoint(0.625,0.2),!1),new mxConnectionConstraint(new mxPoint(0.88,0.25),!1)];k.prototype.constraints=
mxRectangleShape.prototype.constraints;m.prototype.constraints=mxRectangleShape.prototype.constraints;h.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.25,0),!0),new mxConnectionConstraint(new mxPoint(0.5,0),!0),new mxConnectionConstraint(new mxPoint(0.75,0),!0),new mxConnectionConstraint(new mxPoint(0,0.25),!0),new mxConnectionConstraint(new mxPoint(0,0.5),!0),new mxConnectionConstraint(new mxPoint(0,0.75),!0),new mxConnectionConstraint(new mxPoint(1,0.25),!0),new mxConnectionConstraint(new mxPoint(1,
0.5),!0),new mxConnectionConstraint(new mxPoint(1,0.75),!0)];mxArrow.prototype.constraints=null;z.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1)];N.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1)];I.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.5),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1),new mxConnectionConstraint(new mxPoint(0.5,
0),!1),new mxConnectionConstraint(new mxPoint(0.5,1),!1)];y.prototype.constraints=null;O.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0.25),!1),new mxConnectionConstraint(new mxPoint(0,0.5),!1),new mxConnectionConstraint(new mxPoint(0,0.75),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1),new mxConnectionConstraint(new mxPoint(0.7,0.1),!1),new mxConnectionConstraint(new mxPoint(0.7,0.9),!1)];P.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0.175,0.25),!1),new mxConnectionConstraint(new mxPoint(0.25,
0.5),!1),new mxConnectionConstraint(new mxPoint(0.175,0.75),!1),new mxConnectionConstraint(new mxPoint(1,0.5),!1),new mxConnectionConstraint(new mxPoint(0.7,0.1),!1),new mxConnectionConstraint(new mxPoint(0.7,0.9),!1)]})();
var eeServerData=_.defaults(eeServerData||{},{buildType:"PROD",buildIndex:0,showWelcome:!1,loggedInName:"",showTerms:!1,sessionData:null,requestNoCache:!0,loggedInEmail:"",loggedInId:"",errorByUrlLimit:4,errorLimit:25,autoProjId:null,loginurl:null,chatUrl:null,domainName:null,homePage:null,contactusurl:null,aboutpage:null,adminUser:"no",language:"en",oauthtoken:null,oautherror:null,sess_language:"en",enableDragAssign:!0,customerReference:null,specificManufacturerName:null,useSecuredConnection:null,
allowDiagramToComponentConnections:!1,showPopup:!1,projectNameLimit:null,embedPath:null,cdnPath:null,cdnClientVersion:null,sentrydsn:null,bomIncludeAllowAll:null,termsDialogPath:null,termsDialogTitle:null,termsDialogAgreeButton:null,termsDialogCancelButton:null,privacyTermsDialogPath:null,privacyTermsDialogTitle:null,privacyTermsDialogAcceptButton:null,privacyTermsDialogCancelButton:null}),EEWeb=void 0===EEWeb?{}:EEWeb;EEWeb.debug={EELabelHandler:0,LogEdgeStyle:0,LogEdgeValidation:0};
EEWeb.skip_unload_callback=!1;EEWeb.mode="select";EEWeb.eventLog=null;EEWeb.loggr=null;EEWeb.raven=null;EEWeb.log=null;EEWeb.helper=null;EEWeb.lang=null;EEWeb.eventLog=new eeEventLog(eeServerData.errorLimit,eeServerData.errorByUrlLimit);
window.onbeforeunload=function(){if(!EEWeb.skip_unload_callback&&EEWeb.app&&EEWeb.app.getProjectHandler().isModified())return eeServerData.loggedInName!=l("welcomeguest")?EEWeb.loggr&&EEWeb.loggr.events.createEvent().text("Scheme-it may be unloaded by user "+eeServerData.loggedInName).tags("unload possible usage").user(eeServerData.loggedInName).dataType(Loggr.dataType.html).data("").post():EEWeb.loggr&&EEWeb.loggr.events.createEvent().text("Scheme-it may be unloaded by a new user.").tags("unload possible usage").dataType(Loggr.dataType.html).user("Guest").data("").post(),
$.cookie("resumeSession","1"),EEWeb.project.saveSession(),"";eeServerData.loggedInName!=l("welcomeguest")?EEWeb.loggr&&EEWeb.loggr.events.createEvent().text("Scheme-it unloaded by user "+eeServerData.loggedInName).tags("unload usage").user(eeServerData.loggedInName).dataType(Loggr.dataType.html).data("").post():EEWeb.loggr&&EEWeb.loggr.events.createEvent().text("Scheme-it unloaded by a new user.").tags("unload usage").user("Guest").dataType(Loggr.dataType.html).data("").post()};
window.onerror=function(a,b,c){EEWeb.eventLog&&EEWeb.eventLog.logError(a,b,c)};$(document).ajaxError(function(a,b,c,d){EEWeb.eventLog&&EEWeb.eventLog.ajaxError(a,b,c,d)});
$(document).ready(function(){$("#splash p.status").text(l("initializingapp"));var a=AspenLabs.ieVersion?10>AspenLabs.ieVersion:!1,b=mxClient.isBrowserSupported()||EEWeb.isBot();if(a||!b){$("#splash p").text("");$("body").append('<div id="iewarning"></div>');var c=$("#iewarning");c.load(TemplatePath+"ui-template/"+l_name+"/browser_error_schemeit.html",function(a,b){if(8==AspenLabs.ieVersion||9==AspenLabs.ieVersion){$(this).find(".upgradebrowser").addClass("continue");$(".ub-ie11").css("display","inline");
var f=$(".ub-choices .actions button"),g=$(".ub-choices .actions .continue");f.show().on("click",function(){EEWeb.resumeAllowedBrowsers()});var h=setInterval(function(){var a,b;a=g.find(".counter");0===a.length&&clearInterval(h);b=parseInt(a.html(),10);isNaN(b)&&(b=11);1===b?(clearInterval(h),c.is(":visible")&&g.trigger("click")):(b--,a.html(b))},1E3)}else $(this).find(".upgradebrowser").addClass("no-continue");var k="ie";EEWeb.trackChoice(k);$(".ub-choices li").on("click",function(){k=$(this).attr("class").replace("ub-",
"");EEWeb.trackChoice(k)});$(".ub-reason a").on("click",function(){EEWeb.browserFeedback()});$(".ub-feedback-choices span").on("click",function(){$(this).siblings().click()})});$("#splash").remove();if(AspenLabs.ieVersion&&8>AspenLabs.ieVersion||!b)return}EEWeb.onStartup();$("ul.level_2").hide();$("li.list_1").removeClass("hover_1_static")});EEWeb.isBot=function(a){a=a?a:navigator.userAgent;return/bot|googlebot|crawler|spider|robot|crawling/i.test(a)};
EEWeb.resumeAllowedBrowsers=function(){!AspenLabs.ieVersion||8!=AspenLabs.ieVersion&&9!=AspenLabs.ieVersion||($("#bom_import_section").hide(),$("#iewarning").hide())};EEWeb.trackChoice=function(a){amplify.request({resourceId:"ietracker",data:JSON.stringify({choice:a}),success:function(a){},error:function(a,c,d){}})};
EEWeb.browserFeedback=function(){$(".ub-feedback").dialog({resizable:!1,modal:!0,draggable:!1,dialogClass:"ub-feedback-dialog",width:340,height:320,autoOpen:!0,buttons:[{text:l("cancel"),click:function(){$(this).dialog("close")}},{text:l("submit"),click:function(){var a=$(".ub-feedback-choices input[name='reason']:checked").val(),b=$(".ub-feedback-choices input[name='message']").val(),c={choice:a,message:""};"Other"==a&&(c.message=b);9==AspenLabs.ieVersion&&$(".upgradebrowser").hide();amplify.request({resourceId:"ietracker",
data:JSON.stringify(c),success:function(a){$(".ub-feedback").dialog("close");EEWeb.browserResp()},error:function(a,b,c){$(".ub-feedback").dialog("close");EEWeb.browserResp()}})}}],close:function(){$(this).hide()}})};EEWeb.browserResp=function(){$(".ub-response").dialog({resizable:!1,modal:!0,draggable:!1,dialogClass:"ub-response-dialog",width:340,height:220,autoOpen:!0,buttons:[{text:l("close"),click:function(){$(this).dialog("close")}}],close:function(){$(this).hide();EEWeb.resumeAllowedBrowsers()}})};
EEWeb.onStartup=function(){$("#splash p.status").text(l("initializingapp"));$("#splash").show();"DEVEL"===eeServerData.buildType&&void 0!==less&&(less.env="development",less.watch());EEWeb.eventLog.logEvent("Init","Start");AspenLabs.ieVersion&&10>AspenLabs.ieVersion&&(includeBomImport=!1);includeBomImport&&(EEWeb.initOAuth(),EEWeb.generateOAuthToken());EEWeb.initLog4();EEWeb.initLoggr();EEWeb.initRaven();var a=window.location.hash,b=new dkApp;b.init();$("#splash").remove();AspenLabs.ieVersion&&8>=
AspenLabs.ieVersion?1<a.length&&(window.location.hash=a):window.location.hash=a;b.autoLoad();$.support.cors=!0};EEWeb.initLog4=function(){if(null===EEWeb.log){EEWeb.log=log4javascript.getLogger();if(eeServerData.showPopup&&"PROD"!==eeServerData.buildType){var a=new log4javascript.PopUpAppender,b=new log4javascript.PatternLayout("%d{HH:mm:ss} %-5p - %m%n");a.setLayout(b);EEWeb.log.addAppender(a)}EEWeb.log.info("Initializing Application")}};
EEWeb.initLoggr=function(){EEWeb.loggr=Loggr.logs.get("schemeitlog","65074347e3304f47b80fb44925ab0dad");null===eeServerData.loggedInName&&(eeServerData.loggedInName="UnknownName");null===eeServerData.loggedInEmail&&(eeServerData.loggedInEmail="UnknownEmail");if(eeServerData.loggedInName!=l("welcomeguest")){var a=eeServerData.loggedInName||"Unknown",b=eeServerData.loggedInEmail||"nobody@gmail.com";EEWeb.loggr&&EEWeb.loggr.trackUser(a,b);EEWeb.loggr&&EEWeb.loggr.events.createEvent().text("Scheme-it started by user "+
eeServerData.loggedInName).tags("startup usage").user(eeServerData.loggedInName).data("<b>user-agent:</b>; {0}",navigator.userAgent).dataType(Loggr.dataType.html).post()}else EEWeb.loggr&&EEWeb.loggr.events.createEvent().text("Scheme-it started by a new user.").tags("startup usage").data("<b>user-agent:</b>; {0}",navigator.userAgent).dataType(Loggr.dataType.html).post()};
EEWeb.initRaven=function(){Raven.config(eeServerData.sentrydsn,{logger:"javascript",whitelistUrls:[eeServerData.cdnPath],fetchContext:!0,linesOfContext:20,release:eeServerData.cdnClientVersion}).install();eeServerData.loggedInName!=l("welcomeguest")?Raven.setUserContext({name:eeServerData.loggedInName,email:eeServerData.loggedInEmail,id:eeServerData.loggedInId}):Raven.setUserContext();EEWeb.raven=Raven};EEWeb.initOAuth=function(){var a=this;amplify.subscribe(EEWeb.events.RENEW_ACCESS_TOKEN,function(b){a.generateOAuthToken()})};
EEWeb.generateOAuthToken=function(){var a=this;amplify.request({resourceId:"oauthtoken",success:function(b,c){a.setOAuthData(b.accessToken,b.error)},error:function(b,c,d){b="Error:"+c+" "+d;EEWeb.log.info(b);a.setOAuthData("",b)}})};EEWeb.setOAuthData=function(a,b){eeServerData.oauthtoken=a;eeServerData.oautherror=b};var cellCodec=mxCodecRegistry.getCodec("mxCell");
function eeCodecCopy(a,b,c,d){a=mxUtils.clone(a);a.template=b;if(c)for(b=0;b<c.length;b++)a.idrefs.push(c[b]);if(d)for(b=0;b<d.length;b++)a.exclude.push(d[b]);mxCodecRegistry.register(a)}eeCodecCopy(cellCodec,new eeCell);var eecellCodec=mxCodecRegistry.getCodec("eeCell");eeCodecCopy(eecellCodec,new eeComp,["labelsByName"],["compDialog"]);eeCodecCopy(eecellCodec,new eeEdge,["netObj"]);eeCodecCopy(eecellCodec,new eeConnection);eeCodecCopy(eecellCodec,new eeLabel,["attachedEdge"]);
eeCodecCopy(eecellCodec,new eeNet,["netLabel","dcpointlabel"]);eeCodecCopy(eecellCodec,new eePin);var eeCompCodec=mxCodecRegistry.getCodec("eeComp");eeCodecCopy(eeCompCodec,new eeCompSymbol,["pins"]);eeCodecCopy(eeCompCodec,new eeCusComp,["pins"]);eecellCodec.afterDecode=function(a,b,c){"isSmartPin"in c||(c.isSmartPin=!1);"isCustomPin"in c||(c.isCustomPin=!1);c.pinLoc&&(c.isSmartPin=!0);c.direction&&(c.isCustomPin=!0);return c};
eeCompCodec.afterDecode=function(a,b,c){if("params"in c){a=c.params;for(var d in a)_.isObject(a[d])||(a[d]={val:a[d],ro:!1})}"bom_id"in c&&(c.bom_include=!0,delete c.bom_id);"paramsets"in c&&null!==c.paramsets||(c.paramsets=["standard"]);return c};var eeCusCompCodec=mxCodecRegistry.getCodec("eeCusComp");
eeCusCompCodec.afterDecode=function(a,b,c){if("params"in c){a=c.params;for(var d in a)_.isObject(a[d])||(a[d]={val:a[d],ro:!1})}"bom_id"in c&&(c.bom_include=!0,delete c.bom_id);"paramsets"in c&&null!==c.paramsets||(c.paramsets=["standard"]);return c};var codec=mxCodecRegistry.getCodec(mxGraph);codec.template=new dkGraph;mxCodecRegistry.register(codec);var mcodec=mxCodecRegistry.getCodec(mxGraphModel);mcodec.template=new eeGraphModel;mxCodecRegistry.register(mcodec);var viewcodec=mxCodecRegistry.getCodec(mxGraphView);
viewcodec.template=new eeGraphView;mxCodecRegistry.register(viewcodec);angular.module("addI18n",[]).factory("addI18n",[function(){return function(a){a.translate=l}}]);
angular.module("safeApply",[]).factory("safeApply",["$timeout",function(a){return function(b){b.safeApply=function(b){var d=this.$root.$$phase;if("$apply"==d||"$digest"==d)if(b&&"function"===typeof b)var e=a(function(){b();a.cancel(e)},!0);else var f=this,e=a(function(){f.$apply();a.cancel(e)},!0);else b&&"function"==typeof b?this.$apply(b):this.$apply()}}}]);angular.module("templates-sidebar","sidebar-template/accordion-body.tpl.html sidebar-template/empty-component.tpl.html sidebar-template/error-component.tpl.html sidebar-template/sidebar-category.tpl.html sidebar-template/sidebar-component.tpl.html sidebar-template/sidebar-section.tpl.html sidebar-template/sidebar-sub-category.tpl.html".split(" "));
angular.module("sidebar-template/accordion-body.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/accordion-body.tpl.html",'<div class="accordion-body"\n    ng-show="isOpen"\n    ng-repeat="category in categories">\n    <div class="accordion-inner" ng-transclude>\n\n    </div>\n</div>\n')}]);angular.module("sidebar-template/empty-component.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/empty-component.tpl.html",'<div class="leaf sidebar-component"\n     ng-class="{hover_4: isHover}"\n     ng-mouseenter="isHover=true"\n     ng-mouseleave="isHover=false"\n     ng-click="emptyComponentClicked( );">\n    <div class="empty-component component-name">\n        {{ translate( "empty_component_title" ) }}\n    </div>\n    <div class="empty-component component-description">\n        {{ translate( "empty_component_description" ) }}\n    </div>\n</div>')}]);
angular.module("sidebar-template/error-component.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/error-component.tpl.html",'<div class="leaf sidebar-component"\n     ng-class="{hover_4: isHover}"\n     ng-mouseenter="isHover=true"\n     ng-mouseleave="isHover=false"\n     ng-click="errorComponentClicked( );">\n    <div class="error-component component-name">\n        {{ translate( "error_component_title" ) }}\n    </div>\n    <div class="error-component component-description">\n        {{ translate( "error_component_description" ) }}\n    </div>\n</div>')}]);
angular.module("sidebar-template/sidebar-category.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/sidebar-category.tpl.html",'<div class="sidebar-category">\n    <div class="sidebar-category-heading heading"\n         ng-click="isOpen=!isOpen"\n         ng-class="{hover_2: isHover, hover_2_static: isOpen}"\n         ng-mouseenter="isHover=true"\n         ng-mouseleave="isHover=false">\n        <span>{{ category.title }}</span>\n    </div>\n    <div class="loader" ng-show="isOpen && ((subcategories.length == 0 && components.length == 0) || (componentState == \'loading\' || !componentState)) && components2.length > 20">\n        <span>{{ translate("sidebar_loading") || "Loading" }}</span>\n    </div>\n    <div bn-slide-show="isOpen">\n        \x3c!-- Not all categories have sub-categories --\x3e\n        <div bn-slide-show="subcategories.length > 0">\n            <sidebar-sub-category\n                    ng-repeat="subcategory in subcategories"\n                    section="{{ section }}"\n                    category="{{ category.name }}"\n                    subcategory="subcategory"\n                    sidebar-embedded="sidebarEmbedded">\n            </sidebar-sub-category>\n        </div>\n        <div bn-slide-show="components.length > 0">\n            <sidebar-component\n                    ng-repeat="component in components"\n                    section="{{ section }}"\n                    category="{{ category.name }}"\n                    component="component"\n                    sprite-url="spriteURL"\n                    sidebar-embedded="sidebarEmbedded">\n            </sidebar-component>\n        </div>\n        <div bn-slide-show="subcategories.length == 0 && components.length == 0 || !components"\n             ng-show="(componentState == \'loaded\' || componentState == \'empty\') && subcategories.length == 0 && components.length == 0 || !components">\n            <div empty-component\n                 section="{{ section }}"\n                 category="{{ categoryName }}">\n            </div>\n        </div>\n        <div bn-slide-show="subcategories.length == 0 && components.length == 0 || !components"\n             ng-show="componentState == \'error\' && subcategories.length == 0 && components.length == 0 || !components">\n            <div error-component\n                 section="{{ section }}"\n                 category="{{ categoryName }}">\n            </div>\n        </div>\n    </div>\n    <div class="loader" ng-show="isOpen && componentState == \'loading\'">\n        <span>{{ translate("sidebar_loading") || "Loading" }}</span>\n    </div>\n</div>\n')}]);
angular.module("sidebar-template/sidebar-component.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/sidebar-component.tpl.html",'<div class="leaf sidebar-component"\n    ng-class="{hover_4: isHover}"\n    ng-mouseenter="isHover=true"\n    ng-mouseleave="isHover=false"\n    ng-click="componentClicked( );">\n    <div class="component-preview">\n    </div>\n    <div class="component-name">\n        {{ component.title || component.name }}\n    </div>\n    <div class="component-description">\n        {{ component.description }}\n    </div>\n</div>\n\n')}]);
angular.module("sidebar-template/sidebar-section.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/sidebar-section.tpl.html",'<div class="sidebar-section" >\n    <div class="section-heading heading"\n        ng-click="isOpen=!isOpen"\n        ng-class="{hover_1: isHover, hover_1_static: isOpen}"\n        ng-mouseenter="isHover=true"\n        ng-mouseleave="isHover=false">\n        <span>{{ heading }}</span>\n    </div>\n    <div class="loader" ng-show="isOpen && categories.length == 0">\n        <span>{{ translate("sidebar_loading") || "Loading" }}</span>\n    </div>\n    <div bn-slide-show="isOpen">\n        <div ng-show="categories.length > 0">\n            <sidebar-category\n                ng-repeat="category in categories"\n                section="{{ section }}"\n                category="category"\n                sidebar-embedded="sidebarEmbedded">\n            </sidebar-category>\n        </div>\n    </div>\n</div>\n')}]);
angular.module("sidebar-template/sidebar-sub-category.tpl.html",[]).run(["$templateCache",function(a){a.put("sidebar-template/sidebar-sub-category.tpl.html",'<div class="sidebar-sub-category">\n    <div class="sidebar-sub-category-heading heading"\n        ng-click="isOpen=!isOpen"\n        ng-class="{hover_3: isHover, hover_3_static: isOpen, sidebar_sub_category_loaded: isSidebarSubCategoryLoaded, multi_level_sub_category: isMultiLevelSubcategory}"\n        ng-mouseenter="isHover = true"\n        ng-mouseleave="isHover = false">\n        <span>{{ subcategory.title }}</span>\n    </div>\n    <div class="loader" ng-show="isOpen && (componentState == \'loading\' || componentState == \'loaded\') && components2.length > 20">\n        <span>{{ translate("sidebar_loading") || "Loading" }}</span>\n    </div>\n    <div bn-slide-show="isOpen">\n        <div bn-slide-show="subcategories.length > 0">\n            <div multi-sub-category\n                section="section"\n                subcategories="subcategories"\n                sidebar-embedded="sidebarEmbedded">\n            </div>\n        </div>\n        <div>\n            <sidebar-component\n                ng-repeat="component in components"\n                on-finish-render="onFinishRender"\n                section="{{ section }}"\n                category="{{ category.name || category }}"\n                subcategory="{{ subcategory.name }}"\n                component="component"\n                sprite-url="spriteURL"\n                sidebar-embedded="sidebarEmbedded">\n            </sidebar-component>\n        </div>\n        <div bn-slide-show="components.length == 0 || !components"\n             ng-show="componentState == \'empty\'">\n            <div empty-component\n                 section="{{ section }}"\n                 category="{{ categoryName }}">\n            </div>\n        </div>\n        <div bn-slide-show="components.length == 0 || !components"\n             ng-show="componentState == \'error\'">\n            <div error-component\n                 section="{{ section }}"\n                 category="{{ categoryName }}">\n            </div>\n        </div>\n    </div>\n    <div class="loader" ng-show="isOpen && componentState == \'loading\'">\n        <span>{{ translate("sidebar_loading") || "Loading" }}</span>\n    </div>\n</div>\n')}]);
var ALModuleSidebar=angular.module("ALModuleSidebar",["templates-sidebar","safeApply","addI18n"]);ALModuleSidebar.factory("categories",["$q",function(a){return{load:function(b,c){var d=a.defer(),e=b;"string"==typeof c&&(e+="/"+c);amplify.request({resourceId:"component_categories",data:{urloption:e},success:function(a,b){d.resolve(a,b)},error:function(a,b){EEWeb.eventLog.logError("Error loading sidebar categories.","ALModuleSidebar.factory:categories","27");d.reject(a,b)}});return d.promise}}}]);
ALModuleSidebar.factory("subcategories",["$q",function(a){return{load:function(b,c,d){var e=a.defer();"string"==typeof c&&(b+="/"+c);d instanceof Array&&1<d.length&&(b="/"+d.join("/"));amplify.request({resourceId:"component_categories",data:{urloption:b},success:function(a,b){e.resolve(a,b)},error:function(a,b){EEWeb.eventLog.logError("Error loading sidebar subcategories.","ALModuleSidebar.factory:subcategories","35");e.reject(a,b)}});return e.promise}}}]);
ALModuleSidebar.factory("components",["$q",function(a){return{load:function(b){var c=a.defer(),d={};async.parallel([function(a){amplify.request({resourceId:"component_components",data:b,success:function(b,c){d.components=b;a(null,c)},error:function(b,c){EEWeb.eventLog.logError("Error loading sidebar components.","ALModuleSidebar.factory:components","26");a(b,c)}})},function(a){amplify.request({resourceId:"component_stencils",data:b,success:function(b,c){d.stencils=b;a(null,c)},error:function(b,c){EEWeb.eventLog.logError("Error loading sidebar component stencils.",
"ALModuleSidebar.factory:components","42");a(b,c)}})},function(a){amplify.request({resourceId:"component_stencildefs",data:b,success:function(b,c){d.stencildefs=b.stencildefs;d.spriteURL=b.spriteURL;a(null,c)},error:function(b,c){EEWeb.eventLog.logError("Error loading sidebar component stencildefs.","ALModuleSidebar.factory:components","58");a(b,c)}})}],function(a,b){var g=!_.isEmpty(_.compact(_.flatten(_.values(d))));a?c.reject(a,b):g?c.resolve(d,b):c.reject(null,b)});return c.promise}}}]);
ALModuleSidebar.controller("SidebarController",["$scope","$attrs",function(a,b){this.groups=[];this.closeOthers=function(a){angular.forEach(this.groups,function(b){b!==a&&(b.isOpen=!1)})};this.addGroup=function(a){var b=this;this.groups.push(a);a.$on("$destroy",function(){b.removeGroup(a)})};this.removeGroup=function(a){-1!==this.groups.indexOf(a)&&this.groups.splice(this.groups.indexOf(a),1)};this.getDepth=function(a){for(var b=0;a.$parent;)a=a.$parent,b++;return b}}]);
ALModuleSidebar.directive("bnSlideShow",function(){return{link:function(a,b,c){var d=c.bnSlideShow,e=c.slideShowDuration||"fast";a.$eval(d)||b.hide();a.$watch(d,function(a,c){a!==c&&(a?b.stop(!0,!0).slideDown(e):b.stop(!0,!0).slideUp(e))})},restrict:"A"}});ALModuleSidebar.factory("forceOpen",["$timeout",function(a){return function(b){a(function(){amplify.publish("request-no-cache",!0);var a=$("div.sidebar-category-heading[category-id='"+b+"']");a.ready(function(){a.trigger("click")})},500)}}]);
ALModuleSidebar.directive("sidebarAccordion",["addI18n",function(a){return{restrict:"E",controller:"SidebarController",link:function(b,c,d){a(b);$(c);$(c).addClass("sidebar-accordion");"sidebarEmbedded"in d&&(b.sidebarEmbedded=d.sidebarEmbedded)}}}]);
ALModuleSidebar.directive("sidebarSection",["categories","checkSection","addI18n",function(a,b,c){return{require:"^sidebarAccordion",controller:"SidebarController",restrict:"E",transclude:!0,templateUrl:AngularTemplatePath+"sidebar-template/sidebar-section.tpl.html",replace:!0,scope:{heading:"@",section:"@",sidebarEmbedded:"="},link:function(d,e,f,g){c(d);g.addGroup(d);d.isOpen=!1;d.categories=[];b(d.section,d,e).then(function(b){b&&(d.componentState="loading",a.load(d.section).then(function(a){_.isEmpty(a)?
(d.componentState="empty",EEWeb.log.error("Empty Sidebar Section: "+d.section)):(d.categories=a,d.componentState="loaded")},function(a){d.componentState="error";EEWeb.log.error("Error Loading Sidebar Section: "+d.section)}))});d.$watch("isOpen",function(a){a&&g.closeOthers(d)})}}}]);
ALModuleSidebar.directive("sidebarCategory",["categories","components","checkSubcategory",function(a,b,c){return{require:"^sidebarSection",controller:"SidebarController",restrict:"E",transclude:!0,templateUrl:AngularTemplatePath+"sidebar-template/sidebar-category.tpl.html",replace:!0,scope:{section:"@",category:"=",sidebarEmbedded:"="},link:function(d,e,f,g){g.addGroup(d);d.subcategories=[];d.components=[];d.components2=[];d.batchLimit=1;amplify.subscribe("delayed-loading",function(){if(0<d.components2.length){var a=
d.components2.splice(0,d.batchLimit);d.components.push(a[0]);d.componentState="loading"}else d.componentState="loaded"});d.ishover=!1;d.isOpen=!1;d.$watch("isOpen",function(e){e&&(g.closeOthers(d),"requested"in d||("subcategory"in d.category&&null!==d.category.subcategory||!d.category.hasSubcategory?c(d.category.subcategory,d).then(function(a){a&&(d.requested=!0,d.componentState="loading",b.load({category:d.category.id}).then(function(a){if(_.isEmpty(a.components)||_.isEmpty(a.stencildefs)||!a.stencils)delete d.requested,
d.componentState="empty",EEWeb.log.error("Empty Sidebar Category's Components, Category ID: "+d.category.id);else{amplify.publish("set-stencil",a.stencils);amplify.publish("set-stencildefs",a.stencildefs);d.spriteURL=a.spriteURL;var b=a.components.splice(0,d.batchLimit);d.components=b;d.components2=a.components;d.componentState="loaded"}},function(a){delete d.requested;d.componentState="error";EEWeb.log.error("Error Loading Sidebar Category's Components, Category ID: "+d.category.id)}))}):(d.requested=
!0,d.componentState="loading",a.load(d.category.id).then(function(a){_.isEmpty(a)?(delete d.requested,d.componentState="empty",EEWeb.log.error("Empty Sidebar Category, Section: "+d.section+", Category Name: "+d.category.name)):(d.subcategories=a,d.componentState="loaded")},function(a){delete d.requested;d.componentState="error";EEWeb.log.error("Error Loading Sidebar Subcategories, Section: "+d.section+", Category Name: "+d.category.name)}))))})}}}]);
ALModuleSidebar.directive("multiSubCategory",["$compile","$timeout",function(a){return{require:"^sidebarSubCategory",controller:"SidebarController",restrict:"A",transclude:!0,replace:!0,scope:{sidebarEmbedded:"=",section:"=",subcategories:"="},link:function(b,c,d,e){b.$watch("subcategories",function(d){_.isEmpty(d)||(c.append('<sidebar-sub-category ng-repeat="subcategory in subcategories" on-finish-render="onFinishRender" subcategory="subcategory" section="{{ section }}" sidebar-embedded="sidebarEmbedded"></sidebar-sub-category>'),
a(c.contents())(b))})}}}]);
ALModuleSidebar.directive("sidebarSubCategory",["components","subcategories","checkSubcategory","$compile",function(a,b,c,d){return{require:["?^sidebarCategory","?^sidebarSubCategory","?^multiSubCategory"],controller:"SidebarController",restrict:"E",transclude:!0,templateUrl:AngularTemplatePath+"sidebar-template/sidebar-sub-category.tpl.html",replace:!0,scope:{section:"@?",category:"@?",subcategory:"=",sidebarEmbedded:"="},link:function(d,f,g,h){var k=null,m=null;"category"in d?k=h[0]:(k=h[1],m=h[2]);
k.addGroup(d);m&&m.addGroup(d);g=k.getDepth(d);d.isMultiLevelSubcategory=!1;5<g&&(f.css("padding-left","10px"),d.isMultiLevelSubcategory=!0);d.isHover=!1;d.isOpen=!1;d.isSidebarSubCategoryLoaded=!1;d.components=[];d.components2=[];d.batchLimit=1;amplify.subscribe("delayed-loading",function(){if(0<d.components2.length){var a=d.components2.splice(0,d.batchLimit);d.components.push(a[0]);d.componentState="loading"}else d.componentState="loaded"});d.onClick=function(a){d.isOpen=!d.isOpen;a.stopPropagation()};
d.$watch("isOpen",function(f){f&&(k.closeOthers(d),m&&m.closeOthers(d),"requested"in d||(d.requested=!0,d.subcategory.hasSubcategory?(d.componentState="loading",b.load(d.subcategory.id).then(function(a){_.isEmpty(a)?(delete d.requested,d.componentState="empty",EEWeb.log.error("Empty Sidebar Category, Section: "+d.section+", Category: "+d.category+", Parent Categories: "+d.parentcategories)):(d.subcategories=a,d.componentState="loaded",d.isSidebarSubCategoryLoaded=!0)},function(a){delete d.requested;
d.componentState="error";EEWeb.log.error("Error Loading Sidebar Subcategories, Section: "+d.section+", Category: "+d.category+", Parent Categories: "+d.parentcategories)})):d.subcategory.checkSubcategory?c(d.subcategory.subcategory,d).then(function(a){_.isEmpty(d.components)&&_.isEmpty(d.subcategories)?(delete d.requested,d.componentState="empty"):(d.isSidebarSubCategoryLoaded=!0,d.componentState="loaded")}):(d.isOpen=!0,d.componentState="loading",a.load({category:d.subcategory.id}).then(function(a){if(_.isEmpty(a.components)||
_.isEmpty(a.stencildefs)||!a.stencils)delete d.requested,d.componentState="empty",EEWeb.log.error("Empty Sidebar Subcategory's Components, Subcategory ID: "+d.subcategory.id);else{amplify.publish("set-stencil",a.stencils);amplify.publish("set-stencildefs",a.stencildefs);d.spriteURL=a.spriteURL;var b=a.components.splice(0,d.batchLimit);d.components=b;d.components2=a.components;d.isSidebarSubCategoryLoaded=!0;d.componentState="loaded"}},function(a){delete d.requested;d.componentState="error";EEWeb.log.error("Error Loading Sidebar Subcategory's Components, Subcategory ID: "+
d.subcategory.id)}))))})}}}]);
ALModuleSidebar.directive("sidebarComponent",["$timeout","bindComponent","safeApply",function(a,b,c){return{restrict:"E",transclude:!0,templateUrl:AngularTemplatePath+"sidebar-template/sidebar-component.tpl.html",replace:!0,scope:{section:"@",category:"@",component:"=",subcategory:"@?",spriteUrl:"=",componentState:"=",sidebarEmbedded:"="},link:function(d,e){c(d);d.isHover=!1;a(function(){if(d.sidebarEmbedded){var a=$(e),c=a.find(".component-preview"),h=a.find(".component-name");mxClient.IS_IE&&(c.attr("onselectstart",
"return false;"),h.attr("onselectstart","return false;"));amplify.publish("set-component",d.component,c,d.spriteUrl);amplify.publish("execute-"+d.sidebarEmbedded,d,e);a.removeClass("ng-hide")}else b(d.component,d.spriteUrl,e,d.section);amplify.publish("delayed-loading")},0)}}}]);
ALModuleSidebar.directive("emptyComponent",["$timeout","bindComponent","safeApply","addI18n",function(a,b,c,d){return{restrict:"EA",transclude:!0,templateUrl:AngularTemplatePath+"sidebar-template/empty-component.tpl.html",replace:!0,scope:{section:"@",category:"@",component:"=",subcategory:"@?",spriteUrl:"=",componentState:"=",sidebarEmbedded:"="},link:function(a,b){d(a);c(a);a.isHover=!1}}}]);
ALModuleSidebar.directive("errorComponent",["$timeout","bindComponent","safeApply","addI18n",function(a,b,c,d){return{restrict:"EA",transclude:!0,templateUrl:AngularTemplatePath+"sidebar-template/error-component.tpl.html",replace:!0,scope:{section:"@",category:"@",component:"=",subcategory:"@?",spriteUrl:"=",componentState:"=",sidebarEmbedded:"="},link:function(a,b){d(a);c(a);a.isHover=!1}}}]);
ALModuleSidebar.factory("bindComponent",[function(){return function(a,b,c,d){if(a&&"projectHash"in a)$(c).on("click",function(){amplify.publish(EEWeb.events.OPEN_REFERENCE_DESIGN_PROJECT,a.name,a.projectHash)});else if(a){c=$(c);var e=c.find(".component-preview"),f=c.find(".component-name");mxClient.IS_IE&&(e.attr("onselectstart","return false;"),f.attr("onselectstart","return false;"));"custom_symbols"==d&&(a.component_type="t");c.data("component",{obj:a});amplify.publish("set-component",a,e,b);
amplify.publish("make-draggable",c);c.removeClass("ng-hide")}}}]);
ALModuleSidebar.factory("checkSection",["$q",function(a){return function(b,c,d){d=a.defer();switch(b){case "custom_symbols":d.resolve(!1);c.categories=[{name:"Symbol Primitives",title:"Symbol Primitives",subcategory:"Custom_Symbols-Sub"}];break;case "reference_designs":d.resolve(!1);var e=eeServerData.specificManufacturerName;b=referenceDesignProjects.manufacturers;e&&(e=e.replace(/_/g," "),(b=_.find(b,function(a){return a.name.toLowerCase()===e.toLowerCase()}))?b=[b]:$(".sidebar-section[section='reference_designs']").hide());
c.categories=b;break;default:d.resolve(!0)}return d.promise}}]);ALModuleSidebar.factory("checkSubcategory",["$q",function(a){return function(b,c){var d=a.defer();if("reference_designs"===c.section)d.resolve(!1),_.isArray(b)?c.subcategories=b:(c.components=referenceDesignProjects[b]||[],c.spriteUrl="");else switch(b){case "Custom_Symbols-Sub":d.resolve(!1);c.components=custom_symbols.symbol.concat(custom_symbols.component);c.spriteURL=EEBasepath+"img/symbols/shapes-sprite.png";break;default:d.resolve(!0)}return d.promise}}]);
var ALModuleDialog=angular.module("ALModuleDialog",[]);
ALModuleDialog.provider("DialogProvider",function(){var a={};this.$get=["$timeout",function(b){return{getDialogData:function(b,d){if("string"==typeof b&&"string"!=typeof d)return a[b];if("string"==typeof b&&"string"==typeof d)return a[b][d]},setDialogData:function(b,d,e){b in a||(a[b]={});a[b][d]=e},createDialog:function(c,d,e,f,g){g||(g=function(){});var h=!1;c in a&&(h=a[c].isLoaded);h?g():(a[c]=a[c]||{},h=a[c],h.name=c,h.title=d,h.body=e,h.buttons=f,h.isLoaded=!0,b(function(){amplify.publish("dialog-"+
c,g)},0))},updateDialog:function(a,b){amplify.publish("update-dialog-"+a,b)},showDialog:function(b){a[b].component.show()},hideDialog:function(b){a[b].component.hide()},forceCloseDialog:function(b){a[b].component.hide();_.forEach(a[b]._handlers.dialogCloseHandlers,function(a){a()})},onDialogClose:function(b,d){b in a||(a[b]={});var e=a[b]._handlers||{};a[b]._handlers=e;var f=e.dialogCloseHandlers||[];e.dialogCloseHandlers=f;"function"!=typeof d||d.name in e||(e[d.name]=!0,f.push(d))}}}]});
ALModuleDialog.directive("modalDialog",["DialogProvider","$compile",function(a,b){return{controller:"DialogController",restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/dialog-template.html",scope:!0,link:function(c,d,e){var f=e.name;c.name=f;var g=$(d);g.hide();amplify.subscribe("dialog-"+f,function(d){a.setDialogData(f,"component",g);var e=a.getDialogData(f);c.title=e.title;c.body=e.body;var m=g.find("#dialog-body-"+f),n=$(e.body),n=b(n[0])(c);m.html(n);for(var p in e.buttons)if(m=
e.buttons[p],"close"==m.name){var q=m.click;m.click=function(){g.hide();q();_.forEach(e._handlers.dialogCloseHandlers,function(a){a()})};break}c.buttons=e.buttons;c.$apply(function(){d()})})}}}]);ALModuleDialog.controller("DialogController",["$scope","$timeout","DialogProvider",function(a,b,c){b(function(){amplify.subscribe("dialog-"+a.name,function(){var b=c.getDialogData(a.name);a.hide=function(){b.component.hide()}})})}]);angular.module("templates-bom","bom-template/bom-assign-template.html bom-template/bom-confirm-template.html bom-template/bom-form-template.html bom-template/bom-import-error-template.html bom-template/bom-import-template.html bom-template/bom-select-template.html bom-template/bom-server-error-template.html bom-template/bomredirect.html bom-template/dialog-template.html bom-template/import-bom-category.tpl.html bom-template/import-bom-component-updating.tpl.html bom-template/import-bom-component.tpl.html bom-template/import-bom-section.tpl.html".split(" "));
angular.module("bom-template/bom-assign-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-assign-template.html",'<sidebar-accordion id="sidebar_components" class="sidebar sidebar_shadow" sidebar-embedded="bom-assign">\n    <div id="sb_symbols">\n        <sidebar-section\n                heading="{{ translate(\'tool_body_schematic_sym\') }}"\n                section="schematic_symbols"\n                sidebar-embedded="sidebarEmbedded">\n            <strong>SCHEMATIC SYMBOLS</strong>\n        </sidebar-section>\n        <sidebar-section\n                heading="{{ translate(\'tool_body_system_blocks\') }}"\n                section="system_blocks"\n                sidebar-embedded="sidebarEmbedded">\n            <strong>SYSTEM BLOCKS</strong>\n        </sidebar-section>\n        <sidebar-section\n                heading="{{ translate(\'tool_body_system_icons\') }}"\n                section="system_icons"\n                sidebar-embedded="sidebarEmbedded">\n            <strong>SYSTEM ICONS</strong>\n        </sidebar-section>\n    </div>\n</sidebar-accordion>')}]);
angular.module("bom-template/bom-confirm-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-confirm-template.html",'<p>\n    {{content[0]}}.\n    <a href="{{filePath}}" target="_blank">{{content[1]}}</a>\n</p>\n\n<br/>\n\n<p>\n    {{content[2]}}:\n\n    <table border="1" cellspacing="0" cellpadding="5">\n        <tr>\n            <th>Digi-Key Part Number</th>\n            <th>Quantity</th>\n            <th>Manufacturer</th>\n            <th>Manufacturer Part Number</th>\n            <th>Description</th>\n            <th>Comments</th>\n        </tr>\n        <tr>\n            <td>311-47.0KHRTR-ND</td>\n            <td>1</td>\n            <td></td>\n            <td>RC0603FR-0747KL</td>\n            <td>RES 47.0K OHM 1/10...</td>\n            <td></td>\n        </tr>\n        <tr>\n            <td>311-47.0KHRTR-ND</td>\n            <td>1</td>\n            <td></td>\n            <td>RC0603FR-0747KL</td>\n            <td>RES 47.0K OHM 1/10...</td>\n            <td></td>\n        </tr>\n    </table>\n</p>')}]);
angular.module("bom-template/bom-form-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-form-template.html",'<form id="import_bom_form" enctype="multipart/form-data" action="${apiPath}/schemeit/importbom" method="post">\n    <div modal-dialog name="bom-form"></div>\n    <div id="import_bom_file_wrapper">\n        <span>{{labels[0]}}:</span>\n        <input id="import_bom_file" type="file" name="import_bom_file" />\n        <button id="import_bom_btn">{{labels[1]}}</button>\n    </div>\n    <input id="initial_import_bom_file" class="hide-bom-form" type="file" name="initial_import_bom_file" />\n</form>')}]);
angular.module("bom-template/bom-import-error-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-import-error-template.html","{{errorMessage}}")}]);angular.module("bom-template/bom-import-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-import-template.html",'<div class="import-bom-table-wrapper">\n    <div class="import-bom-table-headers">\n        <table class="dataTables_scroll">\n            <tr class="dataTables_scrollHead ui-state-default">\n                <td class="bom-table-col1">\n                    <input type="checkbox"\n                           ng-model="selectAll"\n                           ng-change="toggleSelection(\'all\')" />\n                </td>\n                <td class="bom-table-col{{$index+2}}"\n                    ng-repeat="header in headers"\n                    ng-click="changeSorting($index)">\n                    <span>{{header}}</span>\n                    <span class="DataTables_sort_icon css_right ui-icon bom-table-head-icon"\n                          ng-class="sortIcon($index)"></span>\n                </td>\n            </tr>\n        </table>\n    </div>\n    <div class="import-bom-table-data">\n        <table class="dataTables_scroll">\n            <tr ng-repeat="rowData in rows | orderBy:sortColumn:reverse"\n                ng-class-odd="\'odd\'"\n                ng-class-even="\'even\'">\n                <td class="bom-table-col1">\n                    <input type="checkbox"\n                           ng-model="rowData.checked"\n                           ng-change="toggleSelection(rowData)" />\n                </td>\n                <td class="bom-table-col2" ng-class="columnBG(0,$index)">\n                    <input type="text"\n                           ng-model="rowData.name"\n                           ng-blur="updatePartName()" />\n                </td>\n                <td class="bom-table-col3" ng-class="columnBG(1,$index)">\n                    {{rowData.dkpn}}\n                </td>\n                <td class="bom-table-col4" ng-class="columnBG(2,$index)">\n                    {{rowData.manu}}\n                </td>\n                <td class="bom-table-col5" ng-class="columnBG(3,$index)">\n                    {{rowData.manpn}}\n                </td>\n                <td class="bom-table-col6" ng-class="columnBG(4,$index)">\n                    {{rowData.desc}}\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>\n<div class="import-bom-note">\n    {{note}}\n</div>')}]);
angular.module("bom-template/bom-select-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-select-template.html",'<div>\n    {{sheetHeader}}:\n    <select class="import_headers_dropdown"\n            ng-model="selectedSheet"\n            ng-options="sheet[0] for sheet in bomData" ></select>\n</div>')}]);angular.module("bom-template/bom-server-error-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/bom-server-error-template.html","{{errorMessage}}")}]);
angular.module("bom-template/bomredirect.html",[]).run(["$templateCache",function(a){a.put("bom-template/bomredirect.html",'<!DOCTYPE HTML>\n\x3c!--\n/*\n * jQuery Iframe Transport Plugin Redirect Page 2.0.1\n * https://github.com/blueimp/jQuery-File-Upload\n *\n * Copyright 2010, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n */\n--\x3e\n<html lang="en">\n<head>\n    <meta charset="utf-8">\n    <title>jQuery Iframe Transport Plugin Redirect Page</title>\n</head>\n<body>\n<script>\n    var data = JSON.parse( decodeURIComponent( window.location.search.slice(1) ) );\n    data = JSON.stringify( data );\n    document.body.innerText = document.body.textContent = data;\n\x3c/script>\n</body>\n</html>')}]);
angular.module("bom-template/dialog-template.html",[]).run(["$templateCache",function(a){a.put("bom-template/dialog-template.html",'<div class="ui-widget-overlay ui-front"></div>\n<div id="dialog-{{name}}"\n     class="angular-dialog-container ui-dialog ui-widget-content ui-corner-all ui-front graph-popup-dialog ui-dialog-buttons">\n\n    <div id="dialog-header-{{name}}" class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">\n        <h4 class="ui-dialog-title">{{title}}</h4>\n        <button type="button"\n                class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close"\n                ng-class="{\'ui-state-hover\': closeButtonHover}"\n                ng-mouseenter="closeButtonHover=true"\n                ng-mouseleave="closeButtonHover=false"\n                ng-click="hide()">\n            <span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span>\n        </button>\n    </div>\n\n    <div id="dialog-body-{{name}}" class="angular-dialog-content ui-widget-content">\n\n    </div>\n\n    <div id="dialog-footer-{{name}}" class="dialog-footer ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">\n        <div class="ui-dialog-buttonset">\n            <button type="button" id="{{button.name}}"\n                    class="dialog-button {{button.name}} ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"\n                    ng-class="{\'ui-state-hover\': isHover}"\n                    ng-mouseenter="isHover=true"\n                    ng-mouseleave="isHover=false"\n                    ng-repeat="button in buttons"\n                    ng-click="button.click()">\n                <span class="ui-button-text">\n                    {{button.title}}\n                </span>\n            </button>\n        </div>\n    </div>\n\n</div>')}]);
angular.module("bom-template/import-bom-category.tpl.html",[]).run(["$templateCache",function(a){a.put("bom-template/import-bom-category.tpl.html",'<div class="import-bom-category sidebar-category">\n    <div class="import-bom-category-heading sidebar-category-heading heading"\n        ng-click="isOpen=!isOpen"\n        ng-class="{hover_2: isHover, hover_2_static: isOpen}"\n        ng-mouseenter="isHover=true"\n        ng-mouseleave="isHover=false"\n        category-id="{{ categoryId }}">\n        <span>{{ category.title }}</span>\n    </div>\n    <div class="loader" ng-show="isOpen && components.length == 0 && componentState == \'loading\'">\n        <span>Loading</span>\n    </div>\n    <div bn-slide-show="isOpen">\n        <div bn-slide-show="components.length > 0">\n            <div ng-repeat="component in components">\n                <div import-bom-component\n                    ng-show="!component.updating"\n                    section="{{ section }}"\n                    category="{{ categoryName }}"\n                    category-id="{{ categoryId }}"\n                    component="component"\n                    sprite-url="spriteUrl"\n                    bom-import-state="{{ bomImportState }}"\n                    total-bom-parts="totalBomParts">\n                </div>\n                <div update-component\n                     ng-show="component.updating"\n                     component="component"\n                     sprite-url="spriteUrl">\n                </div>\n            </div>\n        </div>\n        <div bn-slide-show="components.length == 0 || !components"\n             ng-show="componentState == \'empty\' && components.length == 0 || !components">\n            <div empty-component\n                 section="{{ section }}"\n                 category="{{ categoryName }}">\n            </div>\n        </div>\n        <div bn-slide-show="components.length == 0 || !components"\n             ng-show="componentState == \'error\' && components.length == 0 || !components">\n            <div error-component\n                 section="{{ section }}"\n                 category="{{ categoryName }}">\n            </div>\n        </div>\n    </div>\n</div>\n')}]);
angular.module("bom-template/import-bom-component-updating.tpl.html",[]).run(["$templateCache",function(a){a.put("bom-template/import-bom-component-updating.tpl.html",'<div class="leaf sidebar-component">\n    <div class="component-preview">\n    </div>\n    <div class="component-name">\n        {{ updating }}\n    </div>\n    <div class="component-description">\n        {{ generatingSprite }}\n    </div>\n</div>\n\n')}]);
angular.module("bom-template/import-bom-component.tpl.html",[]).run(["$templateCache",function(a){a.put("bom-template/import-bom-component.tpl.html",'<div class="leaf sidebar-component"\n    ng-class="{hover_4: isHover}"\n    ng-mouseenter="isHover=true"\n    ng-mouseleave="isHover=false"\n    ng-click="componentClicked( );">\n    <div class="component-preview">\n    </div>\n    <div class="component-name">\n        {{ component.title || component.name }}\n    </div>\n    <div class="component-description">\n        {{ component.description }}\n    </div>\n</div>\n\n')}]);
angular.module("bom-template/import-bom-section.tpl.html",[]).run(["$templateCache",function(a){a.put("bom-template/import-bom-section.tpl.html",'<div class="import-bom-section sidebar-section" >\n    <div class="import-bom-section-heading section-heading heading"\n        ng-click="isOpen=!isOpen"\n        ng-class="{hover_1: isHover, hover_1_static: isOpen}"\n        ng-mouseenter="isHover=true"\n        ng-mouseleave="isHover=false">\n        <span>{{ heading }}</span>\n    </div>\n    <div class="loader" ng-show="isOpen && categories.length == 0">\n        <span>Loading</span>\n    </div>\n    <div bn-slide-show="isOpen">\n        <div ng-show="categories.length > 0">\n            <div import-bom-category\n                ng-repeat="category in categories"\n                section="{{ section }}"\n                category="category"\n                bom-import-state="{{ bomImportState }}">\n            </div>\n        </div>\n    </div>\n</div>\n')}]);
var ALModuleDigikeySidebarBom=angular.module("ALModuleDigikeySidebarBom",["ALModuleDialog","templates-bom"]),EEWeb=void 0===EEWeb?{}:EEWeb;
(function(){var a=void 0===bomImportApiPath?"/":bomImportApiPath,b=function(a,b,c,g,h){if(a&&"status"in a){if("success"===a.status){g(a.data||!0);return}if("error"===a.status){h(a.data);return}}a||(a=403===c.status||401===c.status||0===c.status?c.statusText:"empty result");h(a,"error")},c=function(a){a.setRequestHeader("Authorization","Bearer "+eeServerData.oauthtoken);eeServerData.requestNoCache&&a.setRequestHeader("Cache-Control","max-age=0");return!0};amplify.request.define("imported_bom_parts_stencildefs",
"ajax",{url:a+"importbom/bom/{importID}/stencildefs/",dataType:"json",type:"GET",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("imported_bom_parts_stencils","ajax",{url:a+"importbom/bom/{importID}/stencils/",dataType:"xml",type:"GET",beforeSend:function(a){return c(a)}});amplify.request.define("load_imported_bom_parts","ajax",{url:a+"importbom/bom/{importID}/parts/",dataType:"json",type:"GET",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("load_imported_bom_list",
"ajax",{url:a+"importbom/user/{userID}/boms/",dataType:"json",type:"GET",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("assign_symbol","ajax",{url:a+"importbom/bom/{importID}/parts/{partID}/",dataType:"json",type:"POST",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("delete_imported_bom_list","ajax",{url:a+"importbom/user/{userID}/boms/{importID}/",dataType:"json",type:"DELETE",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("delete_imported_bom_parts",
"ajax",{url:a+"importbom/bom/{importID}/parts/{partID}/",dataType:"json",type:"DELETE",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("save_imported_bom","ajax",{url:a+"importbom/user/{userID}/boms/",dataType:"json",type:"POST",decoder:b,beforeSend:function(a){return c(a)}});amplify.request.define("assign_symbol_ie","ajax",{url:a+"importbom/bom/{importID}/parts/{partID}/",type:"POST",decoder:b});amplify.request.define("save_imported_bom_ie","ajax",{url:a+"importbom/user/{userID}/boms/",
type:"POST",decoder:b})})();
ALModuleDigikeySidebarBom.controller("BomFormController",["$scope","$timeout","DialogProvider",function(a,b,c){a.initHandlers=function(b){amplify.subscribe("import-bom-file",function(b){a.self.importBomFileCallback=b});amplify.subscribe("browse-bom-file",function(){$("#initial_import_bom_file",b).trigger("click")});amplify.subscribe("browse-bom-file-dlg",function(){c.showDialog("bom-form")})};a.initImportBomFileUpload=function(b){var e=void 0===bomImportApiPath?"/":bomImportApiPath,f=TemplatePath+
"bom-template/bomredirect.html?redirectdata",g=$("#import_bom_form",b),h=$("#import_bom_file",b),k=$("#initial_import_bom_file",b);b=$("#import_bom_file_wrapper",b);k.on("change",function(a){h.fileupload("add",{files:a.target.files||[{name:this.value}]})});h.fileupload({url:e+"parsebomfile",fileInput:h,dataType:"json",type:"POST",multipart:!0,add:function(a,b){b.submit()},done:function(b,d){g[0].reset();AspenLabs&&null!=AspenLabs.ieVersion&&10>AspenLabs.ieVersion&&c.hideDialog("bom-form");var e=d.result;
e&&"success"==e.status?a.self.importBomFileCallback(e.data):EEWeb.log.info("Failed to parse excel file for bom import")},beforeSend:function(a){a.setRequestHeader("Authorization","Bearer "+eeServerData.oauthtoken);return!0}});AspenLabs&&null!=AspenLabs.ieVersion&&10>AspenLabs.ieVersion?(h.fileupload("option","redirect",f),c.createDialog("bom-form",l("bom_confirm_dlg_title"),b,[{name:"close",title:l("cancel"),click:function(){}}])):b.addClass("hide-bom-form")}}]);
ALModuleDigikeySidebarBom.directive("bomForm",["safeApply",function(a){return{controller:"BomFormController",restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-form-template.html",scope:!0,link:function(b,c,d){b.self={};b.labels=[l("bom_confirm_dlg_title"),l("browse")];a(b);b.initHandlers(c);b.initImportBomFileUpload(c)}}}]);
ALModuleDigikeySidebarBom.factory("BomConfirmDialog",["$timeout","DialogProvider","BomSelectDialog","BomImportDialog",function(a,b,c,d){return{load:function(e){b.createDialog("bom-confirm",l("bom_confirm_dlg_title"),"<div bom-confirm></div>",[{name:"cancel",title:l("cancel"),click:function(){b.hideDialog("bom-confirm")}},{name:"import",title:l("start_import"),click:function(){b.hideDialog("bom-confirm");c.load(function(){amplify.publish("import-bom-file",function(b){b&&1==b.length?d.load(function(){a(function(){d.open(b[0])},
300)}):c.open(b)})});AspenLabs&&null!=AspenLabs.ieVersion&&10>AspenLabs.ieVersion?amplify.publish("browse-bom-file-dlg"):amplify.publish("browse-bom-file")}}],e)},open:function(){b.updateDialog("bom-confirm",{content:[l("confirm_select_import"),l("confirm_download_template"),l("confirm_example_format")],filePath:EEBasepath+"resources/bom.xls"});b.showDialog("bom-confirm")},close:function(){b.hideDialog("bom-confirm")}}}]);
ALModuleDigikeySidebarBom.directive("bomConfirm",["DialogProvider","safeApply",function(a,b){return{restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-confirm-template.html",scope:!0,link:function(a,d,e){b(a);amplify.subscribe("update-dialog-bom-confirm",function(b){for(var d in b)a[d]=b[d];a.safeApply()})}}}]);
ALModuleDigikeySidebarBom.factory("BomSelectDialog",["$timeout","DialogProvider","BomImportDialog",function(a,b,c){return{load:function(d){b.createDialog("bom-select",l("bom_select_dlg_title"),"<div bom-select></div>",[{name:"cancel",title:l("cancel"),click:function(){b.hideDialog("bom-select")}},{name:"ok",title:l("default_ok"),click:function(){b.hideDialog("bom-select");c.load(function(){a(function(){c.open(b.getDialogData("bom-select","selectedSheet"))},300)})}}],d)},open:function(a){b.updateDialog("bom-select",
{bomData:a,selectedSheet:a[0],sheetHeader:l("bom_select_dlg_body")});b.setDialogData("bom-select","bomData",a);b.showDialog("bom-select")},close:function(){b.hideDialog("bom-select")}}}]);
ALModuleDigikeySidebarBom.directive("bomSelect",["DialogProvider","safeApply",function(a,b){return{restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-select-template.html",scope:!0,link:function(c,d,e){b(c);amplify.subscribe("update-dialog-bom-select",function(a){for(var b in a)c[b]=a[b];c.safeApply()});c.$watch("selectedSheet",function(b){a.setDialogData("bom-select","selectedSheet",b)})}}}]);
ALModuleDigikeySidebarBom.factory("BomImportDialog",["$timeout","DialogProvider","BomImportErrorDialog","ImportBomProvider",function(a,b,c,d){return{load:function(e){b.createDialog("bom-import",l("import_bom_dlg_title"),"<div bom-import></div>",[{name:"cancel",title:l("cancel"),click:function(){b.hideDialog("bom-import")}},{name:"import",title:l("start_import"),click:function(){var e=b.getDialogData("bom-import","importName"),g=b.getDialogData("bom-import","selectedParts"),h=b.getDialogData("bom-import",
"importNameInput"),k=!1;h.hasClass("alert")&&(h.removeClass("alert"),b.updateDialog("bom-import",{importError:""}));e!=l("name_of_import")||h.hasClass("black-font")||(k=!0,h.addClass("alert"),b.updateDialog("bom-import",{importError:l("invalid_name")}));g.data.length||k||(k=!0,c.load(function(){a(function(){c.open()},300)}));k||d.retrieveImportedBom().then(function(a){_.chain(a).pluck("import_name").contains(e).value()?(h.addClass("alert"),b.updateDialog("bom-import",{importError:l("import_name_exist")})):
(b.hideDialog("bom-import"),d.checkUserId(function(a){g.userID=a;g.import_name=e;g.data=JSON.stringify(g.data);d.saveImportedBom(g)}))},function(a){EEWeb.log.info("Error retrieving imported bom list")})}}],e)},open:function(a){var c=b.getDialogData("bom-import","importNameInput");c.hasClass("alert")&&c.removeClass("alert");c.hasClass("black-font")&&c.removeClass("black-font");var c=[l("name"),l("dkpartnumber"),l("manufacturer_name"),l("manufacturer_partnum"),l("description")],d=[],h=_.chain(a[2]).map(function(a){return a.join()}).uniq().map(function(a){return a.split(",")}).value();
_.each(h,function(a){d.push({checked:!1,name:a[3],dkpn:a[0],manu:a[2],manpn:a[3],desc:a[4],notes:a[5]})});b.updateDialog("bom-import",{bomData:a,headers:c,rows:d,importName:l("name_of_import"),importError:"",selectionOrder:[],selectedParts:{user_id:null,import_name:"",data:[]},selectAll:!1,note:l("import_bom_dlg_note"),sortHeaders:["name","dkpn","manu","manpn","desc"],sortColumn:"",reverse:!1});b.showDialog("bom-import")},close:function(){b.hideDialog("bom-import")}}}]);
ALModuleDigikeySidebarBom.controller("BomImportController",["$scope","$timeout","$compile","DialogProvider",function(a,b,c,d){a.selectRow=function(b){var c={params:{name:b.name,dkpn:b.dkpn,manu:b.manu,manpn:b.manpn,desc:b.desc,notes:b.notes},paramsets:["symbol"],component_type:"L",stencil:"DSP"};a.selectionOrder.push(b);a.selectedParts.data.push(angular.copy(c))};a.toggleAllRowsSelection=function(){a.selectionOrder=[];a.selectedParts.data=[];a.selectAll?_.each(a.rows,function(b){b.checked=!0;a.selectRow(b)}):
_.each(a.rows,function(a){a.checked=!1})};a.toggleRowSelection=function(b){var c=-1;_.each(a.selectionOrder,function(a,d){c=_.isEqual(a,b)?d:c});-1<c?(a.selectionOrder.splice(c,1),a.selectedParts.data.splice(c,1)):a.selectRow(b)};a.toggleSelection=function(b){"all"==b?a.toggleAllRowsSelection():a.toggleRowSelection(b)};a.changeSorting=function(b){a.sortColumn=a.sortHeaders[b];a.reverse=!a.reverse};a.sortIcon=function(b){var c="ui-icon-carat-2-n-s";a.sortColumn==a.sortHeaders[b]&&(c=a.reverse?"ui-icon-triangle-1-s":
"ui-icon-triangle-1-n");return c};a.columnBG=function(b,c){var d;return d=a.sortColumn==a.sortHeaders[b]?"sort-"+(0==c%2?"even":"odd"):""};a.updatePartName=function(){if(a.selectionOrder.length){a.selectionOrder=[];a.selectedParts.data=[];var b=_.filter(a.rows,function(a){return a.checked});_.each(b,function(b){a.selectRow(b)})}};a.onFocusImportName=function(b){b=$(b.target);a.importName!=l("name_of_import")||b.hasClass("black-font")||(a.importName="",b.addClass("black-font"));b.hasClass("alert")&&
(b.removeClass("alert"),d.updateDialog(a.name,{importError:""}))};a.onBlurImportName=function(b){""==a.importName&&(a.importName=l("name_of_import"),b=$(b.target),b.hasClass("black-font")&&b.removeClass("black-font"))};a.initImportName=function(){var b=d.getDialogData(a.name),b=$(".dialog-footer",b.component),f;f=c('<input type="text" ng-model="importName" ng-focus="onFocusImportName($event)" ng-blur="onBlurImportName($event)" /><span class="bom-import-error">{{importError}}</span>')(a);b.append(f);
d.setDialogData(a.name,"importNameInput",$(f[0]))}}]);
ALModuleDigikeySidebarBom.directive("bomImport",["DialogProvider","safeApply",function(a,b){return{controller:"BomImportController",restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-import-template.html",scope:!0,link:function(c,d,e){c.initImportName();b(c);amplify.subscribe("update-dialog-bom-import",function(a){for(var b in a)c[b]=a[b];c.safeApply()});c.$watch("selectedParts",function(b){a.setDialogData(c.name,"selectedParts",b)});c.$watch("importName",function(b){a.setDialogData(c.name,
"importName",b)})}}}]);ALModuleDigikeySidebarBom.factory("BomImportErrorDialog",["DialogProvider",function(a){return{load:function(b){a.createDialog("bom-import-error",l("import_bom_dlg_error_title"),"<div bom-import-error></div>",[{name:"ok",title:l("default_ok"),click:function(){a.hideDialog("bom-import-error")}}],b)},open:function(){a.updateDialog("bom-import-error",{errorMessage:l("import_bom_dlg_error_msg")});a.showDialog("bom-import-error")},close:function(){a.hideDialog("bom-import-error")}}}]);
ALModuleDigikeySidebarBom.directive("bomImportError",["DialogProvider","safeApply",function(a,b){return{restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-import-error-template.html",scope:!0,link:function(a,d,e){b(a);amplify.subscribe("update-dialog-bom-import-error",function(b){for(var d in b)a[d]=b[d];a.safeApply()})}}}]);
ALModuleDigikeySidebarBom.factory("BomAssignDialog",["$timeout","DialogProvider","ImportBomProvider","BomServerErrorDialog","forceOpen",function(a,b,c,d,e){var f=null;return{load:function(g){b.createDialog("bom-assign",l("import_bom_assign_symbol"),"<div bom-assign></div>",[{name:"close",title:l("cancel"),click:function(){b.setDialogData("bom-assign","currentSelected",null)}},{name:"ok",title:l("default_ok"),click:function(){var g=b.getDialogData("bom-assign","currentSelected");console.log("Assign symbol dialog ok clicked, selected symbol:");
console.log(g);g&&(b.forceCloseDialog("bom-assign"),f.component.updating=!0,c.assignSymbol(g).then(function(b){amplify.publish("reload-imported-bom");a(function(){e(f.categoryId)},300)},function(b){f.component.updating=!1;d.load(function(){a(function(){d.open()},300)})}))}}],g);b.onDialogClose("bom-assign",function(){var a=b.getDialogData("bom-assign","embeddedSidebar").find(".leaf.selected");a.removeClass("selected");a.removeClass("selected-hover");b.setDialogData("bom-assign","currentSelected",
null)})},open:function(a,c){console.log("Assign symbol dialog opened, selected symbol:");console.log(b.getDialogData("bom-assign","currentSelected"));console.log("for component:");console.log(a.component);b.updateDialog("bom-assign",{bomPart:a.component});f=a;b.showDialog("bom-assign")},close:function(){b.setDialogData("bom-assign","currentSelected",null);b.hideDialog("bom-assign")}}}]);
ALModuleDigikeySidebarBom.directive("bomAssign",["DialogProvider","safeApply",function(a,b){return{restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-assign-template.html",scope:!0,link:function(c,d,e){b(c);amplify.subscribe("update-dialog-bom-assign",function(a){for(var b in a)c[b]=a[b];c.safeApply()});c.currentSelected=null;var f=$("sidebar-accordion[sidebar-embedded='bom-assign']");c.embeddedSidebar=f;a.setDialogData("bom-assign","embeddedSidebar",f);amplify.subscribe("execute-bom-assign",
function(b,d){d.mouseover(function(){d.hasClass("selected")&&(d.addClass("selected-hover"),d.removeClass("hover_4"))});d.mouseout(function(){d.removeClass("selected-hover")});b.componentClicked=function(){f.find(".leaf.selected").removeClass("selected");d.addClass("selected");d.hasClass("hover_4")&&d.removeClass("hover_4");c.currentSelected={partID:c.bomPart.part_id,importID:c.bomPart.importID,component_type:b.component.component_type,symbol_id:b.component.stencil,bom_include:1};c.safeApply();a.setDialogData("bom-assign",
"currentSelected",c.currentSelected);console.log("Selected symbol for bom import assign:");console.log(a.getDialogData("bom-assign","currentSelected"))};b.safeApply()})}}}]);
ALModuleDigikeySidebarBom.factory("BomServerErrorDialog",["DialogProvider",function(a){return{load:function(b){a.createDialog("bom-server-error",l("error_component_title"),"<div bom-server-error></div>",[{name:"ok",title:l("default_ok"),click:function(){a.hideDialog("bom-server-error")}}],b)},open:function(b){a.updateDialog("bom-server-error",{errorMessage:b?b:l("error_component_description")});a.showDialog("bom-server-error")},close:function(){a.hideDialog("bom-server-error")}}}]);
ALModuleDigikeySidebarBom.directive("bomServerError",["DialogProvider","safeApply",function(a,b){return{restrict:"A",transclude:!0,templateUrl:AngularTemplatePath+"bom-template/bom-server-error-template.html",scope:!0,link:function(a,d,e){b(a);amplify.subscribe("update-dialog-bom-server-error",function(b){for(var d in b)a[d]=b[d];a.safeApply()})}}}]);
ALModuleDigikeySidebarBom.directive("importBomSection",["ImportBomProvider","ImportBomState","BomServerErrorDialog","safeApply","$timeout",function(a,b,c,d,e){return{require:"^sidebarAccordion",controller:"SidebarController",restrict:"A",transclude:!0,replace:!0,templateUrl:AngularTemplatePath+"bom-template/import-bom-section.tpl.html",scope:{heading:"@",section:"@"},link:function(f,g,h,k){d(f);f.categories=[];k.addGroup(f);f.isOpen=!1;f.isSectionLoaded=!1;amplify.subscribe("request-no-cache",function(a){eeServerData.requestNoCache=
a});amplify.subscribe("reload-imported-bom",function(){a.retrieveImportedBom(!0).then(function(a){f.importedBomList=a;b.onLoadedImportedBom("section:"+f.section,f)},function(a){c.load(function(){e(function(){c.open()},300)})})});amplify.subscribe("close-imported-bom-section",function(){f.isOpen=!1});f.$watch("isOpen",function(d){d&&(k.closeOthers(f),a.checkUserLoggedIn(function(d){if(d)f.isSectionLoaded||a.retrieveImportedBom(!1).then(function(a){f.isSectionLoaded=!0;f.importedBomList=a;b.onLoadedImportedBom("section:"+
f.section,f)},function(a){amplify.publish("close-imported-bom-section");c.load(function(){e(function(){c.open(a)},300)})});else b.onImportBom("section:"+f.section,f)}))})}}}]);
ALModuleDigikeySidebarBom.directive("importBomCategory",["ImportBomState","ImportBomProvider","BomServerErrorDialog","bindBomCategory","safeApply","forceOpen","$timeout",function(a,b,c,d,e,f,g){return{require:["^importBomSection","?SidebarController"],controller:"ImportBomController",restrict:"A",transclude:!0,replace:!0,templateUrl:AngularTemplatePath+"bom-template/import-bom-category.tpl.html",scope:{section:"@",category:"=",bomImportState:"@"},link:function(h,k,m,n){e(h);n[0].addGroup(h);h.components=
[];h.componentState="loading";h.totalBomParts=0;h.ishover=!1;h.isOpen=!1;h.element=$(k);var p=h.category.import_id||h.category.name;h.categoryName=p;"import_name"in h.category&&(m=h.category.import_name,h.category.title=m,h.categoryId=m,h.safeApply());var q=h.categoryId;p&&"import-bom"!=p&&d(h,k);amplify.subscribe("set-sprite-request",function(a,d,e,h,k,m){null!=h[a]&&g.cancel(h[a]);h[a]=g(function(){h[a]=null;m+=1;10<m&&20>=m?k=2E4:20<m&&(k=3E4);b.retrieveSprite(a).then(function(b){"updating"==b.spriteStatus&&
amplify.publish("fetch-new-sprite",a,d,e,h,k,m);"done"==b.spriteStatus&&(amplify.publish("reload-imported-bom"),f(d))},function(a){c.load(function(){g(function(){c.open()},300)})})},k)});amplify.subscribe("fetch-new-sprite",function(a,b,c,d,e,f){amplify.publish("set-sprite-request",a,b,c,d,e,f)});h.$watch("isOpen",function(c){c&&(n[0].closeOthers(h),a.checkState("section:"+h.section,function(c){if("on-loaded-imported-bom"==c)if("import-bom"!=p)"loaded"!=h.componentState&&(h.componentState="error"==
h.componentState?"loading":h.componentState,b.retrieveImportedBomParts(p,q).then(function(b){h.bomParts=b.bomParts;h.totalBomParts=b.bomParts.parts.length;h.spriteUrl=b.spriteURL;h.componentState="loaded";amplify.publish("set-stencil",b.stencils);amplify.publish("set-stencildefs",b.stencildefs);a.onLoadedImportedBom("category:"+p,h)},function(a){h.componentState="empty result"==a?"empty":"error";"FORBIDDEN"!=a&&"UNAUTHORIZED"!=a&&"error"!=a||amplify.publish(EEWeb.events.RENEW_ACCESS_TOKEN,new ALEvent({}))}));
else a.onLoadedImportedBom("category:"+p,h);else if("on-import-bom"==c)a.onImportBom("category:"+p,h)}))})}}}]);
ALModuleDigikeySidebarBom.directive("importBomComponent",["ImportBomProvider","ImportBomState","safeApply","bindBomComponent",function(a,b,c,d){return{controller:"ImportBomController",restrict:"A",transclude:!0,replace:!0,templateUrl:AngularTemplatePath+"bom-template/import-bom-component.tpl.html",scope:{section:"@",category:"@",categoryId:"@",component:"=",subcategory:"@?",spriteUrl:"=",componentState:"=",bomImportState:"@",totalBomParts:"="},link:function(a,f){c(a);a.isHover=!1;a.component.updating=
!1;a.component.importID=a.category;var g=a.component.part_id||a.component.name;"import-bom"==a.category&&$(f).addClass("non-component");b.checkState("category:"+a.category,function(c){if("on-loaded-imported-bom"==c)b.onLoadedImportedBom("component:"+g,a);else if("on-import-bom"==c)b.onImportBom("component:"+g,a);d(a,f)})}}}]);
ALModuleDigikeySidebarBom.directive("updateComponent",[function(){return{restrict:"A",transclude:!0,replace:!0,templateUrl:AngularTemplatePath+"bom-template/import-bom-component-updating.tpl.html",scope:{component:"=",spriteUrl:"="},link:function(a,b){a.updating=l("updating");a.generatingSprite=l("generating_sprite")+"...";a.component.updating=!1;var c=a.component,d=a.spriteUrl,e=$(b).find(".component-preview");mxClient.IS_IE&&e.attr("onselectstart","return false;");amplify.publish("set-component",
c,e,d)}}}]);
ALModuleDigikeySidebarBom.controller("ImportBomController",["$scope","$timeout","ImportBomProvider","BomConfirmDialog","BomAssignDialog","BomServerErrorDialog","forceOpen",function(a,b,c,d,e,f,g){a.onImportBomClick=function(){c.checkUserLoggedIn(function(a){a?d.load(function(){b(function(){d.open()},300)}):c.makeUserLogIn()})};a.assignImportedBomPart=function(a,c){e.load(function(){b(function(){e.open(a,c)},300)})};a.deleteImportedBom=function(a,d){c.deleteImportedBom(a,d).then(function(a){amplify.publish("request-no-cache",!0);
amplify.publish("reload-imported-bom");g(d)},function(a){f.load(function(){b(function(){f.open()},300)})})};a.deleteImportedBomPart=function(){c.deleteImportedBomPart(a.component.importID,a.component.part_id).then(function(b){amplify.publish("reload-imported-bom");g(a.categoryId)},function(a){f.load(function(){b(function(){f.open()},300)})})};a.removeAssignedSymbol=function(d){d.component.updating=!0;c.removeAssignedSymbol(a.component.importID,a.component.part_id).then(function(b){amplify.publish("reload-imported-bom");
g(a.categoryId)},function(a){d.component.updating=!1;f.load(function(){b(function(){f.open()},300)})})}}]);
ALModuleDigikeySidebarBom.factory("ImportBomState",["ImportBomProvider","DialogProvider",function(a,b){var c={};return{onImportBom:function(b,e){e.bomImportState="on-import-bom";b in c||(c[b]=e);b=b.split(":")[0];switch(b){case "section":e.categories=[{name:"import-bom",title:l("category_import_bom")}];e.safeApply();break;case "category":"import-bom"==e.categoryName&&a.checkUserLoggedIn(function(a){a?(e.components=[{name:l("import_bom_import_title"),description:l("import_bom_import_desc"),text:l("import_bom_import_title"),
preview:{position:{xpx:10,ypx:5}}}],e.spriteUrl=EEBasepath+"img/export.png"):(e.components=[{name:l("import_bom_login_title"),description:l("import_bom_login_desc"),text:l("import_bom_login_title"),preview:{position:{xpx:10,ypx:5}}}],e.spriteUrl=EEBasepath+"img/webfull/redo.png");e.safeApply()});break;case "component":e.componentClicked=e.onImportBomClick,e.safeApply()}},onLoadedImportedBom:function(a,e){e.bomImportState="on-loaded-imported-bom";a in c||(c[a]=e);a=a.split(":")[0];switch(a){case "section":e.categories=
[{name:"import-bom",title:"Import BOM"}];e.categories=e.categories.concat(e.importedBomList);break;case "category":"import-bom"==e.categoryName?(e.components=[{name:l("import_bom_import_title"),description:l("import_bom_import_desc"),text:l("import_bom_import_title"),preview:{position:{xpx:10,ypx:5}}}],e.spriteUrl=EEBasepath+"img/export.png"):(e.components=e.bomParts.parts,b.setDialogData("bom-assign","categoryId",e.categoryId));break;case "component":"import-bom"==e.category&&(e.componentClicked=
e.onImportBomClick)}e.safeApply()},checkState:function(a,b){b(c[a].bomImportState)}}}]);
ALModuleDigikeySidebarBom.factory("bindBomComponent",["bindComponent","ImportBomProvider","popupMenu",function(a,b,c){return function(d,e){var f=d.component,g=d.spriteUrl,h=d.totalBomParts;if("import-bom"!=d.category)a(f,g,e),f=[{title:l("import_bom_assign_symbol"),image:EEBasepath+"/img/webfull/paste.png",handler:function(){d.assignImportedBomPart(d,e)}},{title:l("import_bom_remove_symbol"),image:EEBasepath+"/img/webfull/delete.png",handler:function(){d.removeAssignedSymbol(d)}},{title:l("import_bom_delete_part"),
image:EEBasepath+"/img/webfull/delete.png",handler:function(){1<h?d.deleteImportedBomPart():b.checkUserId(function(a){d.deleteImportedBom(a,d.category)})}},{separator:!0},{title:l("import_bom_delete_import"),image:EEBasepath+"/img/webfull/delete.png",handler:function(){b.checkUserId(function(a){d.deleteImportedBom(a,d.category)})}}],c(e,f);else{var k=$(e),m=k.find(".component-preview"),k=k.find(".component-name");mxClient.IS_IE&&(m.attr("onselectstart","return false;"),k.attr("onselectstart","return false;"));
amplify.publish("set-component",f,m,g)}}}]);ALModuleDigikeySidebarBom.factory("bindBomCategory",["popupMenu","ImportBomProvider",function(a,b){return function(c,d){var e=$(".import-bom-category-heading",d),f=[{title:l("import_bom_delete_import"),image:EEBasepath+"/img/webfull/delete.png",handler:function(){b.checkUserId(function(a){c.deleteImportedBom(a,c.categoryName)})}}];a(e,f)}}]);
ALModuleDigikeySidebarBom.factory("popupMenu",[function(){return function(a,b){var c=new mxPopupMenu(function(a,c,f){_.each(b,function(b){"separator"in b?a.addSeparator():a.addItem(b.title,b.image,b.handler)})});a.on("contextmenu",function(a){a.preventDefault();$(document).trigger("click.hidePopupMenu");amplify.publish(EEWeb.events.COMP_CLEAR_DRAG);var b=mxPopupMenu.prototype.hideMenu;c.hideMenu=function(){b.apply(this,arguments);$(document).off(".hidePopupMenu")};c.showMenu=function(){AspenLabs&&
9<=AspenLabs.ieVersion&&(this.div.style.filter="none");$("body").append(this.div);mxUtils.fit(this.div);var a=$(this.div),b=function(b){-1==$(b.target).parents().index(a)&&a.is(":visible")&&c.hideMenu()};$(document).on("click.hidePopupMenu",b);$(document).on("keyup.hidePopupMenu",function(a){27===a.keyCode&&b(a)})};c.isMenuShowing()&&c.hideMenu();c.popup(a.clientX,a.clientY)})}}]);
ALModuleDigikeySidebarBom.provider("ImportBomProvider",function(){var a={importedBomList:"load_imported_bom_list",importedBomParts:"load_imported_bom_parts",importedBomPartsStencildefs:"imported_bom_parts_stencildefs",importedBomPartsStencils:"imported_bom_parts_stencils",saveImportedBom:"save_imported_bom",saveImportedBomIE:"save_imported_bom_ie",assignSymbol:"assign_symbol",assignSymbolIE:"assign_symbol_ie",deleteImportedBomList:"delete_imported_bom_list",deleteImportedBomParts:"delete_imported_bom_parts",
removeAssignedSymbol:"assign_symbol"},b=function(a,b,c){amplify.request({resourceId:a,data:b,success:function(a){c(null,a)},error:function(a){c(a)}})},c=this;this.importedBomList=[];this.getSpriteList=[];this.getSpriteTimer={};this.fetchDelay=1E4;this.fetchCount=0;this.$get=["$q",function(d){return{checkUserLoggedIn:function(a){amplify.publish(EEWeb.events.USER_IS_LOGGED_IN,a)},makeUserLogIn:function(){amplify.publish(EEWeb.events.PROJECT_SAVE_SESSION);amplify.publish(EEWeb.events.USER_LOGIN,new ALEvent({}))},
checkUserId:function(a){amplify.publish(EEWeb.events.USER_CHECK_ID,a)},retrieveImportedBom:function(e){var f=d.defer();if(!_.isEmpty(c.importedBomList)&&!e)return f.resolve(c.importedBomList),f.promise;e={userID:EEWeb.project.getCurrentUserId()};b(a.importedBomList,e,function(a,b){if(a){var d="";if("FORBIDDEN"==a||"UNAUTHORIZED"==a||"error"==a)amplify.publish(EEWeb.events.RENEW_ACCESS_TOKEN,new ALEvent({})),d=l("renew_access_token");f.reject(d)}else _.isEmpty(b)?(c.importedBomList=[],f.resolve([])):
(amplify.publish("request-no-cache",!1),c.importedBomList=b,f.resolve(b))});return f.promise},retrieveImportedBomParts:function(e,f){var g=d.defer(),h={},k={importID:e};async.parallel([function(c){b(a.importedBomParts,k,function(a,b){a?c(a):b?(h.bomParts=b,c()):c(!0)})},function(c){b(a.importedBomPartsStencils,k,function(a,b){a?c(a):b?(h.stencils=b,c()):c(!0)})},function(d){b(a.importedBomPartsStencildefs,k,function(a,b){if(a)d(a);else if(b){h.stencildefs=b.stencildefs;h.spriteURL=b.spriteURL;var g=
b.spriteStatus,k=_.indexOf(c.getSpriteList,e),x=_.contains(c.getSpriteList,e),r=g&&"done"==g&&x;g&&"updating"==g&&!x&&(c.getSpriteList.push(e),amplify.publish("fetch-new-sprite",e,f,c.getSpriteList,c.getSpriteTimer,c.fetchDelay,c.fetchCount));r&&(c.getSpriteList=0<k?c.getSpriteList.slice(k-1,1):[],c.fetchCount=0);d()}else d(!0)})}],function(a){a?g.reject(a):g.resolve(h)});amplify.publish("request-no-cache",!1);return g.promise},retrieveSprite:function(c){var f=d.defer(),g={};b(a.importedBomPartsStencildefs,
{importID:c},function(a,b){a?f.reject(a):b?(g.stencildefs=b.stencildefs,g.spriteURL=b.spriteURL,g.spriteStatus=b.spriteStatus,f.resolve(g)):f.resolve(!1)});return f.promise},saveImportedBom:function(c){var d=null,d=AspenLabs&&null!=AspenLabs.ieVersion&&10>AspenLabs.ieVersion?a.saveImportedBomIE:a.saveImportedBom;b(d,c,function(a,b){a?EEWeb.log.info("Failed to save imported bom parts to db"):(EEWeb.log.info("Successfully saved imported bom parts to db"),amplify.publish("request-no-cache",!0),amplify.publish("reload-imported-bom"))})},
assignSymbol:function(c){var f=d.defer(),g=null,g=AspenLabs&&null!=AspenLabs.ieVersion&&10>AspenLabs.ieVersion?a.assignSymbolIE:a.assignSymbol;b(g,c,function(a,b){a?f.reject(a):b?f.resolve(b):f.reject(null)});return f.promise},deleteImportedBom:function(c,f){var g=d.defer();b(a.deleteImportedBomList,{userID:c,importID:f},function(a,b){a?g.reject(a):b?g.resolve(b):g.reject(null)});return g.promise},deleteImportedBomPart:function(c,f){var g=d.defer();b(a.deleteImportedBomParts,{importID:c,partID:f},
function(a,b){a?g.reject(a):b?g.resolve(b):g.reject(null)});return g.promise},removeAssignedSymbol:function(c,f){var g=d.defer(),h=null,h=AspenLabs&&null!=AspenLabs.ieVersion&&10>AspenLabs.ieVersion?a.assignSymbolIE:a.assignSymbol;b(h,{importID:c,partID:f,component_type:"L",symbol_id:"DSP",bom_include:1},function(a,b){a?g.reject(a):b?g.resolve(b):g.reject(null)});return g.promise},setResourceID:function(b,c){a[b]=c},setResourceIDs:function(b){for(var c in b)a[c]=b[c]}}}]});
var ALNgAppModules=ALNgAppModules||[],ALNgApp=angular.module("ALNgApp",ALNgAppModules);
